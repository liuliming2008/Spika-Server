
<script id="channel_list_template" type="text/x-handlebars-template">
	{{#each channels}}
		{{> channel}}
	{{/each}}

	{{#if non_member_cnt}}
		{{#unless user.is_restricted}}
		<a class="channel-list-more list_more">+{{non_member_cnt}} more...</a>
		{{/unless}}
	{{else}}
		{{#canUserCreateChannels}}
		<a class="channel-list-create list_more">Create a channel...</a>
		{{/canUserCreateChannels}}
	{{/if}}
</script>

<script id="group_template" type="text/x-handlebars-template">
	<li class='{{makeGroupDomId group}} group {{makeGroupDomClass group}} cursor_pointer'>
		<a href="/archives/{{group.name}}" target="{{newWindowName}}" class="group_name" data-group-id="{{group.id}}">
			<i class="fa fa-times-circle group_close"></i>
			<span class="{{makeUnreadJustDomId group}} unread_just {{#if_equal group.unread_cnt compare=0}}hidden{{/if_equal}}">
				{{numberWithMax group.unread_cnt 10}}
			</span>
			<span class="{{makeUnreadHighlightDomId group}} unread_highlight {{#if_equal group.unread_highlight_cnt compare=0}}hidden{{/if_equal}}{{#if_equal group.unread_highlight_cnt compare=undefined}}hidden{{/if_equal}}">{{numberWithMax group.unread_highlight_cnt 10}}</span>
			<span class="overflow-ellipsis">
				{{#if show_symbol}}<i class="fa fa-lock prefix"></i>{{/if}}
				{{#if group.is_archived}}(a) {{/if}}
				<span class="prefix">{{{groupPrefix}}}</span>
				{{group.name}}
			</span>
		</a>
	</li>	
</script>

<script id="channel_template" type="text/x-handlebars-template">
	<li class="{{makeChannelDomId this}} channel {{makeChannelDomClass this}}">
		<a href="/archives/{{this.name}}" target="{{newWindowName}}" class="channel_name" data-channel-id="{{this.id}}">
			<span class="{{makeUnreadJustDomId this}} unread_just {{#if_equal this.unread_cnt compare=0}}hidden{{/if_equal}}">
				{{numberWithMax this.unread_cnt 10}}
			</span>
			<span class="{{makeUnreadHighlightDomId this}} unread_highlight {{#if_equal this.unread_highlight_cnt compare=0}}hidden{{/if_equal}}">
				{{numberWithMax this.unread_highlight_cnt 10}}
			</span>
			<span class="overflow-ellipsis">
				{{#if this.is_archived}}(a) {{/if}}
				<span class="prefix">#</span>
				{{this.name}}
			</span>
		</a>
	</li>
</script>

<script id="member_template" type="text/x-handlebars-template">
	<li class='{{makeMemberDomId member}} member {{makeMemberDomClass member}} cursor_pointer'>
		{{! NOTE: we add user_colored and not_user_colored classes to disallow/allow the color to be applied via the css rule (with :not(.not_user_colored)), and easily toggle that on and off}}
		<a href="/team/{{im.name}}" target="{{newWindowName}}" class="im_name {{#if color_names}}user_colored{{else}}not_user_colored{{/if}} {{getMemberColorClassByImId im.id}}" data-member-id="{{member.id}}">
			{{#if show_close_link}}<i class="fa fa-times-circle im_close"></i>{{/if}}
			<span class="{{makeUnreadHighlightDomId member}} unread_highlight {{#if_equal im.unread_cnt compare=0}}hidden{{/if_equal}}{{#if_equal im.unread_cnt compare=undefined}}hidden{{/if_equal}}">{{numberWithMax im.unread_cnt 10}}</span>
			<span class="typing_indicator"></span>
			<span class="overflow-ellipsis">
				{{#if_equal im.name compare="slackbot"}}
					<i class="fa fa-heart slackbot_icon"></i>
					{{im.name}}
				{{else}}
					{{{makeMemberPresenceIcon member}}}
					{{getDisplayNameOfUserForIm im}}
				{{/if_equal}}
			</span>
		</a>
	</li>	
</script>

<script id="channel_members_list_template" type="text/x-handlebars-template">
	{{#if members}}
		<ul id="{{makeChannelListDomId channel}}" class='member_list overflow-ellipsis'>			
			{{#each members}}
				<li class="{{makeMemberDomId this}} overflow-ellipsis member" data-member-id="{{this.id}}">
					<span class="typing_indicator"></span>
					<a href="/team/{{this.name}}" class="{{makeMemberPresenceDomClass this}} {{makeMemberListDomClass this}} {{getMemberColorClassById this.id}} {{#if ../color_names}}user_colored{{else}}not_user_colored{{/if}} overflow-ellipsis">
						{{{makeMemberPresenceIcon this}}}
						{{getMemberDisplayName this}}
					</a>
				</li>
			{{/each}}
		</ul>
	{{/if}}
</script>

<script id="channel_create_overlay_template" type="text/x-handlebars-template">
	<div id="channel_created" class="channel_overlay">
		<p class="channel_overlay_title">
			You just created<br />
			<span class="channel_overlay_title_prefix">#</span><strong>{{channel.name}}</strong>
		</p>
		<ul>
			{{#if_gt channel.active_members.length compare=1}}
				<li>{{channel.active_members.length}} people have this channel open.</li>
			{{else}}
				<li>You are currently the only person in this channel.</li>
			{{/if_gt}}
			<li>You can review messages from this channel in the <a href="/archives/{{channel.name}}" class="bold" target={{newWindowName}}>Channel Archive</a>.</li>
			<li>Others on your team can join from the <strong>Channel List</strong>.</li>
			<li>Or, you can <a class="bold invite_link">invite some teammates now</a>!</li>
		</ul>

		<label class="checkbox overlay_pref block">
			<input id="no_created_overlays_cb" type="checkbox" /> Don't show me this message when I create a channel or group
		</label>

		<a class="btn btn-primary padded">Got it!</a>
		
	</div>
</script>

<script id="channel_join_overlay_template" type="text/x-handlebars-template">
	<div id="channel_joined" class="channel_overlay">
		<p class="channel_overlay_title">
			You just joined<br />
			<span class="channel_overlay_title_prefix">#</span><strong>{{channel.name}}</strong>
		</p>
		<ul>
			<li>Created on {{toCalendarDate channel.created}} {{#if channel.creator}}by {{{makeMemberPreviewLinkById channel.creator}}}{{/if}}.</li>
			{{#if invited}}
				<li>{{#if channel.inviter}}You were invited to this channel by {{{makeMemberPreviewLinkById channel.inviter}}}.{{/if}}</li>
			{{/if}}
			{{#if_equal channel.active_members.length compare=1}}
				<li>You are currently the only person in this channel.</li>
			{{else}}
				<li>{{channel.active_members.length}} people have this channel open.</li>
			{{/if_equal}}
		</ul>
		{{#if channel.purpose.value}}
			<p class="channel_overlay_purpose">The purpose of this channel is:<br /><em>{{{formatTopicOrPurpose channel.purpose.value}}}</em></p>
		{{/if}}

		<label class="checkbox overlay_pref block">
			<input id="no_joined_overlays_cb" type="checkbox" /> Don't show me this message when I join a channel or group
		</label>

		<a class="btn btn-primary padded">Got it!</a>
		
	</div>
</script>


<script id="group_create_overlay_template" type="text/x-handlebars-template">
	<div id="group_created" class="channel_overlay">
		<p class="channel_overlay_title">
			You just created<br />
			<span class="channel_overlay_title_prefix">{{{groupPrefix}}}</span><strong>{{group.name}}</strong></span>
		</p>
		<ul>
			{{#if_gt group.active_members.length compare=1}}
				<li>{{group.active_members.length}} people have this group open.</li>
			{{else}}
				<li>You are currently the only person in this group.</li>
			{{/if_gt}}
			<li>You can invite other people from the group menu, which you'll find at the top of this column.</li>
			<li>You can review messages from this group in the <a href="/archives/{{group.name}}" class="bold" target={{newWindowName}}>Group Archive</a>.</li>
		</ul>

		<label class="checkbox overlay_pref block">
			<input id="no_created_overlays_cb" type="checkbox" />
			Don't show me this message when I create a channel or group
		</label>

		<a class="btn btn-primary padded">Got it!</a>
		
	</div>
</script>

<script id="group_join_overlay_template" type="text/x-handlebars-template">
	<div id="group_joined" class="channel_overlay">
		<p class="channel_overlay_title">
			You just joined<br />
			<span class="channel_overlay_title_prefix">{{{groupPrefix}}}</span><strong>{{group.name}}</strong>
		</p>
		<ul>
			<li>Created on {{toCalendarDate group.created}} {{#if group.creator}}by {{{makeMemberPreviewLinkById group.creator}}}{{/if}}.</li>
			<li>This is a private group.</li>
			{{#if invited}}
				<li>{{#if group.inviter}}You were invited to this group by {{{makeMemberPreviewLinkById group.inviter}}}.{{/if}}</li>
			{{/if}}
			{{#if_equal group.active_members.length compare=1}}
				<li>You are currently the only member of this group.</li>
			{{else}}
				<li>The members are
				{{#foreach group.active_members}}
					{{#if this.last}}and {{/if}}{{getMemberDisplayNameById this.value}}{{#if this.last}}.{{else}}{{#if_gt this.length compare=2}},{{/if_gt}}{{/if}}
				{{/foreach}}</li>
			{{/if_equal}}
			<li>Only members can open the group and they are the only ones to have access to the archives.</li>
			<li>You can invite more members from the group menu.</li>
		</ul>
		{{#if group.purpose.value}}
			<p class="channel_overlay_purpose">The purpose of this group is:<br /><em>{{{formatTopicOrPurpose group.purpose.value}}}</em></p>
		{{/if}}

		<label class="checkbox overlay_pref block">
			<input id="no_joined_overlays_cb" type="checkbox" /> Don't show me this message when I join a channel or group
		</label>

		<a class="btn btn-primary padded">Got it!</a>
		
	</div>
</script>


<script id="file_list_item_template" type="text/x-handlebars-template">

	<div id="{{makeFileDomId file}}" class="file_list_item file_item" data-owner-id="{{file.user}}">
	
		{{{makeFileHeader file member}}}
		
		<a href="{{file.permalink}}" {{#isClient}}target="{{file.permalink}}"{{/isClient}} data-file-id="{{file.id}}" class="file_preview_link icon {{icon_class}}">
			{{#if file.thumb_80}}
				{{#if_equal icon_class compare="thumb_80"}}
					<img src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACwAAAAAAQABAAACAkQBADs=" data-original="{{file.thumb_80}}" class="lazy" />
				{{else}}
					<img src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACwAAAAAAQABAAACAkQBADs=" data-original="{{file.thumb_360}}" class="lazy" />
				{{/if_equal}}
			{{else}}
				<span data-file-id="{{file.id}}" class="filetype_icon s48 {{file.filetype}}"></span>
			{{/if}}
		</a>

		<div class="contents">
	
			<div class="file_meta">
				<span class="time">{{toCalendarDateOrNamedDayShort file.timestamp}} at {{toTime file.timestamp}}</span><br />

				{{#if file.is_external}}
					{{{external_filetype_html}}}
				{{else}}
					<a href="{{file.url_private_download}}" target="{{file.url_private_download}}" title="Download this file">{{convertFilesize file.size}} <span>{{file.pretty_type}}</span> file</a>
				{{/if}}

				{{#isClient}}
					<span class="bullet">?</span>
					{{{fileActionsLink file}}}
				{{/isClient}}
				
				<br />

				{{#if file.comments_count}}
					<a href="{{file.permalink}}" {{#isClient}}target="{{file.permalink}}"{{/isClient}} data-file-id="{{file.id}}" class="file_preview_link file_comment_link">{{pluralCount file.comments_count 'comment' 'comments'}}</a>
					{{#if file.is_shared}}<span class="bullet">?</span>{{/if}}
				{{/if}}

				{{#if file.is_public}}
					{{#if file.is_shared}}
						Shared in
						{{{makeFileGroupChannelList file}}}
					{{/if}}
				{{else}}
					<i class="fa fa-eye"></i>
					Private file {{#if file.groups}}in {{{makeFileGroupChannelList file}}}{{else}}{{#unless member.is_self}}shared with you{{/unless}}{{/if}}
				{{/if}}

				{{#if file.public_url_shared}}
					<br />
					{{> file_public_link}}
				{{/if}}	
								
			</div>
	
		</div>

	</div>

</script>

<script id="file_header_template" type="text/x-handlebars-template">

	<div class="file_header">

		{{#isClient}}
			{{#if file.is_external}}
				{{#if_equal file.external_type compare="gdrive"}}						
					<a {{{makeRefererSafeLink url=file.url_private}}} target="{{file.url_private}}" class="icon_new_window no_underline" title="Open original in Google Drive"><img src="/img/services/gdrive_16.png" class="gdrive_icon grayscale" /></a>
				{{/if_equal}}
				{{#if_equal file.external_type compare="dropbox"}}						
					<a {{{makeRefererSafeLink url=file.url_private}}} target="{{file.url_private}}" class="icon_new_window no_underline" title="Open original in Dropbox"><i class="fa fa-dropbox"></i></a>
				{{/if_equal}}
				{{#if_equal file.external_type compare="box"}}						
					<a {{{makeRefererSafeLink url=file.url_private}}} target="{{file.url_private}}" class="icon_new_window no_underline" title="Open original in Box"><img src="/plugins/box/assets/service_32.png" class="box_icon grayscale" /></a>
				{{/if_equal}}
			{{else}}
				{{#if_equal file.mode compare="post"}}
					<a href="{{file.permalink}}" target="{{file.permalink}}" class="fa fa-external-link-square icon_new_window" title="Open in new tab"></a>
				{{/if_equal}}
				{{#if_equal file.mode compare="snippet"}}
					<a href="{{file.permalink}}" target="{{file.permalink}}" class="fa fa-external-link-square icon_new_window" title="Open in new tab"></a>
				{{/if_equal}}
				{{#if_equal file.mode compare="hosted"}}
					<a href="{{file.url_private}}" target="{{file.url_private}}" class="fa fa-external-link-square icon_new_window" title="Open original in new tab"></a>
				{{/if_equal}}
			{{/if}}
		{{/isClient}}

		<a href="{{file.permalink}}" {{#isClient}}target="{{file.id}}"{{/isClient}} data-file-id="{{file.id}}" {{#unless preview}}class="file_preview_link"{{/unless}}>
			<i class="filetype_icon s24 {{#if_equal file.mode compare="snippet"}}{{#if_equal file.filetype compare="text"}}snippet{{else}}{{file.filetype}}{{/if_equal}}{{else}}{{file.filetype}}{{/if_equal}}"></i>
		</a>
		{{{makeMemberPreviewLinkImage member.id 32}}}
		<span class="{{getMemberColorClassById member.id}}">{{{makeMemberPreviewLink member}}}</span>	
		<span class="title break_word">
			{{#if_equal file.mode compare="post"}}
				{{#if preview}}
					<a href="{{file.permalink}}" {{#isClient}}target="{{file.id}}"{{/isClient}} data-file-id="{{file.id}}">
						{{makeFilePrivacyLabel file}} Post
					</a>
				{{else}}
					<a href="{{file.permalink}}" {{#isClient}}target="{{file.id}}"{{/isClient}} data-file-id="{{file.id}}" {{#unless preview}}class="file_preview_link"{{/unless}}>
						{{{highlightSearchMatchesInFileTitle file.title}}}
					</a>
				{{/if}}
			{{else}}
				<a href="{{file.permalink}}" {{#isClient}}target="{{file.id}}"{{/isClient}} data-file-id="{{file.id}}" {{#unless preview}}class="file_preview_link"{{/unless}}>
					{{{highlightSearchMatchesInFileTitle file.title}}}
				</a>
			{{/if_equal}}
			<span class="no_wrap">
				{{{star 'file' file null}}}
				{{#isClient}}
					{{{fileActionsCog file}}}				
				{{/isClient}}
			</span>
		</span>
	</div>

</script>

<script id="file_masonry_item_template" type="text/x-handlebars-template"><div id="{{makeFileDomId file}}" class="file_masonry_item file_item" data-owner-id="{{file.user}}">
	{{#if file.thumb_360}}
		<a href="{{file.permalink}}" data-file-id="{{file.id}}" class="grid_image">
			<img src="{{file.thumb_360}}" {{#if_gt file.thumb_360_w compare=216}}class="full_size"{{/if_gt}} />
		</a>
	{{else}}
		<a href="{{file.permalink}}" data-file-id="{{file.id}}" class="grid_filetype_button">
			<span class="filetype_icon s48 {{file.filetype}}"></span>
		</a>
	{{/if}}

	<div class="file_masonry_metadata">
		{{{makeMemberPreviewLinkImage file.user 32}}}
		<div class="contents">

			<span class="{{getMemberColorClassById member.id}}">{{{makeMemberPreviewLink member}}}</span><br />

			<span class="overflow-ellipsis bold file_title float-left">
				<a href="{{file.permalink}}" data-file-id="{{file.id}}">
					{{#if file.title}}{{{formatFileTitle file}}}{{else}}{{file.name}}{{/if}}
				</a>		
			</span>
			<span class="float-left">{{{star 'file' file null}}}</span><br />

			{{#if file.is_external}}
				{{{external_filetype_html}}}			
			{{else}}
				{{convertFilesize file.size}} {{file.pretty_type}}
			{{/if}}<br />
		
			<span class="time">{{toCalendarDateOrNamedDayShort file.timestamp}} at {{toTime file.timestamp}}</span><br />
			{{#if file.is_public}}
				{{#if file.comments_count}}
					<a href="{{file.permalink}}" data-file-id="{{file.id}}" class="file_preview_link">{{pluralCount file.comments_count 'comment' 'comments'}}</a>
					<span class="bullet">?</span>
				{{/if}}
				{{#if file.is_shared}}
					in
					{{{makeFileGroupChannelList file}}}
					{{#isClient}}<span class="bullet">?</span>{{/isClient}}
				{{/if}}					
			{{else}}
				<i class="fa fa-eye"></i>
				Private file {{#if file.groups}}in {{{makeFileGroupChannelList file}}}{{else}}{{#unless member.is_self}}shared with you{{/unless}}{{/if}}
			{{/if}}
		</div>
	</div>		

</div>
</script>

<script id="file_preview_head_section_template" type="text/x-handlebars-template">

	<div id="file_title_container">
		{{{makeFilePreviewHeader file member}}}
	</div>
		
	<div id="file_edit_title_container" class="hidden">
		<form action="" id="file_edit_title_form" class="small_bottom_margin method="post" onSubmit="TS.files.saveEditFileTitle('{{file.id}}'); return false;">
			<p class="small_bottom_margin"><input type="text" id="file_edit_title_input" class="" name="file_edit_title_input"></input></p>
			<p class="no_bottom_margin align-right">
				<input type="button" class="btn btn-mini btn-outline" value="Cancel" onClick="TS.files.endEditFileTitle(); return false;" />
				<input type="submit" class="btn btn-primary btn-mini" value="Save Changes" />
			</p>
		</form>
	</div>
	
	{{#if file.thumb_360}}
	
		{{#if file.is_external}}
			<a href="{{file.url_private}}" target="{{file.url_private}}" class="file_preview_wrapper no_underline {{file.filetype}} {{#if_equal file.external_type compare="dropbox"}}dropbox{{/if_equal}}">
				<img src="{{#if file.thumb_360_gif}}{{file.thumb_360_gif}}{{else}}{{file.thumb_360}}{{/if}}" class="file_preview" style="width: {{file.thumb_360_w}}px; height: {{file.thumb_360_h}}px;" />
				{{#if_equal file.external_type compare="dropbox"}}
					<div class="dropbox_banner">
						<i class="fa fa-dropbox small_right_margin"></i> Open in Dropbox</div>
					</div>
				{{/if_equal}}
			</a>
		{{else}}
			{{#fileIsImage id=file.id}}
				<a href="{{file.url_private}}" target="{{file.url_private}}" title="{{#if lightbox}}Open in lightbox ({{#isMac}}cmd{{else}}ctrl{{/isMac}}+click to open original in new tab){{else}}{{#isMac}}cmd{{else}}ctrl{{/isMac}}+click to open original in new tab{{/if}}" data-file-id="{{file.id}}" class="file_preview_wrapper no_underline {{#if lightbox}}lightbox_link{{/if}}">
			{{else}}			
				<a href="{{file.url_private}}" target="{{file.url_private}}" class="file_preview_wrapper no_underline {{file.filetype}}">
			{{/fileIsImage}}
					<img src="{{#if file.thumb_360_gif}}{{file.thumb_360_gif}}{{else}}{{file.thumb_360}}{{/if}}" class="file_preview" style="width: {{file.thumb_360_w}}px; height: {{file.thumb_360_h}}px;" />
				</a>
		{{/if}}

	{{else}}
	
		<a href="{{#if file.is_external}}{{file.url}}{{else}}{{#if_equal file.filetype compare='pdf'}}{{file.url_private}}{{else}}{{file.url_private_download}}{{/if_equal}}{{/if}}" target="{{file.id}}" class="filetype_button">			
			<i class="filetype_icon {{file.filetype}} s48"></i>			
			<span class="filetype_label">
				{{convertFilesize file.size}}<br />
				<span>{{file.pretty_type}}</span> File
			</span>
			<span class="file_download_label">
				{{#if file.is_external}}
					{{#if_equal file.external_type compare="gdrive"}}						
						Open in Google Drive
					{{/if_equal}}
					{{#if_equal file.external_type compare="dropbox"}}						
						Open in Dropbox
					{{/if_equal}}
					{{#if_equal file.external_type compare="box"}}						
						Open in Box
					{{/if_equal}}					
				{{else}}
					{{#if_equal file.filetype compare='pdf'}}
						Open original in new window
					{{else}}
						<i class="fa fa-arrow-circle-down small_right_margin"></i> Download File
					{{/if_equal}}
				{{/if}}
			</span>						
		</a>

	{{/if}}

	<div class="clear-both"></div>
	
	<p class="file_page_meta">
		
		<span class="date">{{toCalendarDateOrNamedDayShort file.timestamp}} at {{toTime file.timestamp}}</span>
		<span class="bullet">?</span>
		
		{{#if file.is_external}}
			{{{external_filetype_html}}}			
		{{else}}
			<a href="{{file.url_private_download}}" target="{{file.url_private_download}}" title="Download this file" class="subtle_silver">{{convertFilesize file.size}} <span>{{file.pretty_type}}</span></a>
		{{/if}}

		<span class="bullet">?</span>
		{{{fileActionsLink file}}}		

		<br />
		
		{{#if file.is_public}}
			{{#if file.is_shared}}
				Shared in
				{{{makeFileGroupChannelList file}}}
			{{else}}
				Team file
			{{/if}}
		{{else}}
			<i class="fa fa-eye"></i> Private file 
			{{#if file.groups}}in {{{makeFileGroupChannelList file}}}{{else}}{{#unless member.is_self}}shared with you{{/unless}}{{/if}}
		{{/if}}

		{{#if file.public_url_shared}}
			<span class="bullet">?</span>
			{{> file_public_link}}
		{{/if}}
		
	</p>
	
</script>

<script id="file_post_list_item_template" type="text/x-handlebars-template">

	<div id="{{makeFileDomId file}}" class="file_list_item post">
	
		<div class="contents">
			
			{{{makeFileHeader file member}}}
			
			<p class="preview">
				{{#if for_search}}
					{{#if file.preview_search}}
						{{{nl2brAndHighlightSearchMatches file.preview_search}}}
					{{else}}
						{{{nl2br file.preview}}}
					{{/if}}
				{{else}}
					{{{nl2br file.preview}}}
				{{/if}}
				<a href="{{file.permalink}}" {{#isClient}}target="{{file.permalink}}"{{/isClient}}data-file-id="{{file.id}}" class="file_preview_link more_link">more</a>
			</p>
			<div class="file_meta">
				{{#unless file.is_public}}
					<i class="fa fa-eye"></i>
					{{makeFilePrivacyLabel file}}
					<span class="bullet">?</span>
				{{/unless}}
				<a href="{{file.permalink}}" {{#isClient}}target="{{file.permalink}}"{{/isClient}} data-file-id="{{file.id}}" class="file_preview_link"><span class="time">{{toCalendarDateOrNamedDayShort file.timestamp}} at {{toTime file.timestamp}}</span></a>
				
				{{#isClient}}
					<span class="bullet">?</span>
					{{{fileActionsLink file}}}
				{{/isClient}}

				<br />

				{{#if file.comments_count}}
					<a href="{{file.permalink}}" {{#isClient}}target="{{file.permalink}}"{{/isClient}} data-file-id="{{file.id}}" class="file_preview_link file_comment_link">{{pluralCount file.comments_count 'comment' 'comments'}}</a>
					{{#if file.is_shared}}<span class="bullet">?</span>{{/if}}
				{{/if}}

				{{#if file.is_shared}}
					Shared in {{{makeFileGroupChannelList file}}}
				{{/if}}

				{{#if file.public_url_shared}}
					<span class="bullet">?</span>
					{{> file_public_link}}
				{{/if}}

			</div>
		</div>
		
	</div>

</script>

<script id="file_post_masonry_item_template" type="text/x-handlebars-template">
	<div id="{{makeFileDomId file}}" class="file_masonry_item post file_item" data-owner-id="{{file.user}}">
		<a href="{{file.permalink}}" data-file-id="{{file.id}}" class="grid_filetype_button">
			<p class="preview">{{truncate file.preview 150}}</p>
		</a>
		<div class="file_masonry_metadata">
			{{{makeMemberPreviewLinkImage file.user 32}}}
			<div class="contents">

				<span class="{{getMemberColorClassById member.id}}">{{{makeMemberPreviewLink member}}}</span><br />

				<span class="overflow-ellipsis bold file_title float-left">
					<a href="{{file.permalink}}" data-file-id="{{file.id}}">
						{{#if file.title}}{{{formatFileTitle file}}}{{else}}{{file.name}}{{/if}}
					</a>
				</span>
				<span class="float-left">{{{star 'file' file null}}}</span><br />
				
				<span class="time">{{toCalendarDateOrNamedDayShort file.timestamp}} at {{toTime file.timestamp}}</span><br />
				{{#if file.is_public}}
					{{#if file.comments_count}}
						<a href="{{file.permalink}}" data-file-id="{{file.id}}" class="file_preview_link">{{pluralCount file.comments_count 'comment' 'comments'}}</a>
						<span class="bullet">?</span>
					{{/if}}
					{{#if file.is_shared}}
						in
						{{{makeFileGroupChannelList file}}}
						{{#isClient}}<span class="bullet">?</span>{{/isClient}}
					{{/if}}
				{{else}}
					<i class="fa fa-eye"></i>
					{{#if file.groups}}
						Private post {{#if file.groups}}in {{{makeFileGroupChannelList file}}}{{else}}{{#unless member.is_self}}shared with you{{/unless}}{{/if}}
					{{else}}
						Draft post {{#unless member.is_self}}(shared with you){{/unless}}
					{{/if}}
				{{/if}}
			</div>
		</div>

	</div>
</script>

<script id="file_post_preview_head_section_template" type="text/x-handlebars-template">

	{{{makeFilePreviewHeader file member}}}
	
	<h3 class="small_bottom_margin"><a href="{{file.permalink}}" {{#isClient}}target="{{file.id}}"{{/isClient}} data-file-id="{{file.id}}" class="indifferent_grey">{{{highlightSearchMatchesInFileTitle file.title}}}</a></h3>

	<div class="post_body">{{{file.content_html}}}</div>

	<p class="file_page_meta no_bottom_margin">

		<span class="date">{{toCalendarDateOrNamedDayShort file.timestamp}} at {{toTime file.timestamp}}</span>

		<span class="bullet">?</span>
		{{{fileActionsLink file}}}
		
	</p>

	<p class="file_page_meta no_bottom_margin">

		{{#if file.is_public}}
			{{#if file.is_shared}}
				Shared in {{{makeFileGroupChannelList file}}}
			{{/if}}
		{{else}}
			<i class="fa fa-eye"></i>
			{{makeFilePrivacyLabel file}}
			{{#unless member.is_self}}post shared with you{{/unless}}
		{{/if}}
		
		{{#if file.public_url_shared}}
			<span class="bullet">?</span>
			{{> file_public_link}}
		{{/if}}
		
	</p>
			
</script>

<script id="file_snippet_list_item_template" type="text/x-handlebars-template">
	
	<div id="{{makeFileDomId file}}" class="file_list_item snippet">
	
		<div class="contents">

			{{{makeFileHeader file member}}}

			<div class="snippet_preview">
				{{{file.preview_highlight}}}
				{{#if_gt file.lines_more compare=0}}
					<a href="{{file.permalink}}" data-file-id="{{file.id}}" class="file_preview_link snippet_preview_more" {{#isClient}}target="{{file.permalink}}"{{/isClient}} data-file-id="{{file.id}}" class="file_preview_link">+ {{file.lines_more}} more line{{#if_gt file.lines_more compare=1}}s{{/if_gt}}...</a>
				{{/if_gt}}
			</div>
			<div class="file_meta">
				{{#unless file.is_public}}
					<i class="fa fa-eye"></i>
					Private {{#unless member.is_self}}{{#unless file.groups}}snippet shared with you{{/unless}}{{/unless}} <span class="bullet">?</span>
				{{/unless}}
				<a href="{{file.permalink}}" {{#isClient}}target="{{file.permalink}}"{{/isClient}} data-file-id="{{file.id}}" class="file_preview_link"><span class="time">{{toCalendarDateOrNamedDayShort file.timestamp}} at {{toTime file.timestamp}}</span></a>
				
				<span class="bullet">?</span> 
				<a href="{{file.url_private_download}}" target="{{file.url_private_download}}" title="Download this file">{{convertFilesize file.size}} <span>{{file.pretty_type}}</span></a>
				
				{{#isClient}}
					<span class="bullet">?</span>
					{{{fileActionsLink file}}}
				{{/isClient}}

				<br />

				{{#if file.comments_count}}
					<a href="{{file.permalink}}" {{#isClient}}target="{{file.permalink}}"{{/isClient}} data-file-id="{{file.id}}" class="file_preview_link file_comment_link">{{pluralCount file.comments_count 'comment' 'comments'}}</a>
					{{#if file.is_shared}}<span class="bullet">?</span>{{/if}}
				{{/if}}
				
				{{#if file.is_shared}}
					Shared in
					{{{makeFileGroupChannelList file}}}
				{{/if}}

				{{#if file.public_url_shared}}
					<span class="bullet">?</span>
					{{> file_public_link}}
				{{/if}}	

			</div>
		</div>
		
	</div>

</script>

<script id="file_snippet_masonry_item_template" type="text/x-handlebars-template">
	<div id="{{makeFileDomId file}}" class="file_masonry_item snippet file_item" data-owner-id="{{file.user}}">
		<a href="{{file.permalink}}" data-file-id="{{file.id}}" class="grid_filetype_button">
			<div class="snippet_preview">
				{{{file.preview_highlight}}}
			</div>
		</a>
		<div class="file_masonry_metadata">
			{{{makeMemberPreviewLinkImage file.user 32}}}
			<div class="contents">

				<span class="{{getMemberColorClassById member.id}}">{{{makeMemberPreviewLink member}}}</span><br />
				
				<span class="overflow-ellipsis bold file_title float-left">
					<a href="{{file.permalink}}" data-file-id="{{file.id}}">
						{{#if file.title}}{{{formatFileTitle file}}}{{else}}{{file.name}}{{/if}}
					</a>
				</span>
				<span class="float-left">{{{star 'file' file null}}}</span><br />

				{{convertFilesize file.size}} <span>{{file.pretty_type}}</span>
				<span class="bullet">?</span> {{file.lines}} line{{#if_gt file.lines compare=1}}s{{/if_gt}}<br />
			
				<span class="time">{{toCalendarDateOrNamedDayShort file.timestamp}} at {{toTime file.timestamp}}</span><br />
				{{#if file.is_public}}
					{{#if file.comments_count}}
						<a href="{{file.permalink}}" data-file-id="{{file.id}}" class="file_preview_link">{{pluralCount file.comments_count 'comment' 'comments'}}</a>
						<span class="bullet">?</span>
					{{/if}}
					{{#if file.is_shared}}
						in
						{{{makeFileGroupChannelList file}}}
						{{#isClient}}<span class="bullet">?</span>{{/isClient}}
					{{/if}}
				{{else}}
					<i class="fa fa-eye"></i>
					Private snippet {{#if file.groups}}in {{{makeFileGroupChannelList file}}}{{else}}{{#unless member.is_self}}shared with you{{/unless}}{{/if}}
				{{/if}}
			</div>
		</div>

	</div>
</script>

<script id="file_snippet_preview_head_section_template" type="text/x-handlebars-template">

	{{{makeFilePreviewHeader file member}}}

	<pre id="{{makeFileContentsDomId file}}{{plus}}">{{#if file.content}}{{file.content}}{{else}}loading...{{/if}}</pre>

	<div class="file_page_meta" id="truncated_message"><i class="fa fa-info-circle"></i> This snippet was truncated for display: <a href="{{file.url_private}}" target="{{file.url_private}}">see it in full</a>.</div>

	<label class="checkbox normal mini float-right no_top_padding no_right_margin no_min_width">
		<input type="checkbox" id="file_preview_wrap_cb"> wrap
	</label>

	<p class="file_page_meta no_bottom_margin" style="margin-right: 3.5rem;">
		<span class="date">{{toCalendarDateOrNamedDayShort file.timestamp}} at {{toTime file.timestamp}}</span>
		<span class="bullet">?</span>
		<a href="{{file.url_private_download}}" target="{{file.url_private_download}}" title="Download this file">{{convertFilesize file.size}} <span>{{file.pretty_type}}</span> snippet</a>
		<span class="bullet">?</span>
		{{{fileActionsLink file}}}
	</p>

	<p class="file_page_meta">		
		{{#if file.is_public}}
			{{#if file.is_shared}}
				Shared in
				{{{makeFileGroupChannelList file}}}
			{{/if}}
		{{else}}
			<i class="fa fa-eye"></i> Private snippet {{#if file.groups}}in {{{makeFileGroupChannelList file}}}{{else}}{{#unless member.is_self}}shared with you{{/unless}}{{/if}}
		{{/if}}

		{{#if file.public_url_shared}}
			<span class="bullet">?</span>
			{{> file_public_link}}
		{{/if}}			
	</p>
	
</script>

<script id="file_email_preview_head_section_template" type="text/x-handlebars-template">

	{{{makeFilePreviewHeader file member}}}

	<iframe id="{{makeFileContentsDomId file}}{{plus}}" src="{{file.url_private}}" sandbox seamless srcdoc="{{file.content}}"></iframe>

	<p class="file_page_meta no_bottom_margin">
		<span class="date">{{toCalendarDateOrNamedDayShort file.timestamp}} at {{toTime file.timestamp}}</span>
		<span class="bullet">?</span>
		<a href="{{file.url_private_download}}" target="{{file.url_private_download}}" title="Download this file">{{convertFilesize file.size}} email</a>
	</p>

	<p class="file_page_meta no_bottom_margin">
		{{#if member.is_self}}
			<a href="{{file.edit_link}}" target="{{file.id}}" class="file_edit" onclick="TS.ui.snippet_dialog.startEdit('{{file.id}}'); return false">Edit</a> <span class="bullet">?</span>
			<a onclick="TS.view.deleteFile('{{file.id}}')" class="file_delete delete_link">Delete</a> <span class="bullet">?</span>
		{{else}}
			{{#if user.is_admin}}
				<a onclick="TS.view.deleteFile('{{file.id}}')" class="file_delete delete_link">Delete</a> <span class="bullet">?</span>
			{{/if}}
		{{/if}}
		<a href="{{file.url_private}}" target="{{file.id}}">View raw</a>
		{{#if dropbox_enabled}}
			<span class="bullet">?</span> 
			<a onclick="return Dropbox.save('{{file.url_download}}', '{{file.name}}');"><i class="fa fa-dropbox"></i> Save to Dropbox</a>
		{{/if}}
	</p>

	<p class="file_page_meta">
		
		{{#if file.is_public}}
			{{#if file.is_shared}}
				Shared in
				{{{makeFileGroupChannelList file}}}
			{{/if}}
			<span class="bullet">?</span> <a onclick="TS.view.shareFileInCurrentChannelOrIM('{{file.id}}')" class="share_link">Share</a>
		{{else}}
			<i class="fa fa-eye"></i> Private email {{#if file.groups}}in {{{makeFileGroupChannelList file}}}{{else}}{{#unless member.is_self}}shared with you{{/unless}}{{/if}}
			{{#if member.is_self}}
				<span class="bullet">?</span> <a onclick="TS.view.shareFileInCurrentChannelOrIM('{{file.id}}')" class="share_link">Share</a>
			{{/if}}
		{{/if}}

		{{#if show_public_link}}
			{{> file_public_link}}
		{{/if}}
				
	</p>
	
</script>

<script id="file_sharing_template" type="text/x-handlebars-template">	
	<div id="file_sharing_div">
		
		<p class="small_bottom_margin">
			<input type="hidden" id="share_model_ob_id" value="{{model_ob.id}}" />
			
			<label for="share_cb" class="select">
				<input id="share_cb" checked="checked" name="share_cb" type="checkbox" class="no_top_margin small_right_margin {{#if hide_checkbox}}hidden{{/if}}"/>Share
				<span id="share_context_label">
					{{#if_equal share_context compare="im"}}with{{else}}in{{/if_equal}}
				</span>
			</label>
			
			<select id="select_share_channels" class="file_share_select inline-block no_margin">
				{{#if channels}}
					<optgroup label="Channels">
						{{#each channels}}
							<option value="{{this.id}}" {{#if_equal ../model_ob.id compare=this.id}}selected="selected"{{/if_equal}}>#{{this.name}}</option>
						{{/each}}
					</optgroup>
				{{/if}}
				{{#if members}}
					<optgroup label="People">
						{{#each members}}
							{{#if_equal this.name compare="slackbot"}}
								<option value="{{this.id}}" {{#if_equal ../../model_ob.user compare=this.id}}selected="selected"{{/if_equal}}>{{this.name}}{{#if ../../file.is_public}}{{else}} (remains private){{/if}}</option>
							{{else}}
								<option value="{{this.id}}" {{#if_equal ../../model_ob.user compare=this.id}}selected="selected"{{/if_equal}}>{{getMemberDisplayName this}}</option>
							{{/if_equal}}
						{{/each}}
					</optgroup>
				{{/if}}
				{{#if groups}}
					<optgroup label="Private Groups">
						{{#each groups}}
							<option value="{{this.id}}" {{#if_equal ../model_ob.id compare=this.id}}selected="selected"{{/if_equal}}>{{{groupPrefix}}}{{this.name}}</option>
						{{/each}}
					</optgroup>
				{{/if}}
			</select>
			
			<span id="select_share_channels_note" class="modal_input_note {{#if_not_equal share_context compare="channel"}}hidden{{/if_not_equal}}">
				{{#if file.is_public}}
					Files you share into a channel are visible to all team members.
				{{else}}
					Files are private until they are shared in a public channel.
				{{/if}}
			</span>
			
			<span id="select_share_ims_note" class="modal_input_note {{#if_not_equal share_context compare="im"}}hidden{{/if_not_equal}}">
				{{#if file.is_public}}
					&nbsp;
				{{else}}
					This file will be private; the person you're sharing with will be able to see it.
				{{/if}}
			</span>
			
			<span id="select_share_groups_note" class="modal_input_note {{#if_not_equal share_context compare="group"}}hidden{{/if_not_equal}}">
				{{#if file.is_public}}
					&nbsp;
				{{else}}
					This file will be private; the members of the group you're sharing in will be able to see it.
				{{/if}}
			</span>
			
		</p>
		<p class="no_bottom_margin">
			<label class="inline-block align_top">
				Add Comment<br />
				<span class="input_note normal">(optional)</span>
			</label>
			<textarea id="file_comment_textarea" class="comment_input" name="comment" wrap="virtual">{{comment}}</textarea>
		</p>
	</div>
</script>

<script id="file_public_link_template" type="text/x-handlebars-template">
		
	<a class="file_public_link file_public_link_{{file.id}}" href="{{file.permalink_public}}" target="{{file.permalink_public}}">Open public link</a>
	{{#if show_revoke_public_link}}
		<a id="file_public_link_revoker" class="delete_link" onclick="TS.ui && TS.ui.fileRevokePublicLink('{{file.id}}');" data-file-id="{{file.id}}"><i class="fa fa-times"></i></a>
	{{/if}}
		
</script>


<script id="comments_template" type="text/x-handlebars-template">
	<div id="{{#if file}}{{makeFileCommentsDomId file}}{{/if}}" class="comments">
		{{{comments file}}}
	</div>
</script>

<script id="comment_template" type="text/x-handlebars-template">
	<div id="{{comment.id}}" class="comment">
		<a name="{{comment.id}}"></a>
		<span class="no_print">{{{makeMemberPreviewLinkImage comment.user 36}}}</span>
		<p class="comment_meta">
			<span class="no_print">{{{makeMemberPreviewLinkById comment.user}}}</span>
			<span class="print_only_inline"><strong>{{getMemberDisplayNameById comment.user}}</strong> ? </span>
			{{toCalendarDateOrNamedDayShort comment.timestamp}} at {{toTime comment.timestamp}}
			{{#unless hide_star}}{{#if file}}<span class="no_print">{{{star 'file_comment' comment file}}}</span>{{/if}}{{/unless}}
			{{#if show_comment_actions}}
				<a class="comment_actions" {{#if file}}data-file-id="{{file.id}}"{{/if}} data-comment-id="{{comment.id}}"><i class="comment_cog fa fa-cog"></i></a>
			{{/if}}
		</p>				
		<div class="comment_body">{{{formatMessage comment.comment}}}</div>
	</div>
</script>


<script id="messages_day_divider_template" type="text/x-handlebars-template">
	<div class="day_divider" id="{{makeDayDividerDomId ts}}" data-date="{{toCalendarDate ts}}" data-ts="{{ts}}"><hr /><i class="copy_only"><br>----- </i><div class="day_divider_label">{{toCalendarDateOrNamedDay ts}}</div><i class="copy_only"> {{toCalendarDateIfYesterdayOrTomorrow ts}} -----</i></div>
</script>

<script id="message_file_comment_template" type="text/x-handlebars-template">
	<div id="{{makeMsgDomId msg.ts}}" class="{{#if msg.no_display}}hidden{{/if}} message file_reference file_comment {{#if first_in_block}}first{{/if}} {{#if unread}}unread{{/if}} {{#if highlight}}highlight{{/if}} {{#if show_divider}}divider{{/if}} show_user {{#showAvatars}}avatar{{/showAvatars}} {{#if is_file_convo_continuation}}comment_continuation{{/if}}" data-ts="{{msg.ts}}">

		{{#unless unprocessed}}
			{{#unless standalone}}
				{{#if show_actions_cog}}
					{{{msgActions msg}}}
				{{/if}}
			{{/unless}}
		{{/unless}}

		{{#showAvatars}}
			{{#if is_file_convo_continuation}}
			{{else}}
				{{{makeMemberPreviewLinkImage member.id 36}}}
			{{/if}}
		{{/showAvatars}}

		{{#isTheme theme='dense'}}

			<span class="message_star_holder">{{{star 'file_comment' comment file}}}</span>

			{{#if permalink}}
				<i class="copy_only"><br>[</i><a href="{{permalink}}" target="{{newWindowName}}" title="{{{msgTsTitle msg}}}" class="timestamp">{{toTime msg.ts}}</a><i class="copy_only">]</i>
			{{else}}
				<i class="copy_only"><br>[</i><span title="{{{msgTsTitle msg}}}" class="timestamp">{{toTime msg.ts}}</span><i class="copy_only">]</i>
			{{/if}}
			<div class="file_details">

				{{#if is_file_convo_continuation}}
				{{else}}
					<a href="{{file.permalink}}" {{#isClient}}target="{{file.permalink}}"{{/isClient}} data-file-id="{{file.id}}" class="file_preview_link icon icon_40 {{icon_class}}">
						{{#if file.thumb_80}}
							{{#if_equal icon_class compare="thumb_40"}}					
								<img src="{{file.thumb_80}}" />
							{{else}}
								<img src="{{file.thumb_360}}" />
							{{/if_equal}}						
						{{else}}
							<span data-file-id="{{file.id}}" class="filetype_icon s24 {{file.filetype}}"></span>
						{{/if}}
						<i class="fa fa-comment icon_comment"></i>
					</a>
				{{/if}}
				<em>
					{{#if is_file_convo_continuation}}
						{{{makeMemberPreviewLink member}}} commented:
					{{else}}
						{{{makeMemberPreviewLink member}}} commented on
						{{#if uploader}}
							{{{makeMemberPreviewLink uploader}}}{{possessive uploader.name}} {{#if_equal file.mode compare="snippet"}}snippet{{else}}file{{/if_equal}}
						{{/if}}
						<a href="{{file.permalink}}" {{#isClient}}target="{{file.permalink}}"{{/isClient}} data-file-id="{{file.id}}" class="file_preview_link file_name">{{#if file.title}}{{{formatFileTitle file}}}{{else}}{{file.name}}{{/if}}</a>
						<a href="{{#if file.is_external}}{{file.url}}{{else}}{{file.permalink}}{{/if}}" target="{{file.permalink}}" class="fa fa-external-link-square icon_new_window" title="{{#if file.is_external}}Open original in new tab{{else}}Open file page{{/if}}"></a>
					{{/if}}
				</em>
				<div class="comment no_bottom_margin">{{{formatMessage comment.comment}}}</div>
			</div>
		{{/isTheme}}

		{{#isTheme theme='light'}}

			<a href="/team/{{member.name}}" {{#isClient}}target="/team/{{member.name}}"{{/isClient}} class="member {{getMemberColorClassById member.id}} message_sender" data-member-id="{{member.id}}">{{getMemberDisplayName member}}</a>
			
			{{#if permalink}}
				<i class="copy_only"><br>[</i><a href="{{permalink}}" target="{{newWindowName}}" title="{{{msgTsTitle msg}}}" class="timestamp">{{toTime msg.ts}}</a><i class="copy_only">]</i>
			{{else}}
				<i class="copy_only"><br>[</i><span title="{{{msgTsTitle msg}}}" class="timestamp">{{toTime msg.ts}}</span><i class="copy_only">]</i>
			{{/if}}
			
			<span class="message_star_holder">{{{star 'file_comment' comment file}}}</span>
			
			{{#if jump_link}}{{{jump_link}}}{{/if}}
			
			<br />
				
			{{#if is_file_convo_continuation}}
			{{else}}
				<span class="meta">
					Commented on
					{{#if uploader}}
						{{{makeMemberPreviewLinkById uploader.id false}}}{{possessive uploader.name}} {{#if_equal file.mode compare="snippet"}}snippet{{else}}file{{/if_equal}}
					{{/if}}
					<a href="{{file.permalink}}" {{#isClient}}target="{{file.permalink}}"{{/isClient}} data-file-id="{{file.id}}" class="file_preview_link file_name">{{#if file.title}}{{{formatFileTitle file}}}{{else}}{{file.name}}{{/if}}</a>
					{{#if file.is_external}}
						<a {{{makeRefererSafeLink url=file.url}}} target="{{newWindowName}}" data-toggle="tooltip" title="Open file in a new tab">
					{{else}}
						<a href="{{file.permalink}}" target="{{newWindowName}}" data-toggle="tooltip" title="Open file in a new tab">
					{{/if}}
					<i class="fa fa-external-link-square file_inline_icon"></i></a>
				</span>
				<br />
			{{/if}}
			
			{{#if show_comment_quote_icon}}
				<i class="icon_quote float-left fa fa-quote-left"></i>
			{{/if}}

			<p class="comment small_bottom_margin">{{{formatMessage comment.comment}}}</p>
			
		{{/isTheme}}		

	</div>
</script>

<script id="message_file_post_comment_template" type="text/x-handlebars-template">
	<div id="{{makeMsgDomId msg.ts}}" class="{{#if msg.no_display}}hidden{{/if}} message file_reference file_post_comment {{#if first_in_block}}first{{/if}} {{#if unread}}unread{{/if}} {{#if highlight}}highlight{{/if}} {{#if show_divider}}divider{{/if}} show_user {{#showAvatars}}avatar{{/showAvatars}} {{#if is_file_convo_continuation}}comment_continuation{{/if}}" data-ts="{{msg.ts}}">

		{{#unless unprocessed}}
			{{#unless standalone}}
				{{#if show_actions_cog}}
					{{{msgActions msg}}}
				{{/if}}
			{{/unless}}
		{{/unless}}
		
		{{#showAvatars}}
			{{#if is_file_convo_continuation}}
			{{else}}
				{{{makeMemberPreviewLinkImage member.id 36}}}
			{{/if}}
		{{/showAvatars}}

		{{#isTheme theme='dense'}}
			<span class="message_star_holder">{{{star 'file_comment' comment file}}}</span>
			
			{{#if permalink}}
				<i class="copy_only"><br>[</i><a href="{{permalink}}" target="{{newWindowName}}" title="{{{msgTsTitle msg}}}" class="timestamp">{{toTime msg.ts}}</a><i class="copy_only">]</i>
			{{else}}
				<i class="copy_only"><br>[</i><span title="{{{msgTsTitle msg}}}" class="timestamp">{{toTime msg.ts}}</span><i class="copy_only">]</i>
			{{/if}}
			<em>
			{{#if is_file_convo_continuation}}
					{{{makeMemberPreviewLink member}}} commented:
			{{else}}
				{{{makeMemberPreviewLink member}}} commented on
				{{#if uploader}}
					{{{makeMemberPreviewLink uploader}}}'s post
				{{/if}}
				<a href="{{file.permalink}}" {{#isClient}}target="{{file.permalink}}"{{/isClient}} data-file-id="{{file.id}}" class="file_preview_link file_name">{{#if file.title}}{{{formatFileTitle file}}}{{else}}{{file.name}}{{/if}}</a>
				<a href="{{file.permalink}}" target="{{file.permalink}}" class="fa fa-external-link-square icon_new_window" title="Open file page"></a>
			{{/if}}
			</em>
			<p class="no_bottom_margin">{{{formatMessage comment.comment}}}</p>
		{{/isTheme}}

		{{#isTheme theme='light'}}

			<a href="/team/{{member.name}}" {{#isClient}}target="/team/{{member.name}}"{{/isClient}} class="member {{getMemberColorClassById member.id}} message_sender" data-member-id="{{member.id}}">{{getMemberDisplayName member}}</a>
			
			{{#if permalink}}
				<i class="copy_only"><br>[</i><a href="{{permalink}}" target="{{newWindowName}}" title="{{{msgTsTitle msg}}}" class="timestamp">{{toTime msg.ts}}</a><i class="copy_only">]</i>
			{{else}}
				<i class="copy_only"><br>[</i><span title="{{{msgTsTitle msg}}}" class="timestamp">{{toTime msg.ts}}</span><i class="copy_only">]</i>
			{{/if}}
			
			<span class="message_star_holder">{{{star 'file_comment' comment file}}}</span><br />
			
			{{#if jump_link}}{{{jump_link}}}{{/if}}
				
			{{#if is_file_convo_continuation}}
			{{else}}
				<span class="meta">
					Commented on
					{{#if uploader}}
						{{{makeMemberPreviewLinkById uploader.id false}}}'s post
					{{/if}}
					<a href="{{file.permalink}}" {{#isClient}}target="{{file.permalink}}"{{/isClient}} data-file-id="{{file.id}}" class="file_preview_link file_name">{{#if file.title}}{{{formatFileTitle file}}}{{else}}{{file.name}}{{/if}}</a>
					<a href="{{file.permalink}}" target="{{newWindowName}}" data-toggle="tooltip" title="Open post in a new tab"><i class="fa fa-external-link-square file_inline_icon"></i></a>
				</span><br />
			{{/if}}
			
			{{#if show_comment_quote_icon}}
				<i class="icon_quote float-left fa fa-quote-left"></i>
			{{/if}}

			<div class="comment no_bottom_margin">{{{formatMessage comment.comment}}}</div>

		{{/isTheme}}		
						
	</div>
</script>

<script id="message_file_share_template" type="text/x-handlebars-template">
	<div id="{{makeMsgDomId msg.ts}}" class="{{#if msg.no_display}}hidden{{/if}} message file_reference {{#if is_mention}}file_mention{{else}}file_share{{/if}} {{#if first_in_block}}first{{/if}} {{#if unread}}unread{{/if}} {{#if highlight}}highlight{{/if}} {{#if show_divider}}divider{{/if}} show_user {{#showAvatars}}avatar{{/showAvatars}}" data-ts="{{msg.ts}}">

		{{#unless unprocessed}}
			{{#unless standalone}}
				{{#if show_actions_cog}}
					{{{msgActions msg}}}
				{{/if}}
			{{/unless}}
		{{/unless}}

		{{#showAvatars}}
			{{{makeMemberPreviewLinkImage member.id 36}}}
		{{/showAvatars}}

		{{#isTheme theme='dense'}}

			<span class="message_star_holder">{{{star 'file' file null}}}</span>

			{{#if permalink}}
				<i class="copy_only"><br>[</i><a href="{{permalink}}" target="{{newWindowName}}" title="{{{msgTsTitle msg}}}" class="timestamp">{{toTime msg.ts}}</a><i class="copy_only">]</i>
			{{else}}
				<i class="copy_only"><br>[</i><span title="{{{msgTsTitle msg}}}" class="timestamp">{{toTime msg.ts}}</span><i class="copy_only">]</i>
			{{/if}}
			<em>
				{{{makeMemberPreviewLink member}}} {{#if is_mention}}mentioned{{else}}shared{{/if}}:
				{{#if uploader}}
					{{{makeMemberPreviewLink uploader}}}{{possessive uploader.name}} file:
				{{/if}}
			</em>
			<a href="{{#if file.is_external}}{{file.url}}{{else}}{{file.permalink}}{{/if}}" target="{{#if file.is_external}}{{file.url}}{{else}}{{file.permalink}}{{/if}}" class="fa fa-external-link-square icon_new_window" title="{{#if file.is_external}}Open original in new tab{{else}}Open file page{{/if}}"></a>
			<div class="file_details">
				{{#if file.is_external}}
					<a href="{{file.url}}" {{#isClient}}target="{{file.url}}"{{/isClient}} data-file-id="{{file.id}}" class="icon icon_40 {{icon_class}}" title="Open original in new tab">
				{{else}}
					{{#fileIsImage id=file.id}}
						<a href="{{file.url}}" {{#isClient}}target="{{file.url}}"{{/isClient}} data-file-id="{{file.id}}" class="file_preview_link icon icon_40 {{icon_class}} {{#if lightbox}}lightbox_link{{/if}}" title="Open in lightbox ({{#isMac}}cmd{{else}}ctrl{{/isMac}}+click to open original in new tab)">
					{{else}}
						<a href="{{file.url}}" {{#isClient}}target="{{file.url}}"{{/isClient}} data-file-id="{{file.id}}" class="icon icon_40 {{icon_class}}" title="Open original in new tab">
					{{/fileIsImage}}
				{{/if}}
					{{#if file.thumb_80}}
						{{#if_equal icon_class compare="thumb_40"}}					
							<img src="{{file.thumb_80}}" />
						{{else}}
							<img src="{{file.thumb_360}}" />
						{{/if_equal}}						
					{{else}}
						<span data-file-id="{{file.id}}" class="filetype_icon s24 {{file.filetype}}"></span>
					{{/if}}
				</a>
				<span class="float-left" style="width: 85%">				
					<a href="{{file.permalink}}"{{#isClient}}target="{{file.permalink}}"{{/isClient}}  data-file-id="{{file.id}}" class="file_preview_link file_name">{{#if file.title}}{{{formatFileTitle file}}}{{else}}{{file.name}}{{/if}}</a>
					{{#unless file.thumb_360}}
						{{#unless file.is_external}}
							<a href="{{file.url_private_download}}" target="{{file.url_private_download}}" target="{{newWindowName}}" data-toggle="tooltip" title="Download file"><i class="fa fa-cloud-download file_inline_icon"></i></a>
						{{/unless}}
					{{/unless}}				
					{{#unless standalone}}
						{{#if file.thumb_360_gif}}
							{{{inlineImgToggler file.thumb_360_gif msg_dom_id}}}
						{{else}}
							{{{inlineImgToggler file.thumb_360 msg_dom_id}}}
						{{/if}}
					{{/unless}}
					<br />
					{{#if file.is_shared}}
						in
						{{{makeFileGroupChannelList file}}}
					{{/if}}

					<span class="bullet">?</span>
					<a href="{{file.permalink}}" {{#isClient}}target="{{file.permalink}}"{{/isClient}} data-file-id="{{file.id}}" class="file_preview_link file_comment_link">
						{{#if file.comments_count}}{{pluralCount file.comments_count 'comment' 'comments'}}{{else}}Add comment{{/if}}
					</a>
					
					{{#fileIsImage id=file.id}}
						<span class="bullet">?</span>
						<a href="{{file.url_private}}" target="{{file.url_private}}" data-file-id="{{file.id}}">Open original</a>
					{{/fileIsImage}}
					
				</span>
				<div class="clear-both"></div>
			</div>

			{{#unless standalone}}
				{{#if file.thumb_360_gif}}
					{{{inlineImgDiv file.thumb_360_gif msg_dom_id}}}
				{{else}}
					{{{inlineImgDiv file.thumb_360 msg_dom_id}}}
				{{/if}}

				{{#if show_initial_comment}}
				{{#if file.initial_comment}}
					<p class="small_top_margin no_bottom_margin">{{{formatMessage file.initial_comment.comment}}}</p>
				{{/if}}
				{{/if}}
			{{/unless}}

		{{/isTheme}}

		{{#isTheme theme='light'}}

			<a href="/team/{{member.name}}" {{#isClient}}target="/team/{{member.name}}"{{/isClient}} class="member {{getMemberColorClassById member.id}} message_sender" data-member-id="{{member.id}}">{{getMemberDisplayName member}}</a>
			
			{{#if permalink}}
				<i class="copy_only"><br>[</i><a href="{{permalink}}" target="{{newWindowName}}" title="{{{msgTsTitle msg}}}" class="timestamp">{{toTime msg.ts}}</a><i class="copy_only">]</i>
			{{else}}
				<i class="copy_only"><br>[</i><span title="{{{msgTsTitle msg}}}" class="timestamp">{{toTime msg.ts}}</span><i class="copy_only">]</i>
			{{/if}}
			
			<span class="message_star_holder">{{{star 'file' file null}}}</span>
			
			<br />
			
			{{#if jump_link}}{{{jump_link}}}{{/if}}
				
			<span class="meta">
				<a href="{{file.permalink}}" {{#isClient}}target="{{file.permalink}}"{{/isClient}}data-file-id="{{file.id}}" class="file_preview_link file_name">
					{{#if file.title}}{{{formatFileTitle file}}}{{else}}{{file.name}}{{/if}}
				</a>
				{{#if file.is_external}}
					<a href="{{#if file.is_external}}{{file.url}}{{else}}{{file.permalink}}{{/if}}" target="{{newWindowName}}" data-toggle="tooltip" title="Open file on {{#if_equal file.external_type compare="gdrive"}}Google Drive{{/if_equal}}{{#if_equal file.external_type compare="dropbox"}}Dropbox{{/if_equal}}{{#if_equal file.external_type compare="box"}}Box{{/if_equal}}{{#if_equal file.external_type compare="unknown"}}a web page{{/if_equal}}"><i class="fa fa-external-link-square file_inline_icon"></i></a>
				{{/if}}
				{{#unless file.thumb_360}}
					{{#unless file.is_external}}
						<a href="{{file.url_private_download}}" target="{{newWindowName}}" data-toggle="tooltip" title="Download file"><i class="fa fa-cloud-download file_inline_icon"></i></a>
					{{/unless}}
				{{/unless}}				
			</span>
			
			{{#unless standalone}}
				{{#if file.thumb_360_gif}}
					{{{inlineImgToggler file.thumb_360_gif msg_dom_id}}}
				{{else}}
					{{{inlineImgToggler file.thumb_360 msg_dom_id}}}
				{{/if}}

				{{#if file.thumb_360_gif}}
					{{{inlineImgDiv file.thumb_360_gif msg_dom_id}}}
				{{else}}
					{{{inlineImgDiv file.thumb_360 msg_dom_id}}}
				{{/if}}
			{{/unless}}

			<span class="meta block">
				{{#if file.is_external}}
					{{#if_equal file.external_type compare="gdrive"}}						
						<a href="{{file.url}}" class="no_underline" target="{{newWindowName}}" data-toggle="tooltip" title="Open file on Google Drive"><img src="/img/services/gdrive_16.png" class="gdrive_icon file_service_icon grayscale" /></a>
					{{/if_equal}}
					{{#if_equal file.external_type compare="dropbox"}}						
						<a href="{{file.url}}" class="no_underline" target="{{newWindowName}}" data-toggle="tooltip" title="Open file on Dropbox"><i class="fa fa-dropbox file_service_icon"></i></a>
					{{/if_equal}}
					{{#if_equal file.external_type compare="box"}}						
						<a href="{{file.url}}" class="no_underline" target="{{newWindowName}}" data-toggle="tooltip" title="Open file on Box"><img src="/plugins/box/assets/service_32.png" class="box_icon file_service_icon grayscale" /></a>
					{{/if_equal}}
				{{else}}
					<i class="fa fa-arrow-circle-right"></i> 
				{{/if}}
				{{#if is_mention}}Mentioned{{else}}Shared{{/if}} {{#if uploader}}{{{makeMemberPreviewLinkById uploader.id false}}}{{possessive uploader.name}}{{else}}{{/if}} 
				{{#if file.is_external}}
					{{{external_filetype_html}}}
				{{else}}
					File
				{{/if}}
				{{#unless file.is_external}}
					<span class="bullet">?</span>
					<a href="{{file.url_private_download}}" target="{{file.url_private_download}}" class="file_download_link" title="Download this file">{{convertFilesize file.size}} <span>{{file.pretty_type}}</span></a>
				{{/unless}}
				{{#if file.is_shared}}
					<span class="bullet">?</span>
					in {{{makeFileGroupChannelList file}}}
				{{/if}}
				{{#unless standalone}}
					<span class="bullet">?</span>
					<a href="{{file.permalink}}" {{#isClient}}target="{{file.permalink}}"{{/isClient}} data-file-id="{{file.id}}" class="file_preview_link file_comment_link">
						{{#if file.comments_count}}{{pluralCount file.comments_count 'comment' 'comments'}}{{else}}Add comment{{/if}}
					</a>
				{{/unless}}
				{{#fileIsImage id=file.id}}
					<span class="bullet">?</span>
					<a href="{{file.url_private}}" target="{{file.url_private}}" data-file-id="{{file.id}}">Open original</a>
				{{/fileIsImage}}				
			</span>

			{{#unless standalone}}
				{{#if show_initial_comment}}
				{{#if file.initial_comment}}
					<div class="initial_comment">
						<i class="icon_quote float-left fa fa-quote-left"></i>
						<div class="comment no_bottom_margin">
							{{{formatMessage file.initial_comment.comment}}}
						</div>
					</div>
				{{/if}}
				{{/if}}
			{{/unless}}

		{{/isTheme}}		

	</div>
</script>

<script id="message_file_post_share_template" type="text/x-handlebars-template">
	<div id="{{makeMsgDomId msg.ts}}" class="{{#if msg.no_display}}hidden{{/if}} message file_reference {{#if is_mention}}file_mention{{else}}file_share{{/if}} {{#if first_in_block}}first{{/if}} {{#if unread}}unread{{/if}} {{#if highlight}}highlight{{/if}} {{#if show_divider}}divider{{/if}} show_user {{#showAvatars}}avatar{{/showAvatars}}" data-ts="{{msg.ts}}">

		{{#unless unprocessed}}
			{{#unless standalone}}
				{{#if show_actions_cog}}
					{{{msgActions msg}}}
				{{/if}}
			{{/unless}}
		{{/unless}}

		{{#showAvatars}}
			{{{makeMemberPreviewLinkImage member.id 36}}}
		{{/showAvatars}}

		{{#isTheme theme='dense'}}

			<span class="message_star_holder">{{{star 'file' file null}}}</span>
			
			{{#if permalink}}
				<i class="copy_only"><br>[</i><a href="{{permalink}}" target="{{newWindowName}}" title="{{{msgTsTitle msg}}}" class="timestamp">{{toTime msg.ts}}</a><i class="copy_only">]</i>
			{{else}}
				<i class="copy_only"><br>[</i><span title="{{{msgTsTitle msg}}}" class="timestamp">{{toTime msg.ts}}</span><i class="copy_only">]</i>
			{{/if}}
		
			{{#if uploader}}
				<em>{{{makeMemberPreviewLink member}}} {{#if is_mention}}mentioned{{else}}shared{{/if}}:</em>
			{{/if}}
		
			<div class="post_meta">
				<span class="float-left small_right_margin">
					{{{makeMemberPreviewLinkImage file.user 32}}}
				</span>
				<span class="float-left" style="width: 85%">				
					{{{makeMemberPreviewLinkById file.user false}}} {{#unless uploader}}{{#if is_mention}}mentioned{{else}}shared{{/if}}:{{/unless}}<br />
					<a href="{{file.permalink}}" {{#isClient}}target="{{file.permalink}}"{{/isClient}} data-file-id="{{file.id}}" class="file_preview_link file_name bold">{{#if file.title}}{{{formatFileTitle file}}}{{else}}{{file.name}}{{/if}}</a>
					<a href="{{file.permalink}}" target="{{file.permalink}}" class="fa fa-external-link-square icon_new_window" title="Open file page"></a><br />				
				</span>
				<div class="clear-both"></div>				
			</div>

			{{#unless standalone}}
				<div class="post_preview">
					{{{nl2br file.preview}}}
					<a href="{{file.permalink}}" {{#isClient}}target="{{file.permalink}}"{{/isClient}}data-file-id="{{file.id}}" class="file_preview_link">more</a>
				</div>

				<span class="meta block post_meta">
					{{#memberIsSelf id=member.id}} 
						{{#unless uploader}}
							<a href="{{file.permalink}}/edit">Edit</a>
							<span class="bullet">?</span>
						{{/unless}}
					{{/memberIsSelf}}
					<a href="{{file.permalink}}" target="{{file.id}}">New window</a>
					<span class="bullet">?</span>
					<a href="{{file.permalink}}" {{#isClient}}target="{{file.permalink}}"{{/isClient}} data-file-id="{{file.id}}" class="file_preview_link file_comment_link">
						{{#if file.comments_count}}{{pluralCount file.comments_count 'comment' 'comments'}}{{else}}Add comment{{/if}}
					</a>
				</span>
		
				{{#if show_initial_comment}}
					{{#if file.initial_comment}}
						<p class="small_top_margin no_bottom_margin">{{{formatMessage file.initial_comment.comment}}}</p>
					{{/if}}
				{{/if}}
			{{/unless}}

		{{/isTheme}}

		{{#isTheme theme='light'}}

			<a href="/team/{{member.name}}" {{#isClient}}target="/team/{{member.name}}"{{/isClient}} class="member {{getMemberColorClassById member.id}} message_sender" data-member-id="{{member.id}}">{{getMemberDisplayName member}}</a>

			{{#if permalink}}
				<i class="copy_only"><br>[</i><a href="{{permalink}}" target="{{newWindowName}}" title="{{{msgTsTitle msg}}}" class="timestamp">{{toTime msg.ts}}</a><i class="copy_only">]</i>
			{{else}}
				<i class="copy_only"><br>[</i><span title="{{{msgTsTitle msg}}}" class="timestamp">{{toTime msg.ts}}</span><i class="copy_only">]</i>
			{{/if}}
			
			<span class="message_star_holder">{{{star 'file' file null}}}</span><br />
			
			{{#if jump_link}}{{{jump_link}}}{{/if}}
				
			<span class="meta">
				<i class="fa fa-arrow-circle-right"></i> {{#if is_mention}}Mentioned{{else}}Shared{{/if}} {{#if uploader}}{{{makeMemberPreviewLinkById uploader.id false}}}'s{{else}}a{{/if}} post: 
				<a href="{{file.permalink}}" {{#isClient}}target="{{file.permalink}}"{{/isClient}}data-file-id="{{file.id}}" class="file_preview_link file_name">{{#if file.title}}{{{formatFileTitle file}}}{{else}}{{file.name}}{{/if}}</a>
				<a href="{{file.permalink}}" target="{{newWindowName}}" data-toggle="tooltip" title="Open post in a new tab"><i class="fa fa-external-link-square file_inline_icon"></i></a>
			</span>
					
			{{#unless standalone}}
				<div class="post_preview">
					{{{nl2br file.preview}}}
					<a href="{{file.permalink}}" {{#isClient}}target="{{file.permalink}}"{{/isClient}}data-file-id="{{file.id}}" class="file_preview_link">more</a>
				</div>
			
				<span class="meta block post_meta">
					{{#memberIsSelf id=member.id}} 
						{{#unless uploader}}
							<a href="{{file.permalink}}/edit">Edit</a>
							<span class="bullet">?</span>
						{{/unless}}
					{{/memberIsSelf}}
					<a href="{{file.permalink}}" target="{{file.id}}">New window</a>
					<span class="bullet">?</span>
					<a href="{{file.permalink}}" {{#isClient}}target="{{file.permalink}}"{{/isClient}} data-file-id="{{file.id}}" class="file_preview_link file_comment_link">
						{{#if file.comments_count}}{{pluralCount file.comments_count 'comment' 'comments'}}{{else}}Add comment{{/if}}
					</a>
				</span>
		
				{{#if show_initial_comment}}
					{{#if file.initial_comment}}
						<div class="initial_comment">
							<i class="icon_quote float-left fa fa-quote-left"></i>
							<p class="no_bottom_margin">
								{{{formatMessage file.initial_comment.comment}}}
							</p>
						</div>
					{{/if}}
				{{/if}}
			{{/unless}}

		{{/isTheme}}		
		
	</div>
</script>

<script id="message_file_snippet_share_template" type="text/x-handlebars-template">
	<div id="{{makeMsgDomId msg.ts}}" class="{{#if msg.no_display}}hidden{{/if}} message file_reference {{#if is_mention}}file_mention{{else}}file_share{{/if}} {{#if first_in_block}}first{{/if}} {{#if unread}}unread{{/if}} {{#if highlight}}highlight{{/if}} {{#if show_divider}}divider{{/if}} show_user {{#showAvatars}}avatar{{/showAvatars}}" data-ts="{{msg.ts}}">

		{{#unless unprocessed}}
			{{#unless standalone}}
				{{#if show_actions_cog}}
					{{{msgActions msg}}}
				{{/if}}
			{{/unless}}
		{{/unless}}

		{{#showAvatars}}
			{{{makeMemberPreviewLinkImage member.id 36}}}
		{{/showAvatars}}

		{{#isTheme theme='dense'}}
			<span class="message_star_holder">{{{star 'file' file null}}}</span>
			
			{{#if permalink}}
				<i class="copy_only"><br>[</i><a href="{{permalink}}" target="{{newWindowName}}" title="{{{msgTsTitle msg}}}" class="timestamp">{{toTime msg.ts}}</a><i class="copy_only">]</i>
			{{else}}
				<i class="copy_only"><br>[</i><span title="{{{msgTsTitle msg}}}" class="timestamp">{{toTime msg.ts}}</span><i class="copy_only">]</i>
			{{/if}}
			{{#if uploader}}
				<em>{{{makeMemberPreviewLink member}}} {{#if is_mention}}mentioned{{else}}shared{{/if}}:</em>
			{{/if}}

			<div class="meta">
				<span class="float-left small_right_margin">
					{{{makeMemberPreviewLinkImage file.user 32}}}
				</span>
				<span class="float-left" style="width: 85%">
					{{{makeMemberPreviewLinkById file.user false}}} {{#unless uploader}}{{#if is_mention}}mentioned{{else}}shared{{/if}}:{{/unless}}<br />
					<a href="{{file.permalink}}" {{#isClient}}target="{{file.permalink}}"{{/isClient}} data-file-id="{{file.id}}" class="file_preview_link file_name bold">{{#if file.title}}{{{formatFileTitle file}}}{{else}}{{file.name}}{{/if}}</a>
					<a href="{{file.permalink}}" target="{{file.permalink}}" class="fa fa-external-link-square icon_new_window" title="Open file page"></a>
				</span>
				<div class="clear-both"></div>				
			</div>
		
			{{#unless standalone}}
				<div class="snippet_preview">
					{{{file.preview_highlight}}}
					{{#if_gt file.lines_more compare=0}}
						<a href="{{file.permalink}}" data-file-id="{{file.id}}" class="file_preview_link snippet_preview_more" {{#isClient}}target="{{file.permalink}}"{{/isClient}} data-file-id="{{file.id}}">+ {{file.lines_more}} more line{{#if_gt file.lines_more compare=1}}s{{/if_gt}}...</a>
					{{/if_gt}}
				</div>
		
				<div class="snippet_meta">
					<a href="{{file.url_private_download}}" target="{{file.url_private_download}}" title="Download this file">{{convertFilesize file.size}} <span>{{file.pretty_type}}</span></a>
					<span class="bullet">?</span>
					{{#memberIsSelf id=member.id}} 
						{{#unless uploader}}
							<a href="{{file.edit_link}}" target="{{file.id}}" class="file_edit" onclick="TS.ui.snippet_dialog.startEdit('{{file.id}}'); return false">Edit</a> <span class="bullet">?</span>
						{{/unless}}
					{{/memberIsSelf}}
					<a href="{{file.permalink}}" target="{{file.id}}">New window</a>
					<span class="bullet">?</span> 
					<a href="{{file.url_private}}" target="{{file.id}}">View raw</a>
					<span class="bullet">?</span>
					<a href="{{file.permalink}}" {{#isClient}}target="{{file.permalink}}"{{/isClient}} data-file-id="{{file.id}}" class="file_preview_link file_comment_link">
						{{#if file.comments_count}}{{pluralCount file.comments_count 'comment' 'comments'}}{{else}}Add comment{{/if}}
					</a>
				</div>

				{{#if show_initial_comment}}
				{{#if file.initial_comment}}
					<p class="small_top_margin no_bottom_margin">{{{formatMessage file.initial_comment.comment}}}</p>
				{{/if}}
				{{/if}}
			{{/unless}}

		{{/isTheme}}

		{{#isTheme theme='light'}}

			<a href="/team/{{member.name}}" {{#isClient}}target="/team/{{member.name}}"{{/isClient}} class="member {{getMemberColorClassById member.id}} message_sender" data-member-id="{{member.id}}">{{getMemberDisplayName member}}</a>

			{{#if permalink}}
				<i class="copy_only"><br>[</i><a href="{{permalink}}" target="{{newWindowName}}" title="{{{msgTsTitle msg}}}" class="timestamp">{{toTime msg.ts}}</a><i class="copy_only">]</i>
			{{else}}
				<i class="copy_only"><br>[</i><span title="{{{msgTsTitle msg}}}" class="timestamp">{{toTime msg.ts}}</span><i class="copy_only">]</i>
			{{/if}}
			
			<span class="message_star_holder">{{{star 'file' file null}}}</span><br />
			
			{{#if jump_link}}{{{jump_link}}}{{/if}}

			<span class="meta">
				<i class="fa fa-arrow-circle-right"></i> {{#if is_mention}}Mentioned{{else}}Shared{{/if}} {{#if uploader}}{{{makeMemberPreviewLinkById uploader.id false}}}'s{{else}}a{{/if}} snippet: 
				<a href="{{file.permalink}}" {{#isClient}}target="{{file.permalink}}"{{/isClient}} data-file-id="{{file.id}}" class="file_preview_link file_name">{{#if file.title}}{{{formatFileTitle file}}}{{else}}{{file.name}}{{/if}}</a>
			</span><br />

			{{#unless standalone}}
				<div class="snippet_preview">
					{{{file.preview_highlight}}}
					{{#if_gt file.lines_more compare=0}}
						<a href="{{file.permalink}}" data-file-id="{{file.id}}" class="file_preview_link snippet_preview_more" {{#isClient}}target="{{file.permalink}}"{{/isClient}} data-file-id="{{file.id}}">+ {{file.lines_more}} more line{{#if_gt file.lines_more compare=1}}s{{/if_gt}}...</a>
					{{/if_gt}}
				</div>
			
				<span class="meta block snippet_meta">
					<a href="{{file.url_private_download}}" target="{{file.url_private_download}}" title="Download this file">{{convertFilesize file.size}} <span>{{file.pretty_type}}</span></a>
					<span class="bullet">?</span> 
					{{#memberIsSelf id=member.id}} 
						{{#unless uploader}}
							<a href="{{file.edit_link}}" target="{{file.id}}" class="file_edit" onclick="TS.ui.snippet_dialog.startEdit('{{file.id}}'); return false">Edit</a> <span class="bullet">?</span>
						{{/unless}}
					{{/memberIsSelf}}
					<a href="{{file.permalink}}" target="{{file.id}}">New window</a>
					<span class="bullet">?</span> 
					<a href="{{file.url_private}}" target="{{file.id}}">View raw</a>
					<span class="bullet">?</span>
					<a href="{{file.permalink}}" {{#isClient}}target="{{file.permalink}}"{{/isClient}} data-file-id="{{file.id}}" class="file_preview_link file_comment_link">
						{{#if file.comments_count}}{{pluralCount file.comments_count 'comment' 'comments'}}{{else}}Add comment{{/if}}
					</a>
				</span>

				{{#if show_initial_comment}}
				{{#if file.initial_comment}}
					<div class="initial_comment">
						<i class="icon_quote float-left fa fa-quote-left"></i>
						<div class="comment no_bottom_margin">
							{{{formatMessage file.initial_comment.comment}}}
						</div>
					</div>
				{{/if}}
				{{/if}}
			{{/unless}}

		{{/isTheme}}		

	</div>
</script>

<script id="message_file_upload_template" type="text/x-handlebars-template">
	<div id="{{makeMsgDomId msg.ts}}" class="message file_reference file_upload {{#if first_in_block}}first{{/if}} {{#if unread}}unread{{/if}} {{#if highlight}}highlight{{/if}} {{#if show_divider}}divider{{/if}} show_user {{#showAvatars}}avatar{{/showAvatars}}" data-ts="{{msg.ts}}">

		{{#unless unprocessed}}
			{{#unless standalone}}
				{{#if show_actions_cog}}
					{{{msgActions msg}}}
				{{/if}}
			{{/unless}}
		{{/unless}}

		{{#showAvatars}}
			{{{makeMemberPreviewLinkImage member.id 36}}}
		{{/showAvatars}}
		
		{{#isTheme theme='dense'}}

			<span class="message_star_holder">{{{star 'file' file null}}}</span>
			
			{{#if permalink}}
				<i class="copy_only"><br>[</i><a href="{{permalink}}" target="{{newWindowName}}" title="{{{msgTsTitle msg}}}" class="timestamp">{{toTime msg.ts}}</a><i class="copy_only">]</i>
			{{else}}
				<i class="copy_only"><br>[</i><span title="{{{msgTsTitle msg}}}" class="timestamp">{{toTime msg.ts}}</span><i class="copy_only">]</i>
			{{/if}}

			<div class="file_details">

				{{#if file.is_external}}
					<a href="{{file.url}}" {{#isClient}}target="{{file.url}}"{{/isClient}} data-file-id="{{file.id}}" class="icon {{icon_class}}" title="Open original in new tab">
				{{else}}
					{{#fileIsImage id=file.id}}
						<a href="{{file.url}}" {{#isClient}}target="{{file.url}}"{{/isClient}} data-file-id="{{file.id}}" class="file_preview_link icon {{icon_class}} {{#if lightbox}}lightbox_link{{/if}}" title="Open in lightbox ({{#isMac}}cmd{{else}}ctrl{{/isMac}}+click to open original in new tab)">
					{{else}}
						<a href="{{file.url}}" {{#isClient}}target="{{file.url}}"{{/isClient}} data-file-id="{{file.id}}" class="icon {{icon_class}}" title="Open original in new tab">
					{{/fileIsImage}}
				{{/if}}
					{{#if file.thumb_80}}
						{{#if_equal icon_class compare="thumb_80"}}					
							<img src="{{file.thumb_80}}" />
						{{else}}
							<img src="{{file.thumb_360}}" />
						{{/if_equal}}						
					{{else}}
						<span data-file-id="{{file.id}}" class="filetype_icon s48 {{file.filetype}}"></span>
					{{/if}}
					{{#if show_initial_comment}}{{#if file.initial_comment}}<i class="fa fa-comment icon_comment"></i>{{/if}}{{/if}}
				</a>

				<em>
					<a href="/team/{{member.name}}" {{#isClient}}target="/team/{{member.name}}"{{/isClient}} class="member bold {{getMemberColorClassById member.id}}" data-member-id="{{member.id}}">{{getMemberDisplayName member}}</a> uploaded 
					{{#if show_initial_comment}}{{#if file.initial_comment}}and commented on{{/if}}{{/if}}
					a file: 			
				</em>

				<a href="{{#if file.is_external}}{{file.url}}{{else}}{{file.permalink}}{{/if}}" target="{{#if file.is_external}}{{file.url}}{{else}}{{file.permalink}}{{/if}}" class="fa fa-external-link-square icon_new_window" title="{{#if file.is_external}}Open original in new tab{{else}}Open file page{{/if}}"></a><br />

				<a href="{{file.permalink}}" {{#isClient}}target="{{file.permalink}}"{{/isClient}} data-file-id="{{file.id}}" class="file_preview_link file_name">{{#if file.title}}{{{formatFileTitle file}}}{{else}}{{file.name}}{{/if}}</a> 
				
				{{#unless file.thumb_360}}
					<a href="{{file.url_private_download}}" target="{{newWindowName}}" data-toggle="tooltip" title="Download file"><i class="fa fa-cloud-download file_inline_icon"></i></a>
				{{/unless}}				
				
				{{#unless standalone}}
					{{#if file.thumb_360_gif}}
						{{{inlineImgToggler file.thumb_360_gif msg_dom_id}}}
					{{else}}
						{{{inlineImgToggler file.thumb_360 msg_dom_id}}}
					{{/if}}<br />
				{{/unless}}

				<a href="{{file.url_private_download}}" target="{{file.url_private_download}}" class="file_download_link" title="Download this file">{{convertFilesize file.size}} {{file.pretty_type}} file</a>

				{{#if file.is_shared}}
					<span class="bullet">?</span>
					in
					{{{makeFileGroupChannelList file}}}
				{{/if}}

				{{#unless standalone}}
					<span class="bullet">?</span>
					<a href="{{file.permalink}}" {{#isClient}}target="{{file.permalink}}"{{/isClient}} data-file-id="{{file.id}}" class="file_preview_link file_comment_link">
						{{#if file.comments_count}}{{pluralCount file.comments_count 'comment' 'comments'}}{{else}}Add comment{{/if}}
					</a>
				{{/unless}}
				
				{{#fileIsImage id=file.id}}
					<span class="bullet">?</span>
					<a href="{{file.url_private}}" target="{{file.url_private}}" data-file-id="{{file.id}}">Open original</a>
				{{/fileIsImage}}

			</div>
			
			{{#unless standalone}}
				{{#if show_initial_comment}}
				{{#if file.initial_comment}}
					<div class="initial_comment no_bottom_margin">{{{formatMessage file.initial_comment.comment}}}</div>
				{{/if}}
				{{/if}}

				{{#if file.thumb_360_gif}}
					{{{inlineImgDiv file.thumb_360_gif msg_dom_id}}}
				{{else}}
					{{{inlineImgDiv file.thumb_360 msg_dom_id}}}
				{{/if}}
			{{/unless}}
			
		{{/isTheme}}
		
		{{#isTheme theme='light'}}
			<a href="/team/{{member.name}}" {{#isClient}}target="/team/{{member.name}}"{{/isClient}} class="member {{getMemberColorClassById member.id}} message_sender" data-member-id="{{member.id}}">{{getMemberDisplayName member}}</a>
			
			{{#if permalink}}
				<i class="copy_only"><br>[</i><a href="{{permalink}}" target="{{newWindowName}}" title="{{{msgTsTitle msg}}}" class="timestamp">{{toTime msg.ts}}</a><i class="copy_only">]</i>
			{{else}}
				<i class="copy_only"><br>[</i><span title="{{{msgTsTitle msg}}}" class="timestamp">{{toTime msg.ts}}</span><i class="copy_only">]</i>
			{{/if}}
			
			<span class="message_star_holder">{{{star 'file' file null}}}</span><br />	
			
			{{#if jump_link}}{{{jump_link}}}{{/if}}

			<a href="{{file.permalink}}" {{#isClient}}target="{{file.permalink}}"{{/isClient}}data-file-id="{{file.id}}" class="file_preview_link file_name">
				{{#if file.title}}{{{formatFileTitle file}}}{{else}}{{file.name}}{{/if}}
			</a>
			{{#unless file.thumb_360}}
				<a href="{{file.url_private_download}}" target="{{newWindowName}}" data-toggle="tooltip" title="Download file"><i class="fa fa-cloud-download file_inline_icon"></i></a>
			{{/unless}}				
									
			{{#unless standalone}}
				{{#if file.thumb_360_gif}}
					{{{inlineImgToggler file.thumb_360_gif msg_dom_id}}}
				{{else}}
					{{{inlineImgToggler file.thumb_360 msg_dom_id}}}
				{{/if}}
			{{/unless}}

			<br />	
		
			{{#unless standalone}}
				{{#if file.thumb_360_gif}}
					{{{inlineImgDiv file.thumb_360_gif msg_dom_id}}}
				{{else}}
					{{{inlineImgDiv file.thumb_360 msg_dom_id}}}
				{{/if}}
			{{/unless}}
			
			<span class="meta">
				<i class="fa fa-arrow-circle-up"></i> 
				<a href="{{file.url_private_download}}" target="{{file.url_private_download}}" class="file_download_link" title="Download this file">{{convertFilesize file.size}} <span>{{file.pretty_type}}</span></a>
				{{#if file.is_shared}}
					in {{{makeFileGroupChannelList file}}}
				{{/if}}
				{{#unless standalone}}
					<span class="bullet">?</span>
					<a href="{{file.permalink}}" {{#isClient}}target="{{file.permalink}}"{{/isClient}} data-file-id="{{file.id}}" class="file_preview_link file_comment_link">
						{{#if file.comments_count}}{{pluralCount file.comments_count 'comment' 'comments'}}{{else}}Add comment{{/if}}
					</a>
				{{/unless}}
				{{#fileIsImage id=file.id}}
					<span class="bullet">?</span>
					<a href="{{file.url_private}}" target="{{file.url_private}}" data-file-id="{{file.id}}">Open original</a>
				{{/fileIsImage}}				
			</span>
		
			{{#unless standalone}}
				<br />
				{{#if show_initial_comment}}
				{{#if file.initial_comment}}
					<div class="initial_comment">
						<i class="icon_quote float-left fa fa-quote-left"></i>
						<div class="comment no_bottom_margin">
							{{{formatMessage file.initial_comment.comment}}}
						</div>
					</div>
				{{/if}}
				{{/if}}
			{{/unless}}

		{{/isTheme}}		
		
	</div>
</script>

<script id="message_file_snippet_create_template" type="text/x-handlebars-template">
	<div id="{{makeMsgDomId msg.ts}}" class="message file_reference file_upload {{#if first_in_block}}first{{/if}} {{#if unread}}unread{{/if}} {{#if highlight}}highlight{{/if}} {{#if show_divider}}divider{{/if}} show_user {{#showAvatars}}avatar{{/showAvatars}}" data-ts="{{msg.ts}}">

		{{#unless unprocessed}}
			{{#unless standalone}}
				{{#if show_actions_cog}}
					{{{msgActions msg}}}
				{{/if}}
			{{/unless}}
		{{/unless}}

		{{#showAvatars}}
			{{#if is_file_convo_continuation}}
			{{else}}
				{{{makeMemberPreviewLinkImage member.id 36}}}
			{{/if}}
		{{/showAvatars}}
		
		{{#isTheme theme='dense'}}
			<span class="message_star_holder">{{{star 'file' file null}}}</span>
		
			{{#if permalink}}
				<i class="copy_only"><br>[</i><a href="{{permalink}}" target="{{newWindowName}}" title="{{{msgTsTitle msg}}}" class="timestamp">{{toTime msg.ts}}</a><i class="copy_only">]</i>
			{{else}}
				<i class="copy_only"><br>[</i><span title="{{{msgTsTitle msg}}}" class="timestamp">{{toTime msg.ts}}</span><i class="copy_only">]</i>
			{{/if}}
			<div class="meta">
				<span class="float-left small_right_margin">
					{{{makeMemberPreviewLinkImage file.user 32}}}
				</span>
				<span class="float-left" style="width: 85%">				
					{{{makeMemberPreviewLinkById file.user false}}} created:<br />
					<a href="{{file.permalink}}" {{#isClient}}target="{{file.permalink}}"{{/isClient}} data-file-id="{{file.id}}" class="file_preview_link file_name bold">{{#if file.title}}{{{formatFileTitle file}}}{{else}}{{file.name}}{{/if}}</a>
					<a href="{{file.permalink}}" target="{{file.permalink}}" class="fa fa-external-link-square icon_new_window" title="Open file page"></a>
				</span>
				<div class="clear-both"></div>				
			</div>
		
			{{#unless standalone}}
				<div class="snippet_preview">
					{{{file.preview_highlight}}}
					{{#if_gt file.lines_more compare=0}}
						<a href="{{file.permalink}}" data-file-id="{{file.id}}" class="file_preview_link snippet_preview_more" {{#isClient}}target="{{file.permalink}}"{{/isClient}} data-file-id="{{file.id}}">+ {{file.lines_more}} more line{{#if_gt file.lines_more compare=1}}s{{/if_gt}}...</a>
					{{/if_gt}}
				</div>

				<div class="snippet_meta">
					<a href="{{file.url_private_download}}" target="{{file.url_private_download}}" title="Download this file">{{convertFilesize file.size}} <span>{{file.pretty_type}}</span></a>
					<span class="bullet">?</span> 
					{{#memberIsSelf id=member.id}} 
						{{#unless uploader}}
							<a href="{{file.edit_link}}" target="{{file.id}}" class="file_edit" onclick="TS.ui.snippet_dialog.startEdit('{{file.id}}'); return false">Edit</a> <span class="bullet">?</span>
						{{/unless}}
					{{/memberIsSelf}}
					<a href="{{file.permalink}}" target="{{file.id}}">New window</a>
					<span class="bullet">?</span> 
					<a href="{{file.url_private}}" target="{{file.id}}">View raw</a>
					<span class="bullet">?</span>
					<a href="{{file.permalink}}" {{#isClient}}target="{{file.permalink}}"{{/isClient}} data-file-id="{{file.id}}" class="file_preview_link file_comment_link">
						{{#if file.comments_count}}{{pluralCount file.comments_count 'comment' 'comments'}}{{else}}Add comment{{/if}}
					</a>
				</div>

				{{#if show_initial_comment}}
				{{#if file.initial_comment}}
					<p class="small_top_margin no_bottom_margin">{{{formatMessage file.initial_comment.comment}}}</p>
				{{/if}}
				{{/if}}
			{{/unless}}
		{{/isTheme}}

		{{#isTheme theme='light'}}
			<a href="/team/{{member.name}}" {{#isClient}}target="/team/{{member.name}}"{{/isClient}} class="member {{getMemberColorClassById member.id}} message_sender" data-member-id="{{member.id}}">{{getMemberDisplayName member}}</a>
			
			{{#if permalink}}
				<i class="copy_only"><br>[</i><a href="{{permalink}}" target="{{newWindowName}}" title="{{{msgTsTitle msg}}}" class="timestamp">{{toTime msg.ts}}</a><i class="copy_only">]</i>
			{{else}}
				<i class="copy_only"><br>[</i><span title="{{{msgTsTitle msg}}}" class="timestamp">{{toTime msg.ts}}</span><i class="copy_only">]</i>
			{{/if}}
			
			<span class="message_star_holder">{{{star 'file' file null}}}</span><br />	
			
			{{#if jump_link}}{{{jump_link}}}{{/if}}
			
			<span class="meta">
				<i class="fa fa-plus-circle"></i> Added {{#if show_initial_comment}}{{#if file.initial_comment}}and commented on{{/if}}{{/if}}
				<a href="{{file.permalink}}" {{#isClient}}target="{{file.permalink}}"{{/isClient}}data-file-id="{{file.id}}" class="file_preview_link file_name">{{#if file.title}}{{{formatFileTitle file}}}{{else}}{{file.name}}{{/if}}</a>
				{{#if file.is_shared}}
					in {{{makeFileGroupChannelList file}}}
				{{/if}}
			</span>
						
			{{#unless standalone}}
				<br />
				<div class="snippet_preview">
					{{{file.preview_highlight}}}
					{{#if_gt file.lines_more compare=0}}
						<a href="{{file.permalink}}" class="file_preview_link snippet_preview_more" {{#isClient}}target="{{file.permalink}}"{{/isClient}} data-file-id="{{file.id}}">+ {{file.lines_more}} more line{{#if_gt file.lines_more compare=1}}s{{/if_gt}}...</a>
					{{/if_gt}}
				</div>
			
				<span class="meta block snippet_meta">
					<a href="{{file.url_private_download}}" target="{{file.url_private_download}}" title="Download this file">{{convertFilesize file.size}} <span>{{file.pretty_type}}</span></a>
					<span class="bullet">?</span> 
					{{#memberIsSelf id=member.id}} 
						{{#unless uploader}}
							<a href="{{file.edit_link}}" target="{{file.id}}" class="file_edit" onclick="TS.ui.snippet_dialog.startEdit('{{file.id}}'); return false">Edit</a> <span class="bullet">?</span>
						{{/unless}}
					{{/memberIsSelf}}
					<a href="{{file.permalink}}" target="{{file.id}}">New window</a>
					<span class="bullet">?</span> 
					<a href="{{file.url_private}}" target="{{file.id}}">View raw</a>
					<span class="bullet">?</span>
					<a href="{{file.permalink}}" {{#isClient}}target="{{file.permalink}}"{{/isClient}} data-file-id="{{file.id}}" class="file_preview_link file_comment_link">
						{{#if file.comments_count}}{{pluralCount file.comments_count 'comment' 'comments'}}{{else}}Add comment{{/if}}
					</a>
				</span>

				{{#if show_initial_comment}}
				{{#if file.initial_comment}}
					<div class="initial_comment">
						<i class="icon_quote float-left fa fa-quote-left"></i>
						<div class="comment no_bottom_margin">
							{{{formatMessage file.initial_comment.comment}}}
						</div>
					</div>
				{{/if}}
				{{/if}}
			{{/unless}}

		{{/isTheme}}		

	</div>
</script>

<script id="message_template" type="text/x-handlebars-template">

	{{#if starred_items_list}}
		{{{star 'message' msg model_ob}}}
	{{/if}}

	<div id="{{makeMsgDomId msg.ts}}" class="{{#if msg.no_display}}hidden{{/if}} message {{makeMsgDomClass msg}} {{#if show_user}}show_user{{/if}} {{#if is_ephemeral}}ephemeral{{/if}} {{#showAvatars}}avatar{{/showAvatars}} {{#if first_in_block}}first{{/if}} {{#if unread}}unread{{/if}} {{#if unprocessed}}unprocessed{{/if}} {{#if highlight}}highlight{{/if}} {{#if show_divider}}divider{{/if}}" data-ts="{{msg.ts}}">
		{{#unless unprocessed}}
			{{#unless standalone}}

				{{#if show_actions_cog}}
					{{{msgActions msg}}}
				{{/if}}

				{{#unless starred_items_list}}							
					{{#if_equal theme compare='dense'}}
						{{#unless is_ephemeral}}
							<span class="message_star_holder">{{{star 'message' msg model_ob}}}</span>
						{{/unless}}
					{{/if_equal}}

					{{#if_equal theme compare='light'}}
						{{#unless show_user}}
							{{#unless is_ephemeral}}
								<span class="message_star_holder">{{{star 'message' msg model_ob}}}</span>
							{{/unless}}
						{{/unless}}
					{{/if_equal}}
				{{/unless}}

			{{/unless}}
		{{/unless}}
		
		{{#if_equal theme compare='light'}}
			{{#if show_user}}
				{{#if member}}
					{{{makeMemberPreviewLinkImage member.id 36}}}
				{{else}}
					{{{makeUsernameImage msg 36}}}
				{{/if}}
			{{/if}}
		{{/if_equal}}
		
	{{! DENSE ------------------------------------------------ }}
		{{#if_equal theme compare='dense'}}
			{{#if permalink}}
				<i class="copy_only"><br>[</i><a href="{{permalink}}" target="{{newWindowName}}" title="{{{msgTsTitle msg}}}" class="timestamp {{#if show_user}}{{else}}no_user{{/if}}">{{#if full_date}}{{toCalendarDateOrNamedDayShort msg.ts}} at {{/if}}{{toTime msg.ts}}</a><i class="copy_only">]</i>
			{{else}}
				<i class="copy_only"><br>[</i><span title="{{{msgTsTitle msg}}}" class="timestamp {{#if show_user}}{{else}}no_user{{/if}}">{{#if full_date}}{{toCalendarDateOrNamedDayShort msg.ts}} at {{/if}}{{toTime msg.ts}}</span><i class="copy_only">]</i>
			{{/if}}
		{{/if_equal}}
	{{! /DENSE ------------------------------------------------ }}
	
	{{! LIGHT ------------------------------------------------ }}
		{{#if_equal theme compare='light'}}
			<i class="copy_only"><br></i>
		{{/if_equal}}
	{{! /LIGHT ------------------------------------------------ }}
		
		
		{{! NOTE: the spaces at the start of the below elements are important for copied text formatting (and they should not affect html rendering)}}
		{{#unless show_user}}<i class="copy_only">{{/unless}}
		{{#if member}}
			<a href="/team/{{member.name}}" {{#isClient}}target="/team/{{member.name}}"{{/isClient}} class="message_sender member {{getMemberColorClassById member.id}}" data-member-id="{{member.id}}"> {{getMemberDisplayName member}}</a><i class="copy_only">{{#if_equal theme compare='dense'}}:{{/if_equal}}</i>
		{{else}}
			<span class="message_sender {{getBotColorClassByUserName msg.username}}"> {{#showAvatars}}{{{getBotNameWithLink msg}}}{{else}}{{{getBotNameAndIcon msg}}}{{/showAvatars}}</span><i class="copy_only">{{#if_equal theme compare='dense'}}:{{/if_equal}}</i>
		{{/if}}
		{{#unless show_user}}</i>{{/unless}}
		
		
	{{! LIGHT ------------------------------------------------ }}
		{{#if_equal theme compare='light'}}
			{{#if show_user}}
				{{#if permalink}}
					<i class="copy_only">[</i><a href="{{permalink}}" target="{{newWindowName}}" title="{{{msgTsTitle msg}}}" class="timestamp">{{#if full_date}}{{toCalendarDateOrNamedDayShort msg.ts}} at {{/if}}{{toTime msg.ts}}</a><i class="copy_only">]</i>
				{{else}}
					<i class="copy_only">[</i><span title="{{{msgTsTitle msg}}}" class="timestamp">{{#if full_date}}{{toCalendarDateOrNamedDayShort msg.ts}} at {{/if}}{{toTime msg.ts}}</span><i class="copy_only">]</i>
				{{/if}}

				{{#unless starred_items_list}}	
					{{#unless is_ephemeral}}
						<span class="message_star_holder">{{{star 'message' msg model_ob}}}</span>				
					{{/unless}}
				{{/unless}}

				{{#if is_ephemeral}}<span class="ephemeral_notice small_left_margin">Only you can see this message</span>{{/if}}
			{{else}}
				{{#if permalink}}
					<i class="copy_only">[{{#if full_date}}{{toCalendarDateOrNamedDayShort msg.ts}} at {{/if}}{{toTime msg.ts}}]</i><a href="{{permalink}}" target="{{newWindowName}}" title="{{{msgTsTitle msg}}}" class="timestamp">{{#if full_date}}{{toCalendarDateOrNamedDayShort msg.ts}} at {{/if}}{{toTime msg.ts false}}</a>
				{{else}}
					<i class="copy_only">[{{#if full_date}}{{toCalendarDateOrNamedDayShort msg.ts}} at {{/if}}{{toTime msg.ts}}]</i><span title="{{{msgTsTitle msg}}}" class="timestamp">{{#if full_date}}{{toCalendarDateOrNamedDayShort msg.ts}} at {{/if}}{{toTime msg.ts false}}</span>
				{{/if}}
			{{/if}}
			
			{{#if jump_link}}{{{jump_link}}}{{/if}}
		{{/if_equal}}
	{{! /LIGHT ------------------------------------------------ }}
	
		<span class="message_content"> 
			{{{formatMessageByType msg do_inline_imgs enable_slack_action_links}}}
			{{#unless no_attachments}}{{{formatAttachments msg enable_slack_action_links}}}{{/unless}}
			{{#if msg.edited}}
				<span class="edited" data-toggle="tooltip" title="{{toCalendarDateOrNamedDayShort msg.edited.ts}} at {{toTime msg.edited.ts true true}}">(edited)</span>
			{{/if}}			
		</span>
		
	{{! DENSE ------------------------------------------------ }}
		{{#if_equal theme compare='dense'}}
			{{#if show_user}}
				{{#if is_ephemeral}}<span class="ephemeral_notice">Only you can see this message</span>{{/if}}		
			{{/if}}
		{{/if_equal}}
	{{! /DENSE ------------------------------------------------ }}
		
		{{#if unprocessed}}
			<span class="temp_msg_controls {{#unless show_resend_controls}}hidden{{/unless}}">(this message send failed, would you like to <nobr><a class="resend_temp_msg">resend</a> ? <a class="remove_temp_msg">remove</a>?)</nobr></span>
		{{/if}}
	</div>
</script>

<script id="message_edit_form_template" type="text/x-handlebars-template">
	<div id="message_edit_container" class="message edit_mode {{#if first_in_block}}first{{/if}}">
		{{#isTheme theme="dense"}}
			<a href="{{permalink}}" target="{{newWindowName}}" title="{{{msgTsTitle msg}}}" class="timestamp">{{toTime msg.ts}}</a>
		{{/isTheme}}
		{{#isTheme theme="light"}}
			{{#if msg.user}}
				{{{makeMemberPreviewLinkImage msg.user 36}}}
			{{/if}}
		{{/isTheme}}
		<p id="message_editing_info" class="mini" style="display: none;">
			Finish editing this message first! Or press <strong>escape</strong> if you've changed your mind.
		</p>
		<form id="message_edit_form" data-msg-ts="{{msg.ts}}">
			{{#if include_emo}}<a class="emo_menu hidden"><img src="/img/emoji_menu_button.png" style="width: 16px; height: 16px;" /></a>{{/if}}
			<textarea id="msg_text" name="msg_text">{{unFormatMessage msg.text}}</textarea><br />
			<span class="mini">esc to <a id="cancel_edit">cancel</a></span>
			<span class="mini float-right" id="edit_controls"><span id="edit_countdown"></span> <span id="edit_saver">enter to <a id="commit_edit">save changes</a></span><span class="candy_red" id="edit_warning" class="hidden">text is too long!</span></span>
		</form>
	</div>
</script>

<script id="messages_unread_divider_template" type="text/x-handlebars-template">
	<div id="msgs_unread_divider" class="unread_divider">
		<hr />
		<span class="divider_label">NEW MESSAGES</span>
	</div>
</script>


<script id="search_tabs_template" type="text/x-handlebars-template">

	<div id="search_filters" class="{{searchFilter}}">
		<a id="filter_messages" onclick="TS.search.setFilter('messages'); return false;">Messages ({{messages_count}})</a>
		<a id="filter_files" onclick="TS.search.setFilter('files'); return false;">Files ({{files_count}})</a>
	</div>
		
</script>

<script id="search_files_heading_template" type="text/x-handlebars-template">
	<a id="search_file_list_clear_filter" class="menu_icon {{#if_equal filetype compare="all"}}hidden{{/if_equal}}"><i class="fa fa-times-circle"></i></a>
	<a id="search_file_list_heading">
		<span class="heading_label">{{filetype_label}}</span> <i class="fa fa-caret-down"></i>
	</a>
</script>

<script id="search_team_results_template" type="text/x-handlebars-template">
	<p class="team_results_heading">We found <strong>{{matches.length}} team {{pluralize matches.length "member" "members"}}</strong> matching your query:</p>
	<div id="team_results_container">
	{{#each matches}}
		<p class="team_result">
			{{{makeMemberPreviewLinkImage this.id 32}}}
			<a href="/team/{{this.name}}" {{#isClient}}target="/team/{{this.name}}"{{/isClient}} class="bold member_preview_link member_name" data-member-id="{{this.id}}">{{this.name}}</a> {{#memberIsSelf id=this.id}}(That's you!){{/memberIsSelf}}<br />
			{{#if this.profile.real_name}}<span class="member_real_name">{{this.profile.real_name}}</span> <span class="bullet">?</span>{{/if}}
			{{#memberIsSelf id=this.id}}
				<a href="/account/settings" {{#isClient}}target="{{newWindowName}}"{{/isClient}}>Your Account</a> <span class="bullet">?</span>
				<a href="/team/{{this.name}}" {{#isClient}}target="/team/{{this.name}}"{{/isClient}} class="member_preview_link" data-member-id="{{this.id}}">View Profile</a>
			{{else}}
				<a href="/messages/@{{this.name}}" {{#isClient}}target="/messages/@{{this.name}}"{{/isClient}} class="internal_im_link {{#isClient}}team_list_dm_link{{/isClient}}" data-member-name="{{this.name}}">Send direct message</a>
			{{/memberIsSelf}}
		</p>
	{{/each}}
	</div>
</script>

<script id="search_options_template" type="text/x-handlebars-template">

	{{#if_equal search_filter compare="files"}}
		<p id="search_member" style="padding-left: 0.75rem;">
			<span class="btn-group inline-block">
				<button id="search_file_list_toggle_all" class="file_list_toggle btn btn-mini btn-outline {{#if member_id_selected}}{{else}}active{{/if}}" onclick="TS.search.setMember('');">Everyone</button>
				<button id="search_file_list_toggle_user" class="file_list_toggle btn btn-mini btn-outline {{#if member_id_selected}}active{{/if}}" 
						onclick="TS.search.setMember('{{#if member_id_selected}}{{member_id_selected}}{{else}}{{currentUserId}}{{/if}}');">
					{{#if member_id_selected}}
						{{#if_equal member_id_selected compare=current_user_id}}
							Just You
						{{else}}
							{{member_selected.name}}
						{{/if_equal}}
					{{else}}
						Just You
					{{/if}}
				</button>
				{{#isClient}}
					<button id="search_file_list_toggle_users" class="file_list_toggle btn btn-mini btn-outline {{#if member_id_selected}}active{{/if}}"><i class="fa fa-caret-down" style="padding: 0 0.2rem 0;"></i></button>
				{{/isClient}}
			</span>
		</p>
	{{/if_equal}}

	<div id="advanced_options" {{#if advanced_options}}{{else}}style="display: none;"{{/if}}>

		{{#if_equal search_filter compare="messages"}}
			<p id="search_member">
				<span class="btn-group inline-block">
					<button id="search_file_list_toggle_all" class="file_list_toggle btn btn-mini btn-outline {{#if member_id_selected}}{{else}}active{{/if}}" onclick="TS.search.setMember('');">Everyone</button>
					<button id="search_file_list_toggle_user" class="file_list_toggle btn btn-mini btn-outline {{#if member_id_selected}}active{{/if}}" 
							onclick="TS.search.setMember('{{#if member_id_selected}}{{member_id_selected}}{{else}}{{currentUserId}}{{/if}}');">
						{{#if member_id_selected}}
							{{#if_equal member_id_selected compare=current_user_id}}
								Just You
							{{else}}
								{{member_selected.name}}
							{{/if_equal}}
						{{else}}
							Just You
						{{/if}}
					</button>
					{{#isClient}}
						<button id="search_file_list_toggle_users" class="file_list_toggle btn btn-mini btn-outline {{#if member_id_selected}}active{{/if}}"><i class="fa fa-caret-down" style="padding: 0 0.2rem 0;"></i></button>
					{{/isClient}}
				</span>
			</p>
		{{/if_equal}}

		<p id="search_sort">
			<span class="short-label">Sort</span>
			<span class="btn-group inline-block">
				<button onclick="TS.search.setSort('timestamp');" class="search_toggle btn btn-mini btn-outline {{#if_equal sort_filter compare="timestamp"}}active{{/if_equal}}" id="sort_timestamp_toggle">Most Recent</button>
				<button onclick="TS.search.setSort('score');" class="search_toggle btn btn-mini btn-outline {{#if_equal sort_filter compare="score"}}active{{/if_equal}}" id="sort_score_toggle">Most Relevant</button>
			</span>
		</p>

		<p id="search_channel">
			<span class="short-label">Channel</span>
			<select id="filter_channel" onchange="TS.search.setChannel($(this).val());">
				<option value="" selected="selected">All channels</option>
				<optgroup label="Your Open Channels">
				{{#each channels}}
					<option value="{{this.id}}" {{#if_equal this.id compare=../channel_id_selected}}selected="selected"{{/if_equal}}>{{this.name}}</option>
				{{/each}}
				</optgroup>
				<optgroup label="All Other Channels">
				{{#each other_channels}}
					<option value="{{this.id}}" {{#if_equal this.id compare=../channel_id_selected}}selected="selected"{{/if_equal}}>{{this.name}}</option>
				{{/each}}
				</optgroup>
				<optgroup label="Archived Channels">
				{{#each archived_channels}}
					<option value="{{this.id}}" {{#if_equal this.id compare=../channel_id_selected}}selected="selected"{{/if_equal}}>{{this.name}}</option>
				{{/each}}
				</optgroup>
			</select>
		</p>

		<p id="search_group">
			<span class="short-label">Group</span>
			<select id="filter_group" onchange="TS.search.setGroup($(this).val());">
				<option value="" selected="selected">All your groups</option>
				<optgroup label="Your Open Groups">
				{{#each groups}}
					<option value="{{this.id}}" {{#if_equal this.id compare=../group_id_selected}}selected="selected"{{/if_equal}}>{{this.name}}</option>
				{{/each}}
				</optgroup>
				<optgroup label="Your Other Groups">
				{{#each other_groups}}
					<option value="{{this.id}}" {{#if_equal this.id compare=../group_id_selected}}selected="selected"{{/if_equal}}>{{this.name}}</option>
				{{/each}}
				</optgroup>
				<optgroup label="Archived Groups">
				{{#each archived_groups}}
					<option value="{{this.id}}" {{#if_equal this.id compare=../group_id_selected}}selected="selected"{{/if_equal}}>{{this.name}}</option>
				{{/each}}
				</optgroup>
			</select>
		</p>
	
		<p id="search_only_my_channels">
			<span class="short-label">Limit</span>
			<label class="checkbox no_margin indent">
				{{#if channel_id_selected}}
					<input id="search_only_my_channels_cb" disabled="disabled" type="checkbox" class="small_right_margin" /> <span class="cloud_silver">Search only my open channels and groups</span>
				{{else}}
					{{#if group_id_selected}}
						<input id="search_only_my_channels_cb" disabled="disabled" type="checkbox" class="small_right_margin" /> <span class="cloud_silver">Search only my open channels and groups</span>
					{{else}}
						<input id="search_only_my_channels_cb" {{#if search_only_my_channels}}checked="checked"{{/if}} type="checkbox" class="small_right_margin" /> Search only my open channels and groups
					{{/if}}
				{{/if}}
			</label>
		</p>

	</div>
	
	<a onclick="TS.search.view.toggleAdvancedOptions();" id="advanced_options_toggle">
		{{#if advanced_options}}
			 <i class="fa fa-minus"></i> Hide Options
		{{else}}
			 <i class="fa fa-plus"></i> {{#isWeb}}Advanced{{else}}More{{/isWeb}} Options
		{{/if}}
	</a>
	<div id="paging_in_options">
		{{{paging_html}}}
	</div>
		
</script>

<script id="search_results_none_template" type="text/x-handlebars-template">	
	<p class="no_results">
		No 
		{{#if_equal filter compare='files'}}
			{{#if_equal filetype compare="all"}}
				files
			{{else}}
				{{filetype_label}}
			{{/if_equal}}
		{{else}}
			{{filter}} 
		{{/if_equal}}
		found matching <strong>{{query_string}}</strong>.
	</p>

	{{#if error}}
		<p class="alert alert-info">
			<i class="fa fa-exclamation-triangle bold"></i> <strong>Our sincere apologies!</strong><br />
			{{#if_equal error compare="temporarily_disabled"}}
				Search has been temporarily disabled while we deal with some issues. You can check <a href="http://status.slack.com" class="bold underline" target="{{newWindowName}}">our status site</a> for updates if it does not become available shortly.
			{{else}}
				Search failed with an error. This incident has been logged and is being investigated. You can check <a href="http://status.slack.com" class="bold underline" target="{{newWindowName}}">our status site</a> for updates if this problem persists.
				(error: "{{error}}")
			{{/if_equal}}
		</p>	
	{{/if}}

</script>

<script id="search_message_results_template" type="text/x-handlebars-template">
	<div id="search_message_results">
		{{#if page}}
			{{#each page}}
				{{> search_message_results_item}}
			{{/each}}
			{{{paging_html}}}
		{{else}}
			<div class="loading_hash_animation"><img src="/img/loading_hash_animation.gif" alt="Loading" /><br />loading page {{current_page}}...</div>
		{{/if}}
	</div>
</script>

<script id="search_message_results_item_with_extracts_template" type="text/x-handlebars-template">
	<div class="search_message_result feature_search_extracts {{#if this.extracts_expanded}}extracts_expanded{{/if}} {{#ifExtracts this}}{{else}}extracts_expanded{{/ifExtracts}}" id="{{makeMSRDomId this}}" data-channel="{{this.channel.id}}" data-ts="{{this.ts}}">
		{{#if this.expands_cnt}}
			{{#if_gt this.expands_cnt compare=1}}
				<a class="search_collapse result_bar">collapse</a>
			{{else}}
				<a class="search_expand result_bar"></a>
			{{/if_gt}}
		{{else}}
			<a class="search_expand result_bar"></a>
		{{/if}}
		<div class="search_message_result_meta">
			<strong>
				{{#if_equal this.type compare='im'}}
					{{{makeIMLinkById this.channel.id}}}
				{{else}}
					{{#if_equal this.type compare='group'}}
						{{{makeGroupLink this.channel}}}
					{{else}}
						{{{makeChannelLink this.channel}}}
					{{/if_equal}}
				{{/if_equal}}
			</strong>
			<div class="date_links">
				{{#isClient}}
					{{#if_equal this.type compare='im'}}
						{{#if this.is_loaded}}
							<a href="{{this.permalink}}" target="{{newWindowName}}" class="search_jump">Jump</a> ? 
						{{/if}}
					{{else}}
						{{#if_equal this.type compare='group'}}
							{{#if this.is_loaded}}
								<a href="{{this.permalink}}" target="{{newWindowName}}" class="search_jump">Jump</a> ? 
							{{/if}}
						{{else}}
							{{#if this.channel.is_member}}
								{{#if this.is_loaded}}
									<a href="{{this.permalink}}" target="{{newWindowName}}" class="search_jump">Jump</a> ? 
								{{/if}}
							{{/if}}
						{{/if_equal}}
					{{/if_equal}}
				{{/isClient}}
				{{! class="search_jump_maybe" makes these date link cmd/ctrl clickable to do the deep history searching in client}}
				
				<a href="{{this.permalink}}" target="{{newWindowName}}" title="{{{msgTsTitle this}}}" class="search_jump_maybe">{{toCalendarDateOrNamedDayShort this.ts}}</a>
			</div>
		</div>
		<div class="search_message_result_text">
			<div class="search_messages_container">
				{{{buildMsgHTMLForSearch this}}}
			</div>

			{{#ifExtracts this}}
				<div class="search_extracts_container">
					<div class="search_extracts_overlay"></div>
					<div class="search_extracts_overlay_top_fader"></div>
					<div class="search_extracts_overlay_bottom_fader"></div>
					{{{formatSearchExtracts this}}}
				</div>
			{{/ifExtracts}}
		</div>
		{{#if this.expands_cnt}}
			{{#if_gt this.expands_cnt compare=1}}
				<a class="search_collapse result_bar">collapse{{#ifExtracts this}}<i class="fa fa-compress compress_conversation"></i>{{/ifExtracts}}</a>
			{{else}}
				<a class="search_expand result_bar">{{#ifExtracts this}}<i class="fa fa-compress compress_conversation"></i>{{/ifExtracts}}</a>
			{{/if_gt}}
		{{else}}
			<a class="search_expand result_bar">{{#ifExtracts this}}<i class="fa fa-compress compress_conversation"></i>{{/ifExtracts}}</a>
		{{/if}}
	</div>
</script>

<script id="search_message_results_item_template" type="text/x-handlebars-template">
	<div class="search_message_result" id="{{makeMSRDomId this}}" data-channel="{{this.channel.id}}" data-ts="{{this.ts}}">
		{{#if this.expands_cnt}}
			{{#if_gt this.expands_cnt compare=1}}
				<a class="search_collapse result_bar">collapse</a>
			{{else}}
				<a class="search_expand result_bar"></a>
			{{/if_gt}}
		{{else}}
			<a class="search_expand result_bar"></a>
		{{/if}}
		<div class="search_message_result_meta">
			<strong>
				{{#if_equal this.type compare='im'}}
					{{{makeIMLinkById this.channel.id}}}
				{{else}}
					{{#if_equal this.type compare='group'}}
						{{{makeGroupLink this.channel}}}
					{{else}}
						{{{makeChannelLink this.channel}}}
					{{/if_equal}}
				{{/if_equal}}
			</strong>
			<div class="date_links">
				{{#isClient}}
					{{#if_equal this.type compare='im'}}
						{{#if this.is_loaded}}
							<a href="{{this.permalink}}" target="{{newWindowName}}" class="search_jump">Jump</a> ? 
						{{/if}}
					{{else}}
						{{#if_equal this.type compare='group'}}
							{{#if this.is_loaded}}
								<a href="{{this.permalink}}" target="{{newWindowName}}" class="search_jump">Jump</a> ? 
							{{/if}}
						{{else}}
							{{#if this.channel.is_member}}
								{{#if this.is_loaded}}
									<a href="{{this.permalink}}" target="{{newWindowName}}" class="search_jump">Jump</a> ? 
								{{/if}}
							{{/if}}
						{{/if_equal}}
					{{/if_equal}}
				{{/isClient}}
				{{! class="search_jump_maybe" makes these date link cmd/ctrl clickable to do the deep history searching in client}}
				
				<a href="{{this.permalink}}" target="{{newWindowName}}" title="{{{msgTsTitle this}}}" class="search_jump_maybe">{{toCalendarDateOrNamedDayShort this.ts}}</a>
			</div>
		</div>
		<div class="search_message_result_text">
			<div class="search_message_result_previous_holder">
			{{#each this.previous_expands}}
				<div class="search_message_result_previous result_msg_format">
					{{#if this.user}}
						<span class="message_user">{{getMemberDisplayNameById this.user}}</span>
					{{else}}
						<span class="message_user">{{getBotName this}}</span>
					{{/if}}
					{{#feature flag="feature_search_attachments"}}{{{formatMessageByType this true}}}{{else}}{{{formatMessageByType this}}}{{/feature}}
				</div>
				{{{formatAttachments this}}}
			{{/each}}
			</div>
			{{#if this.previous_2}}
			<div class="search_message_result_previous result_msg_format">
				{{#if this.previous_2.user}}
					<span class="message_user">{{getMemberDisplayNameById this.previous_2.user}}</span>
				{{else}}
					<span class="message_user">{{getBotName this.previous_2}}</span>
				{{/if}}
				{{#feature flag="feature_search_attachments"}}{{{formatMessageByType this.previous_2 true}}}{{else}}{{{formatMessageByType this.previous_2}}}{{/feature}}
			</div>
			{{{formatAttachments this.previous_2}}}
			{{/if}}
			{{#if this.previous}}
			<div class="search_message_result_previous result_msg_format">
				{{#if this.previous.user}}
					<span class="message_user">{{getMemberDisplayNameById this.previous.user}}</span>
				{{else}}
					<span class="message_user">{{getBotName this.previous}}</span>
				{{/if}}
				{{#feature flag="feature_search_attachments"}}{{{formatMessageByType this.previous true}}}{{else}}{{{formatMessageByType this.previous}}}{{/feature}}
			</div>
			{{{formatAttachments this.previous}}}
			{{/if}}
			{{!----------------------------------------------------------------------------------------------------------------}}
			<div class="search_message_result_hit result_msg_format">
				{{#if this.user}}
					<span class="message_user">{{getMemberDisplayNameById this.user}}</span>				
				{{else}}
					<span class="message_user">{{getBotName this}}</span>
				{{/if}}
				{{#feature flag="feature_search_attachments"}}{{{formatMessageByType this true}}}{{else}}{{{formatMessageByType this}}}{{/feature}}
			</div>
			{{{formatAttachments this}}}
			{{!----------------------------------------------------------------------------------------------------------------}}
			{{#if this.next}}
			<div class="search_message_result_next result_msg_format">
				{{#if this.next.user}}
					<span class="message_user">{{getMemberDisplayNameById this.next.user}}</span>
				{{else}}
					<span class="message_user">{{getBotName this.next}}</span>
				{{/if}}
				{{#feature flag="feature_search_attachments"}}{{{formatMessageByType this.next true}}}{{else}}{{{formatMessageByType this.next}}}{{/feature}}
			</div>
			{{{formatAttachments this.next}}}
			{{/if}}
			{{#if this.next_2}}
			<div class="search_message_result_next result_msg_format">
				{{#if this.next_2.user}}
					<span class="message_user">{{getMemberDisplayNameById this.next_2.user}}</span>
				{{else}}
					<span class="message_user">{{getBotName this.next_2}}</span>
				{{/if}}
				{{#feature flag="feature_search_attachments"}}{{{formatMessageByType this.next_2 true}}}{{else}}{{{formatMessageByType this.next_2}}}{{/feature}}
			</div>
			{{{formatAttachments this.next_2}}}
			{{/if}}
			<div class="search_message_result_next_holder">
			{{#each this.next_expands}}
				<div class="search_message_result_next result_msg_format">
					{{#if this.user}}
						<span class="message_user">{{getMemberDisplayNameById this.user}}</span>
					{{else}}
						<span class="message_user">{{getBotName this}}</span>
					{{/if}}
					{{#feature flag="feature_search_attachments"}}{{{formatMessageByType this true}}}{{else}}{{{formatMessageByType this}}}{{/feature}}
				</div>
				{{{formatAttachments this}}}
			{{/each}}
			</div>
		</div>
		{{#if this.expands_cnt}}
			{{#if_gt this.expands_cnt compare=1}}
				<a class="search_collapse result_bar">collapse</a>
			{{else}}
				<a class="search_expand result_bar"></a>
			{{/if_gt}}
		{{else}}
			<a class="search_expand result_bar"></a>
		{{/if}}
	</div>
</script>

<script id="search_widget_template" type="text/x-handlebars-template">
	<div id="search_results_scroller">

		{{#if_gt suggestions.length compare=0}}
			<div id="search_suggestions" class="results_block">
				{{#foreach suggestions}}
					<div class="search_widget_item suggestion" data-index={{this.index}}>
						<i class="fa fa-search"></i>
						{{{this.value.highlighted}}}
					</div>
				{{/foreach}}
			</div>
		{{/if_gt}}

		{{#isWeb}}
		
			<div id="search_results_messages" class="results_block">
				{{#if_gt messages.total compare=0}}
					<a href="/search/messages?q={{query}}" class="results_heading" data-filter="messages">
						<strong>Messages:</strong> {{messages.total}} result{{#if_equal messages.total compare=1}}{{else}}s{{/if_equal}}
						<span class="results_heading_link">View Details &nbsp;&#9656;</span>
					</a>
				{{else}}
					<p class="results_heading">
						<strong>Messages:</strong> No results
					</p>
				{{/if_gt}}
				{{#each messages.matches}}
					{{> search_widget_message_result}}
				{{/each}}
			</div>

			<div id="search_results_files" class="results_block">
				{{#if_gt files.total compare=0}}
					<a href="/search/files?q={{query}}" class="results_heading" data-filter="files">
						<strong>Files:</strong> {{files.total}} result{{#if_equal files.total compare=1}}{{else}}s{{/if_equal}}
						<span class="results_heading_link">View Details &nbsp;&#9656;</span>
					</a>
				{{else}}
					<p class="results_heading">
						<strong>Files:</strong> No results
					</p>
				{{/if_gt}}
				{{#each files.matches}}
					{{> search_widget_file_result}}
				{{/each}}
			</div>
		
		{{/isWeb}}
		
	</div>
</script>

<script id="search_widget_message_result_template" type="text/x-handlebars-template">
	<div onclick="window.location='{{this.permalink}}';" class="search_widget_item message_result">
		<div class="result_meta overflow-ellipsis">
			{{#if_equal this.type compare="im"}}
				@{{{getIMNameById this.channel.id}}}
			{{else}}
				{{{makeChannelLinkById this.channel.id}}}
			{{/if_equal}} ?
			{{toCalendarDateOrNamedDayShort this.ts}} at {{toTime this.ts}}
		</div>
		<div class="message_text overflow-ellipsis">
			<strong class="{{getMemberColorClassById this.user}}">{{{makeMemberPreviewLinkById this.user}}}</strong> &nbsp; {{{formatMessageResult this.text}}}
		</div>
	</div>
</script>

<script id="search_widget_file_result_template" type="text/x-handlebars-template">
	<div onclick="window.location='{{this.permalink}}';" class="search_widget_item file_result" data-file-id="{{this.id}}">
		<div class="result_meta overflow-ellipsis">
			{{#each this.channels}}
				{{{makeChannelLinkById this}}} ?
			{{/each}}
			{{#each this.groups}}
				{{{makeGroupLinkById this}}} ?
			{{/each}}
			{{toCalendarDateOrNamedDayShort this.ts}} at {{toTime this.ts}} ?
			{{convertFilesize this.size}} <span>{{this.pretty_type}}</span>
		</div>
		<a href="{{this.permalink}}" data-file-id="{{this.id}}" class="file_preview_link bold overflow-ellipsis">{{{highlightSearchMatchesInFileTitle this.title}}}</a> 
	</div>
</script>

<script id="search_attachment_extracts_template" type="text/x-handlebars-template">
	<div class="search_extracts" data-msg-id="{{makeMsgDomId message.ts}}">
		{{{concatAttachmentExtracts attachment message}}}

		<div class="search_extract_footer">
			<i class="fa fa-globe important subtle_silver service_icon"></i>

			{{#if attachment.service_name}}
				<span class="extract_username important">{{attachment.service_name}}</span>
			{{/if}}
	
			{{#if attachment.from_url}}
				<span class="subtle_silver from_url overflow-ellipsis">{{attachment.from_url}}</span>
			{{/if}}

			<span class="mini subtle_silver important">{{toTime message.ts true}}</span>
		</div>

		{{#if attachment.title}}
			<div class="search_extract_footer">
				{{#if attachment.title_link}}
					<span class="bold"><a {{{makeRefererSafeLink url=attachment.title_link}}} target="{{attachment.title_link}}">{{{formatMessageAttachmentPart attachment.title message true false}}}</a></span>
				{{else}}
					<span class="bold">{{{formatMessageAttachmentPart attachment.title message true false}}}</span>
				{{/if}}
			</div>
		{{/if}}
	</div>
</script>

<script id="search_message_extracts_template" type="text/x-handlebars-template">
	<div class="search_extracts" data-msg-id="{{makeMsgDomId message.ts}}">
		{{{concatMsgExtracts message}}}

		<div class="search_extract_footer">
			{{#if member}}
				{{{makeMemberPreviewLinkImage member.id 24}}}
				<span class="extract_username">{{getMemberDisplayName member}}</span>
			{{else}}
				{{#if bot}}
					<img class="extract_image" src="{{bot.icons.image_48}}">
				{{/if}}
				<span class="extract_username">{{message.username}}</span>
			{{/if}}
			<span class="mini subtle_silver">{{toTime message.ts true}}</span>
			<i class="fa fa-expand expand_extract"></i>
		</div>
	</div>
</script>


<script id="team_list_item_template" type="text/x-handlebars-template">
	<div class="team_list_item member_item active {{#if this.deleted}}inactive{{/if}}" data-member-id="{{this.id}}">
		
		<div class="member_details">
			{{{makeMemberPreviewLinkImage this.id 72 true}}}
			<span class="{{getMemberColorClassById this.id}}">
				<a href="/team/{{this.name}}" {{#isClient}}target="/team/{{this.name}}"{{/isClient}} class="bold member_preview_link member_name" data-member-id="{{this.id}}">{{this.name}}</a>
			</span>
			{{#unless this.deleted}}
				{{{makeMemberPresenceIcon this}}}
			{{/unless}}
			{{#if this.profile}} 
				{{#if this.profile.real_name}}
					{{#if this.deleted}}<span class="bullet">?</span> {{/if}}
					<span class="member_real_name bold">{{this.profile.real_name}}</span>					
				{{/if}}	
				{{#if this.profile.title}}<br /> {{this.profile.title}}{{/if}}	
				
				<p class="member_meta">		
				{{#isMobileWeb}}
					{{#memberHasIm member=this}}
						<a href="/archives/{{this.name}}" class="" data-member-name="{{this.name}}">Direct Message Archives</a>
						{{#unless this.deleted}}{{#unless this.is_slackbot}}<span class="bullet">?</span>{{/unless}}{{/unless}}
					{{/memberHasIm}}
				{{else}}
					{{#if this.deleted}}
						{{#memberHasIm member=this}}
							<a href="/archives/{{this.name}}" {{#isClient}}target="archives/{{this.name}}" {{/isClient}} class="" data-member-name="{{this.name}}">Direct Message Archives</a> <span class="bullet">?</span>
						{{/memberHasIm}}
					{{else}}
						{{#unless this.is_self}}
						{{#memberHasIm member=this}}
							{{#isClient}}
								<a href="/messages/@{{this.name}}" target="/messages/@{{this.name}}" class="internal_im_link team_list_dm_link" data-member-name="{{this.name}}">Direct Messages</a>
							{{else}}
								<a href="/archives/{{this.name}}" class="" data-member-name="{{this.name}}">Direct Message Archives</a> 
							{{/isClient}}
							{{#unless this.deleted}}{{#unless this.is_slackbot}}<span class="bullet">?</span>{{/unless}}{{/unless}}
						{{/memberHasIm}}
						{{/unless}}
					{{/if}}
				{{/isMobileWeb}}
				{{#unless this.is_slackbot}}
					{{#if this.profile.email}} <a href="mailto:{{this.profile.email}}" title="Email {{this.name}}">{{this.profile.email}}</a><br />{{/if}} 
					{{#if this.profile.skype}}<a {{#isClient}}target="_blank}"{{/isClient}} href="skype:{{this.profile.skype}}?call" title="Skype {{this.name}}" class="no_wrap"><i class="fa fa-skype"></i> {{this.profile.skype}}</a>{{/if}}					
					{{#unless this.deleted}}
						{{#if this.profile.skype}}<span class="bullet">?</span> {{/if}}
						<span class="subtle_silver timezone_label" data-member-id="{{this.id}}">{{{timezoneLabel this true}}}</span>
					{{/unless}}
				{{/unless}}
				</p>			
			{{/if}}	

		</div>
		
	</div>
</script>


<script id="team_list_template" type="text/x-handlebars-template">
	<div id="team_list">
		<div class="tab-content large_bottom_margin">
			<div class="{{#isClient}}tab-pane{{else}}{{#feature flag="feature_new_team_sites"}}tab_pane{{else}}tab-pane{{/feature}}{{/isClient}} selected active" id="active_members" data-tab="active_members">
				{{#each members}}
					{{> team_list_item}}
				{{/each}}
				<p class='no_matches hidden subtle_silver {{#feature flag="feature_new_team_sites"}}{{else}}top_margin lato align-center{{/feature}}'>
					No team members found matching <span class="query bold"></span>.
				</p>				
			</div>
			{{#if show_restricted_members}}
				<div class="{{#isClient}}tab-pane{{else}}{{#feature flag="feature_new_team_sites"}}tab_pane{{else}}tab-pane{{/feature}}{{/isClient}}" id="restricted_members" data-tab="restricted_members">
					{{#if restricted_members}}
						<h5 class='restricted_header small_top_margin small_bottom_margin'><i class='presence large away ra small_right_margin'></i> Restricted Accounts</h5>
						{{#each restricted_members}}
							{{> team_list_item}}
						{{/each}}
					{{/if}}
					{{#if ultra_restricted_members}}
						<h5 class='restricted_header {{#if restricted_members}}large_top_margin{{else}}small_top_margin{{/if}} small_bottom_margin'><i class='presence large away ura small_right_margin'></i> Single-channel Guests</h5>
						{{#each ultra_restricted_members}}
							{{> team_list_item}}
						{{/each}}
					{{/if}}
					<p class='no_matches hidden subtle_silver {{#feature flag="feature_new_team_sites"}}{{else}}top_margin lato align-center{{/feature}}'>
						No restricted accounts found matching <span class="query bold"></span>.
					</p>
					{{#isWeb}}				
						<p class="help">
							These team members are restricted to the channels or groups that they are invited to join.
							{{#currentUserIsAdmin}}
								<br />{{#isClient}}<br />{{/isClient}}
								<a href="/admin?tab=restricted" {{#isClient}}target="new"{{/isClient}} class="bold">Manage restricted accounts</a>
							{{/currentUserIsAdmin}}
						</p>
					{{/isWeb}}
				</div>
			{{/if}}
			{{#if deleted_members}}
				<div class="{{#isClient}}tab-pane{{else}}{{#feature flag="feature_new_team_sites"}}tab_pane{{else}}tab-pane{{/feature}}{{/isClient}}" id="deleted_members" data-tab="deleted_members">
					{{#each deleted_members}}
						{{> team_list_item}}
					{{/each}}
					<p class='no_matches hidden subtle_silver {{#feature flag="feature_new_team_sites"}}{{else}}top_margin lato align-center{{/feature}}'>
						No disabled accounts found matching <span class="query bold"></span>.
					</p>				
					<p class="help">
						These team members have been disabled and can no longer access your team.
						{{#currentUserIsAdmin}}
							<br />
							<a href="/admin" class="bold">Manage disabled accounts</a>
						{{/currentUserIsAdmin}}
					</p>
				</div>
			{{/if}}
		</div>
	</div>
</script>

<script id="team_tabs_template" type="text/x-handlebars-template">
	{{#feature flag="feature_new_team_sites"}}
		{{#isWeb}}
			<div class="tab_set on_neutral_grey">
				{{#if members}}
					<a data-tab="active_members" class="selected">Full Members <span class="normal">({{members.length}})</span></a>
				{{/if}}
				{{#if show_restricted_members}}
					<a data-tab="restricted_members">Restricted & Guest Accounts <span class="normal">({{restricted_members.length}})</span></a>
				{{/if}}
				{{#if deleted_members}}
					<a data-tab="deleted_members" class="secondary">Disabled Accounts <span class="normal">({{deleted_members.length}})</span></a>
				{{/if}}
				{{#if show_restricted_members}}
					<i class="tab_caret fa fa-caret-down"></i>
					<i class="tab_caret fa fa-caret-up"></i>
				{{else}}
					{{#if deleted_members}}
						<i class="tab_caret fa fa-caret-down"></i>
						<i class="tab_caret fa fa-caret-up"></i>
					{{/if}}
				{{/if}}
			</div>
		{{else}}
			<ul class="nav nav-tabs team_tabs tab_set on_neutral_grey lato no_bottom_margin">
				{{#if members}}
			  		<li id="active_members_tab" class="bold active"><a href="#active_members" data-toggle="tab" data-name="active_members">{{#isWeb}}Full {{/isWeb}}{{#isMobileWeb}}{{else}}Members {{/isMobileWeb}}<span class="normal">({{members.length}})</span></a></li>
				{{/if}}
				{{#if show_restricted_members}}
			  		<li id="restricted_members_tab" class="bold"><a href="#restricted_members" data-toggle="tab" data-name="restricted_members">Restricted{{#isWeb}}{{#isMobileWeb}}{{else}} & Guest Accounts{{/isMobileWeb}}{{/isWeb}} <span class="normal">({{restricted_members.length}})</span></a></li>
				{{/if}}
				{{#isWeb}}
					{{#if deleted_members}}
			  			<li id="deleted_members_tab" class="bold float-right"><a href="#deleted_members" data-toggle="tab" data-name="deleted_members">Disabled{{#isMobileWeb}}{{else}} Accounts{{/isMobileWeb}} <span class="normal">({{deleted_members.length}})</span></a></li>
					{{/if}}
				{{/isWeb}}
			</ul>
		{{/isWeb}}
	{{else}}
		<ul class="nav nav-tabs team_tabs tab_set on_neutral_grey lato no_bottom_margin">
			{{#if members}}
		  		<li id="active_members_tab" class="bold active"><a href="#active_members" data-toggle="tab" data-name="active_members">{{#isWeb}}Full {{/isWeb}}{{#isMobileWeb}}{{else}}Members {{/isMobileWeb}}<span class="normal">({{members.length}})</span></a></li>
			{{/if}}
			{{#if show_restricted_members}}
		  		<li id="restricted_members_tab" class="bold"><a href="#restricted_members" data-toggle="tab" data-name="restricted_members">Restricted{{#isWeb}}{{#isMobileWeb}}{{else}} & Guest Accounts{{/isMobileWeb}}{{/isWeb}} <span class="normal">({{restricted_members.length}})</span></a></li>
			{{/if}}
			{{#isWeb}}
				{{#if deleted_members}}
		  			<li id="deleted_members_tab" class="bold float-right"><a href="#deleted_members" data-toggle="tab" data-name="deleted_members">Disabled{{#isMobileWeb}}{{else}} Accounts{{/isMobileWeb}} <span class="normal">({{deleted_members.length}})</span></a></li>
				{{/if}}
			{{/isWeb}}
		</ul>
	{{/feature}}
</script>

<script id="team_member_edit_template" type="text/x-handlebars-template">

	<div class="member_details">
		
		{{{makeMemberPreviewLinkImage member.id 72}}}

		<h3 class="small_bottom_margin">
			<a href="/team/{{member.name}}" target={{newWindowName}} class="{{getMemberColorClassById member.id}}">{{member.name}}</a>
			{{{makeMemberPresenceIcon member}}}
		</h3>
	
		{{#if member.real_name}}<p>{{member.real_name}}</p>{{/if}}
		
		{{#feature flag="feature_status"}}
		<p class="{{makeMemberStatusDomClass member}} member_status">
			{{#if member.status}}{{member.status}}{{/if}}
			<!-- <a onclick="TS.ui.showStatusForm('user_status_panel');return false" class="mini">Update Status</a> -->
		</p>
		{{/feature}}
	
		<p class="member_meta">
			{{#if member.profile.title}}
				{{member.profile.title}}<br />
			{{/if}}
			<a href="/account/settings" target="{{newWindowName}}">View Account</a> ?
			<a href="/account/profile" target="{{newWindowName}}">Edit Profile</a>
		</p>
		
		<div class="clear-both"></div>
		
	</div>
	
	{{#isClient}}
	
		<div class="team_member_activity_list">
			<h3 class="small_bottom_margin">Recent Activity</h3>
			<div id="member_activity_list"></div>
		</div>
	
	{{/isClient}}
	
	{{#isWeb}}
	
		<div class="team_member_activity_list">
			<h3 class="small_bottom_margin">Recent Activity</h3>	
			{{#if member.activity}}
				<div id="member_activity_list"></div>
			{{else}}
				<p class="mini">You haven't any activity yet.</p>
			{{/if}}
		</div>
	
	{{/isWeb}}

</script>

<script id="team_member_preview_template" type="text/x-handlebars-template">

	{{#if member.deleted}}
		<p class="alert">This user account is inactive.</p>
	{{/if}}

	<div class="member_details">
		
		{{{makeMemberPreviewLinkImage member.id 72}}}

		<h3 class="small_bottom_margin">
			<a href="/team/{{member.name}}" target={{newWindowName}} class="{{getMemberColorClassById member.id}}">{{member.name}}</a>
			{{#unless member.deleted}}{{{makeMemberPresenceIcon member}}}{{/unless}}
			{{#if member.is_restricted}}
				<span class="mini subtle_silver normal">
					{{#if member.is_ultra_restricted}}
						(Single-channel Guest)
					{{else}}
						(Restricted Account)
					{{/if}}
				</span>
			{{/if}}
		</h3>
	
		<p class="small_bottom_margin">
			{{#if member.profile}}
				{{#if member.profile.real_name}}
					{{member.profile.real_name}}
				{{/if}}
			{{/if}}
			{{#if member.profile}}
				{{#if member.profile.title}}
					{{#if member.profile.real_name}}<br />{{/if}}
					<span class="mini no_bottom_margin">{{member.profile.title}}</p>
				{{/if}}
			{{/if}}
		</p>
		
		{{#unless member.is_slackbot}}	
			<p class="mini no_bottom_margin">
				{{{timezoneLabel member false}}}
			</p>
		{{/unless}}

		{{#if member.profile}}
		<ul class="member_meta action_list small_top_margin">
			{{#if member.deleted}}
				{{#if im}}
				<li><a target="{{newWindowName}}" href="/archives/{{im.id}}"><i class="fa fa-align-left"></i>Direct message archives</a></li>
				{{/if}}
			{{else}}
				<li><a href="/messages/@{{member.name}}" class="internal_im_link" data-member-name="{{member.name}}"><i class="fa fa-comment"></i>Direct messages</a></li>
				{{#if im}}
				<li><a target="{{newWindowName}}" href="/archives/{{im.id}}"><i class="fa fa-align-left"></i>Direct message archives</a></li>
				{{/if}}
				{{#if show_channel_invite}}
					<li><a onclick="TS.ui.invite.showInviteMemberToChannelDialog('{{member.id}}'); return false"><i class="fa fa-plus"></i>Invite to a channel...</a></li>
				{{/if}}
				{{#if show_group_invite}}
					<li><a onclick="TS.ui.invite.showInviteMemberToGroupDialog('{{member.id}}'); return false"><i class="fa fa-plus"></i>Invite to a private group...</a></li>
				{{/if}}
				{{#if show_group_create}}
					<li><a onclick="TS.ui.group_create_dialog.startWithMember('{{member.id}}');"><i class="fa fa-plus"></i>Create a new private group...</a></li>
				{{/if}}
			{{/if}}
			{{#if member.profile.email}}
				<li><a href="mailto:{{member.profile.email}}" title="Email {{getMemberDisplayName member}}"><i class="fa fa-envelope"></i>{{member.profile.email}}</a></li>
			{{/if}}
			{{#if member.profile.skype}}
				<li><a href="skype:{{member.profile.skype}}?call" target="{{newWindowName}}"><i class="fa fa-skype"></i>{{member.profile.skype}}</a></li>
			{{/if}}
			{{#if member.profile.phone}}
				<li><a target="{{newWindowName}}" href="tel:{{member.profile.phone}}"><i class="fa fa-phone"></i>{{member.profile.phone}}</a></li>
			{{/if}}
			<li><a target="{{newWindowName}}" href="/files/{{member.name}}" class="internal_file_list_filter" data-file-list-filter="{{member.id}}"><i class="fa fa-file"></i>{{getMemberDisplayName member}}'s files</a></li>
		</ul>	
		{{/if}}
		
		<div class="clear-both"></div>
		
	</div>
	
	<div class="team_member_activity_list">
		<h3 class="small_bottom_margin">Recent Activity</h3>	
		<div id="member_activity_list"></div>
	</div>

	{{#if member.is_slackbot}}
		<div class="help">
			<img src="/img/slackbot_48.png" alt="Slackbot" class="small_top_margin float-right left_margin" />
			<p>Slackbot is here to help you use Slack. Slackbot will message you periodically with help, daily summaries and a few other things. You can get information from Slackbot by typing <strong>/help</strong> in your <a href="/messages/@slackbot" class="internal_im_link" data-member-name="slackbot">Slackbot DM</a>.</p>
			<i class="fa fa-question-circle callout" style="margin-top: -0.25rem;"></i> 
			<p>If you have other questions about Slack, you might find the answer in our <a href="/help" target="{{newWindowName}}">Help Docs</a>. Or if you'd like, please <a href="/help/contact" target="{{newWindowName}}">get in touch</a>.</p>
		</div>

	{{/if}}

</script>

<script id="dm_badge_template" type="text/x-handlebars-template">
	<div class="dm_badge">
		{{{makeMemberPreviewLinkImage member.id 48}}}
		{{#if member.profile}}
			<p class="dm_badge_meta">
				{{#if member.profile.real_name}}
					<span class="member_real_name bold">{{member.profile.real_name}}</span><br />
				{{/if}}
				<span class="{{getMemberColorClassById member.id}}">
					<a href="/team/{{member.name}}" class="member_preview_link member_name" data-member-id="{{member.id}}">{{member.name}}</a>
				</span>
				{{{makeMemberPresenceIcon member}}}
				{{#if member.profile.title}}
					{{member.profile.title}}
				{{/if}}
			</p>			
		{{/if}}	
	</div>
		
	<p class="dm_explanation margin_auto align-left clear-both">This is <span class="not_limited_copy">the very beginning of</span> your direct message history with <strong>{{getMemberDisplayName member}}</strong>. Direct messages are private between the two of you. Sharing a private file here will not make it public, but it will allow <strong>{{getMemberDisplayName member}}</strong> to see it.
</script>


<script id="user_status_form_template" type="text/x-handlebars-template">
	<form id="user_status_form" class="no_bottom_margin inline-block" onsubmit="TS.ui.submitUserStatus('{{div_id}}');return false">
		<input type="text" id="user_status_input" value="{{user.status}}" />
		<input type="submit" class="btn btn-small btn-mini" id="user_status_submit" value="Update">
	</form>
</script>


<script id="menu_template" type="text/x-handlebars-template">
<div id="menu">
	<div id="menu_header"></div>
	<div id="menu_items_scroller">
		<ul id="menu_items"></ul>
	</div>
	<div id="menu_footer"></div>
</div>
</script>

<script id="emoji_menu_template" type="text/x-handlebars-template">
<div id="emoji_menu">
	<div id="emoji_menu_header"></div>
	<div id="emoji_menu_items_scroller">
		<div id="emoji_menu_items_div"></div>
	</div>
	<div id="emoji_menu_footer"></div>
</div>
</script>

<script id="emoji_header_template" type="text/x-handlebars-template">
	{{#each emoticon_groups}}
		<a class="emoji_grouping_tab {{#if_equal this.name compare=../active_group}}active{{/if_equal}}" data-group-name="{{this.name}}">{{{this.tab_html}}}</a>
	{{/each}}
</script>

<script id="menu_group_header_template" type="text/x-handlebars-template">
	<div class="menu_simple_header"><span class="overflow-ellipsis">{{{groupPrefix}}}{{group.name}}</span></div>
</script>

<script id="menu_group_items_template" type="text/x-handlebars-template">
	<li id="group_archives_item">		
		<a target="{{newWindowName}}" href="/archives/{{group.name}}">
			<i class="fa fa-align-left"></i> Open message archives
		</a>
	</li>

	<li id="group_prefs"><a><i class="fa fa-bell"></i> Group notification preferences...</a></li>
	
	{{#unless user.is_ultra_restricted}}
		{{#unless user.is_restricted}}
			<li id="group_add_service_item"><a href="/services/new?channel_id={{group.id}}" target="{{newWindowName}}"><i class="fa fa-wrench"></i> Add a service integration...</a></li>		
			<li id="group_invite_item" {{#if disable_invite}}class="disabled"{{/if}} ><a><i class="fa fa-sign-in"></i> Invite others to this group...</a></li>
		{{/unless}}
	{{/unless}}

	<li id="group_links_item">    
		<a target="{{newWindowName}}" href="/archives/{{group.name}}/links">Links from this group</a>
	</li>
	<li id="group_star_item" class="star_link star_group {{#if group.is_starred}}starred{{/if}}" data-group-id="{{group.id}}">
		<a>{{#if group.is_starred}}Unstar{{else}}Star{{/if}} this group</a>
	</li>
	
{{#unless user.is_ultra_restricted}}
	{{#if user.is_restricted}}

		{{#if group.is_archived}}
			{{#if ra_can_leave}}<li id="group_close_item"><a><i class="fa fa-sign-out"></i> Leave group</a></li>{{/if}}
		{{else}}
	
			<li id="group_invite_item" {{#if disable_invite}}class="disabled"{{/if}} ><a><i class="fa fa-sign-in"></i> Invite others to this group...</a></li>	
		
			{{#if_equal group.active_members.length compare=1}}
				{{#if ra_can_leave}}<li id="group_leave_and_archive_item"><a><i class="fa fa-archive"></i> Leave and Archive group</a></li>{{/if}}
			{{else}}
				{{#if ra_can_leave}}<li id="group_leave_item"><a><i class="fa fa-sign-out"></i> Leave group</a></li>{{/if}}
			{{/if_equal}}
		
		{{/if}}
	{{else}}
	
		{{#if group.is_archived}}
			<li id="group_unarchive_item"><a>Un-archive group</a></li>
			<li id="group_close_item"><a><i class="fa fa-sign-out"></i> Leave group</a></li>
		{{else}}

			{{#if show_purpose_item}}
				<li id="group_purpose_item"><a>Set group purpose...</a></li>
			{{/if}}

			<li id="group_advanced_item"><a>Advanced options...</a></li>
				
			{{#if_equal group.active_members.length compare=1}}
				<li id="group_leave_and_archive_item"><a><i class="fa fa-archive"></i> Leave and Archive group</a></li>
			{{else}}
				<li id="group_leave_item"><a><i class="fa fa-sign-out"></i> Leave group</a></li>
			{{/if_equal}}
		
		{{/if}}
	{{/if}}
{{/unless}}
</script>

<script id="menu_group_footer_template" type="text/x-handlebars-template">
	{{#unless user.is_restricted}}
	<div class="menu_footer menu_group_footer">
		<span class="menu_meta">Set group topic<span>
		<input type="text" id="menu_group_topic_input" data-behavior="placeholder" data-hint="Set the group topic" value="{{unFormatMessage group.topic.value}}" maxlength="{{ChannelTopicMaxLength}}"/>
	</div>
	{{/unless}}
</script>

<script id="menu_channel_header_template" type="text/x-handlebars-template">
	<div class="menu_simple_header"><span class="overflow-ellipsis">#{{channel.name}}</span></div>
</script>

<script id="menu_channel_items_template" type="text/x-handlebars-template">
	<li id="channel_archives_item">		
		<a target="{{newWindowName}}" href="/archives/{{channel.name}}">
			<i class="fa fa-align-left"></i> Open message archives
		</a>

	</li>

	<li id="channel_prefs"><a><i class="fa fa-bell"></i> Channel notification preferences...</a></li>
	
	{{#unless user.is_ultra_restricted}}
		{{#unless user.is_restricted}}
			<li id="channel_add_service_item"><a href="/services/new?channel_id={{channel.id}}" target="{{newWindowName}}"><i class="fa fa-wrench"></i> Add a service integration...</a></li>
			{{#unless hide_invite}}<li id="channel_invite_item" {{#if disable_invite}}class="disabled"{{/if}} ><a><i class="fa fa-sign-in"></i> Invite others to this channel...</a></li>{{/unless}}
		{{/unless}}
	{{/unless}}

	<li id="channel_links_item">    
		<a target="{{newWindowName}}" href="/archives/{{channel.name}}/links">
			Links from this channel
		</a>
	</li>
	<li id="channel_star_item" class="star_link star_channel {{#if channel.is_starred}}starred{{/if}}" data-channel-id="{{channel.id}}">
		<a>{{#if channel.is_starred}}Unstar{{else}}Star{{/if}} this channel</a>
	</li>
	
{{#unless user.is_ultra_restricted}}
	{{#if user.is_restricted}}

		{{#unless hide_invite}}<li id="channel_invite_item" {{#if disable_invite}}class="disabled"{{/if}} ><a>Invite others to this channel...</a></li>{{/unless}}

	{{else}}
	
		{{#if show_purpose_item}}
			<li id="channel_purpose_item"><a>Set the channel purpose...</a></li>
		{{/if}}
	
		{{#if channel.is_archived}}
			{{#if channel.was_archived_this_session}}
				{{#unless channel.is_general}}<li id="channel_close_archived_item"><a><i class="fa fa-sign-out"></i> Leave channel</a></li>{{/unless}}
			{{/if}}
			<li id="channel_unarchive_item"><a><i class="fa fa-archive"></i> Un-archive channel</a></li>
		{{else}}

			<li id="channel_advanced_item"><a>Advanced options...</a></li>			
				
			{{#if channel.is_member}}
				{{#unless channel.is_general}}<li id="channel_leave_item"><a><i class="fa fa-sign-out"></i> Leave channel</a></li>{{/unless}}
			{{else}}
				<li id="channel_join_item"><a><i class="fa fa-sign-in"></i> Open channel</a></li>
			{{/if}}
		{{/if}}

	{{/if}}
{{/unless}}
	
</script>

<script id="menu_channel_footer_template" type="text/x-handlebars-template">
	{{#if show_topic}}
	<div class="menu_footer menu_channel_footer">
		<span class="menu_meta">Set channel topic<span>
		<input type="text" id="menu_channel_topic_input" data-behavior="placeholder" data-hint="Set the channel topic" value="{{unFormatMessage channel.topic.value}}" maxlength="{{ChannelTopicMaxLength}}"/>
	</div>
	{{/if}}

</script>

<script id="menu_groups_header_template" type="text/x-handlebars-template">
	<div class="menu_simple_header"><h4 class="no_bottom_margin" style="font-size: 1rem;">Private Groups</h4></div>
</script>

<script id="menu_groups_items_template" type="text/x-handlebars-template">
	{{#each nondisplayed_groups}}
		<li data-group-id="{{this.id}}"><a href="/archives/{{this.name}}"><span style="color: #AAA;">{{{groupPrefix}}}</span>{{this.name}}
		({{#if_equal this.active_members.length compare=1}}1 member{{else}}{{this.active_members.length}} members{{/if_equal}})</a></li>
	{{/each}}
	{{#if nondisplayed_groups}}<li class="divider"></li>{{/if}}
{{#canUserCreateGroups}}
	<li id="new_group_item"><a><i class="fa fa-plus"></i> Create a new group...</a></li>
{{/canUserCreateGroups}}
	{{#if show_archived_item}}
		<li id="groups_archives_item"><a target="{{newWindowName}}" href="/groups"><i class="fa fa-archive"></i> View archived groups...</a></li>
	{{/if}}
	<li id="about_groups_item"><a target="{{newWindowName}}" href="/help/private-groups"><i class="fa fa-info-circle"></i> About private groups...</a></li>

</script>

<script id="menu_member_header_template" type="text/x-handlebars-template">
	<div class="menu_member_header">
		<div class="menu_member_user_details">
			{{{makeMemberPreviewLinkImage member.id 48}}}
			<span class="member_name">{{member.name}}</span>
			{{{makeMemberPresenceIcon member}}}
			{{#if member.is_restricted}}
				<span class="mini subtle_silver normal">
				{{#if member.is_ultra_restricted}}
					(Single-channel Guest)
				{{else}}
					(Restricted Account)
				{{/if}}
				</span>
			{{/if}}
			<br />			
			<span class="member_real_name">{{#if member.real_name}}{{member.real_name}}{{else}}&nbsp;{{/if}}</span>
			{{#unless member.is_slackbot}}
				{{#memberIsSelf id=member.id}}
				{{else}}
					<div class="member_tz no_wrap">{{{timezoneLabel member true}}}</div>
				{{/memberIsSelf}}
			{{/unless}}
		</div>
	</div>
</script>

<script id="menu_member_items_template" type="text/x-handlebars-template">
	{{#if member.is_self}}
		<li id="member_prefs_item"><a><i class="fa fa-wrench"></i> Preferences</a></li>
		<li id="member_account_item"><a href="/account/settings" target="{{newWindowName}}"><i class="fa fa-cog"></i> Account</a></li>
		<li id="member_profile_item"><a href="/team/{{member.name}}">Profile</a></li>
		{{#if member.has_files}}<li id="member_files_item"><a href="/files/{{member.name}}" target="{{newWindowName}}">Files</a></li>{{/if}}
		<li id="member_photo_item"><a href="/account/photo" target="{{newWindowName}}">Change your photo</a></li>
		<li id="member_presence">
			<a>
				<span class="menu_item_label">
					{{#if_equal member.presence compare="active"}}
						Set yourself away&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
					{{else}}
						[Away] Set yourself to active
					{{/if_equal}}
				</span>
			</a>
		</li>

		<li class="divider"></li>
		
		{{#if other_accounts}}
			{{#each other_accounts}}
				<li class="switch_team" data-team-id="{{this.team_id}}">
					{{#if @first}}<i class="fa fa-random"></i>{{/if}}
					<a href="{{this.team_url}}messages"><i class="fa fa-random"></i> Switch to {{this.name}} ({{this.team_name}})</a>
				</li>
			{{/each}}
		{{/if}}

		{{#if logout_url}}
			<li id="logout">
				<a href="{{logout_url}}"><i class="fa fa-sign-out"></i> Sign Out</a>
			</li>
		{{/if}}
		
	{{else}}
		{{#if im}}
			<li id="member_archives_item">		
				<a target="{{newWindowName}}" href="/archives/{{im.id}}">
					<i class="fa fa-align-left"></i> Open message archives
				</a>
			</li>
			<li id="member_links_item">    
				<a target="{{newWindowName}}" href="/archives/{{im.id}}/links">
					Links from this conversation
				</a>
			</li>
			<li id="member_star_item" class="star_link star_im {{#if im.is_starred}}starred{{/if}}" data-im-id="{{im.id}}">
				<a>{{#if im.is_starred}}Unstar{{else}}Star{{/if}} this conversation</a>
			</li>			
			<li class="divider"></li>
		{{/if}}
		<li id="member_profile_item"><a href="/team/{{member.name}}"><i class="fa fa-user"></i> View Profile</a></li>
		{{#if show_dm_item}}
			{{#unless member.deleted}}
				<li id="member_dm_item"><a href="/messages/@{{member.name}}"><i class="fa fa-comment"></i> Direct Messages</a></li>
			{{/unless}}
		{{/if}}
		{{#if member.profile.skype}}<li id="member_skype_item"><a href="skype:{{member.profile.skype}}?call" target="{{newWindowName}}"><i class="fa fa-skype"></i> Call on Skype ({{member.profile.skype}})</a></li>{{/if}}
		{{#if member.has_files}}<li id="member_files_item"><a href="/files/{{member.name}}" target="{{newWindowName}}"> View Files</a></li>{{/if}}
		{{#if channel_kick_name}}<li id="member_kick_channel_item"><a>Remove from <b>{{channel_kick_name}}</b></a></li>{{/if}}
		{{#if show_channel_invite}}<li id="member_invite_channel_item"><a>Invite to a channel...</a></li>{{/if}}
		{{#if show_group_invite}}<li id="member_invite_group_item"><a>Invite to a private group...</a></li>{{/if}}
		{{#if show_group_create}}<li id="member_create_group_item"><a>Create a new private group...</a></li>{{/if}}

		{{#if show_slackbot_responses_item}}
			<li id="member_slackbot_responses"><a href="/customize/slackbot" target="{{newWindowName}}">Create/edit Slackbot responses</a></li>
		{{/if}}
	{{/if}}
</script>

<script id="menu_member_footer_template" type="text/x-handlebars-template">
	<div class="menu_footer">
		{{#if member.deleted}}
			<p class="no_bottom_margin">This user account is inactive.</p>
		{{else}}
			<span class="menu_meta">Send a direct message<span>
			<textarea type="text" id="menu_member_dm_input" rows="1"></textarea>
		{{/if}}
	</div>
</script>

<script id="menu_team_items_template" type="text/x-handlebars-template">

	{{#if user.is_admin}}
		<li id="team_admin">
			<a href="/admin" target="{{newWindowName}}"><i class="fa fa-cogs"></i> Team Administration</a>
		</li>
	{{/if}}

	{{#unless user.is_restricted}}
		<li id="team_services"><a href="/services/new" target="{{newWindowName}}"><i class="fa fa-wrench"></i> Configure Integrations</a></li>
	{{/unless}}

	{{#if user.is_admin}}
		{{#if show_invite_item}}
			<li id="team_invitations">
				<a href="/admin/invites" target="{{newWindowName}}"><i class="fa fa-envelope-o"></i> Send Invitations</a>
			</li>
		{{/if}}
	{{/if}}
	
	<li id="team_apps"><a href="/apps" target="{{newWindowName}}"><i class="icon-laptop"></i> Get Slack Apps</a></li>

	{{#if help_url}}
		<li id="team_help"><a href="/help" target="{{newWindowName}}">Help &amp; Feedback</a></li>
	{{/if}}

	<li id="team_activity"><a href="/activity" target="{{newWindowName}}">Open Team Site</a></li>

	{{#if other_accounts}}
		<li class="divider"></li>
		{{#each other_accounts}}
			<li class="switch_team" data-team-id="{{this.team_id}}" data-user-id="{{this.id}}">
				<a href="{{this.team_url}}messages"> 
					<i class="fa fa-random"></i>
					Switch to <strong>{{this.team_name}}</strong>
				</a>
			</li>
		{{/each}}
	{{/if}}
	
	{{#if signin_url}}
		<li id="add_team"><a href="{{signin_url}}"> Sign in to another team...</a></li>
	{{/if}}

	{{#if logout_url}}
		<li class="divider"></li>
		<li id="logout"><a href="{{logout_url}}"><i class="fa fa-sign-out"></i> Sign Out</a></li>
	{{/if}}

</script>

<script id="menu_user_items_template" type="text/x-handlebars-template">

	<li id="member_prefs_item"><a><i class="fa fa-wrench"></i> Preferences</a></li>
	<li id="member_account_item"><a href="/account/settings" target="{{newWindowName}}"><i class="fa fa-cog"></i> Your Account</a></li>
	<li id="member_profile_item"><a href="/team/{{user.name}}">Your Profile</a></li>
	<li id="member_photo_item"><a href="/account/photo" target="{{newWindowName}}">Change your photo</a></li>
	<li id="member_presence">
		<a>
			<span class="menu_item_label">
				{{#if_equal user.presence compare="active"}}
					Set yourself away&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
				{{else}}
					[Away] Set yourself to active
				{{/if_equal}}
			</span>
		</a>
	</li>

	{{#if logout_url}}
		<li class="divider"></li>
		<li id="logout">
			<a href="{{logout_url}}"><i class="fa fa-sign-out"></i> Sign Out</a>
		</li>
	{{/if}}

</script>

<script id="menu_user_footer_template" type="text/x-handlebars-template">
	{{#feature flag="feature_status"}}
	<div class="menu_footer">
		Set your status:<br />
		<input type="text" id="menu_user_status_input" data-behavior="placeholder" data-hint="Set your status" value="{{user.status}}" />
	</div>
	{{/feature}}
</script>

<script id="menu_members_header_template" type="text/x-handlebars-template">
	<div class="menu_simple_header" style="width: 280px; padding: 0.6rem 0.5rem;">
		<a class="fa fa-times menu_close"></a>
		<h4 class="no_bottom_margin" style="margin-left: 0.25rem; font-size: 1rem;">Direct Message</h4>
	</div>
	{{#if show_filter}}
		<div id="dms_filter" class="position-relative" data-list-items-id="#menu">
			<i class="icon_search fa fa-search"></i>
			<a class="icon_close fa fa-times-circle hidden"></a>
			<input type="text" class="member_filter" name="team_filter" placeholder="Find by name" />
			<p id="dms_no_matches" class='no_matches hidden subtle_silver'>
				No team members found matching <span class="query bold"></span>.
			</p>	
		</div>
	{{/if}}
</script>

<script id="menu_members_items_template" type="text/x-handlebars-template">	
	{{#each members}}
		<li class="dm_list_item member_item active" data-member-id="{{this.id}}">
			<a href="/team/{{this.name}}">
				{{{makeMemberImage this.id 36 true}}}
				<span class="dm_list_username overflow-ellipsis">
					{{this.name}}
					{{{makeMemberPresenceIcon this}}}
				</span>
				{{#if this.profile}}
					{{#if this.profile.real_name}}
						<br />
						<span class="dm_list_real_name overflow-ellipsis">{{this.profile.real_name}}</span>
					{{/if}}
				{{/if}}
			</a>
		</li>
	{{/each}}
</script>

<script id="menu_members_footer_template" type="text/x-handlebars-template">
	<div class="menu_footer">
		<a id="about_dms_link" target="{{newWindowName}}" href="/help/direct-messages" class="align-right"><i class="fa fa-info-circle"></i> About direct messages...</a>
	</div>
</script>

<script id="menu_emoticons_template" type="text/x-handlebars-template">
	{{#each emoticon_groups}}
		<ul class="emoticon_group_ul {{#if_not_equal this.name compare=../active_group}}hidden{{/if_not_equal}}" id="emoticon_group_ul_{{this.name}}">
		{{#each this.items}}
			<li class="emoticon_item emoticon_item_emoji"><a data-name="{{this.name}}" data-names="{{this.names}}" data-icon="{{this.name}}">{{{this.emoji}}}</a></li>
		{{/each}}
		</ul>
	{{/each}}
</script>

<script id="menu_activity_toggle_items_template" type="text/x-handlebars-template">
	{{#if_equal active_list compare='stars'}}
		<li data-list="activity"><a><i class="fa fa-tachometer"></i> Activity</a></li>
	{{/if_equal}}
	{{#if_equal active_list compare='activity'}}
		<li data-list="stars"><a><i class="fa fa-star"></i> Starred Items</a></li>
	{{/if_equal}}
</script>

<script id="menu_file_filter_items_template" type="text/x-handlebars-template">
	<li data-filetype="all" {{#if_equal active_type compare='all'}}class="active"{{/if_equal}}>
		<a><i class="fa fa-file"></i> All File Types</a>
	</li>
	<li data-filetype="posts" {{#if_equal active_type compare='posts'}}class="active"{{/if_equal}}>
		<a><i class="fa fa-file-o"></i> Posts</a>
	</li>
	<li data-filetype="snippets" {{#if_equal active_type compare='snippets'}}class="active"{{/if_equal}}>		
		<a><i class="fa fa-code"></i> Snippets</a>
	</li>
	<li data-filetype="images" {{#if_equal active_type compare='images'}}class="active"{{/if_equal}}>		
		<a><i class="fa fa-picture-o"></i> Images</a>
	</li>
	<li data-filetype="pdfs" {{#if_equal active_type compare='pdfs'}}class="active"{{/if_equal}}>		
		<a><i class="fa fa-book"></i> PDF Files</a>
	</li>
	<li data-filetype="gdocs" {{#if_equal active_type compare='gdocs'}}class="active"{{/if_equal}}>		
		<a><i class="fa fa-google-plus"></i> Google Docs</a>
	</li>
</script>

<script id="menu_file_member_header_template" type="text/x-handlebars-template">
	<div id="file_member_filter" data-list-items-id="#menu">
		<i class="icon_search fa fa-search"></i>		
		<a class="fa fa-times-circle icon_close hidden"></a>
		<input type="text" class="member_filter no_margin" placeholder="Find by name" />
		<p id="file_member_filter_no_matches" class='no_matches hidden subtle_silver'>
			No team members found matching <span class="query bold"></span>.
		</p>
	</div>	
</script>

<script id="menu_file_member_filter_items_template" type="text/x-handlebars-template">
	{{#each members}}
		{{#unless this.deleted}}
			<li class="member_item active" data-member-id="{{this.id}}">
				<a><span class="small_right_margin">{{{makeMemberImage this.id 24 true}}}</span>{{getMemberDisplayName this}}</a>
			</li>
		{{/unless}}
	{{/each}}
</script>

<script id="menu_message_action_items_template" type="text/x-handlebars-template">
	
	{{#if actions.edit_msg}}
		<li id="edit_link" data-msg-ts="{{msg.ts}}"><a><i class="fa fa-pencil"></i> Edit</a></li>
	{{/if}}

	{{#if actions.delete_msg}}
		<li id="delete_link" data-msg-ts="{{msg.ts}}"><a><i class="fa fa-times"></i> Delete</a></li>
	{{/if}}

</script>

<script id="menu_comment_action_items_template" type="text/x-handlebars-template">
	{{#if can_edit}}
		<li id="edit_file_comment" data-file-id="{{file.id}}" data-comment-id="{{comment.id}}"><a><i class="fa fa-pencil"></i> Edit</a></li>
	{{/if}}
	{{#if can_delete}}
		<li id="delete_file_comment" {{#feature flag="feature_new_team_sites"}}class="danger"{{/feature}} data-file-id="{{file.id}}" data-comment-id="{{comment.id}}"><a><i class="fa fa-times"></i> Delete</a></li>			
	{{/if}}
</script>

<script id="menu_file_action_items_template" type="text/x-handlebars-template">
	
	{{#if actions.share}}
		<li id="share_file" data-file-id="{{file.id}}"><a><i class="fa fa-share"></i> Share</a></li>
	{{/if}}
	
	{{#if actions.comment}}
		<li id="comment_file" data-file-id="{{file.id}}"><a><i class="fa fa-comment-o"></i> Comment</a></li>
	{{/if}}

	{{#if actions.print}}
		<li id="print_file" data-file-id="{{file.id}}"><a><i class="fa fa-print"></i> Print</a></li>
	{{/if}}

	{{#if actions.open_original}}
		<li id="open_original_file" data-file-id="{{file.id}}">
			<a href="{{file.url_private}}" target="{{file.id}}">
				<i class="fa fa-external-link"></i> 
				{{#if_equal file.mode compare="snippet"}}View raw{{else}}Open original{{/if_equal}}
			</a>
		</li>
	{{/if}}

	{{#if actions.edit}}
		<li class="divider"></li>
		{{#if_equal file.mode compare="snippet"}}
			<li id="edit_file_snippet" data-file-id="{{file.id}}">
				{{#isClient}}
					<a><i class="fa fa-pencil"></i> Edit</a>					
				{{else}}
					<a href="{{file.permalink}}/edit"><i class="fa fa-pencil"></i> Edit</a>
				{{/isClient}}
			</li>
		{{/if_equal}}
		{{#if_equal file.mode compare="post"}}
			<li id="edit_file_post" data-file-id="{{file.id}}">
				<a href="{{file.permalink}}/edit" {{#isClient}}target="{{file.permalink}}/edit"{{/isClient}}><i class="fa fa-pencil"></i> Edit</a>
			</li>
		{{/if_equal}}
	{{/if}}

	{{#isClient}}
		{{#if actions.edit_title}}
			<li class="divider"></li>
			<li id="edit_file_title" data-file-id="{{file.id}}">			
				{{#isClient}}
					<a><i class="fa fa-pencil"></i> Edit title</a>
				{{else}}
					<a href="{{file.permalink}}/edit"><i class="fa fa-pencil"></i> Edit title</a>
				{{/isClient}}
			</li>
		{{/if}}
	{{/isClient}}
	
	{{#if actions.create_public_link}}
		<li class="divider"></li>
		<li id="create_public_link" data-file-id="{{file.id}}"><a><i class="fa fa-link"></i> Create public link</a></li>
	{{/if}}
	{{#if actions.revoke_public_link}}
		<li class="divider"></li>
		<li id="revoke_public_link" data-file-id="{{file.id}}"><a><i class="fa fa-link"></i> Revoke public link</a></li>
	{{/if}}

	{{#if actions.download}}
		<li id="download_file" data-file-id="{{file.id}}"><a href="{{file.url_private_download}}" {{#isClient}}target="{{file.id}}"{{/isClient}}><i class="fa fa-cloud-download"></i> Download</a></li>
	{{/if}}

	{{#if actions.save_to_dropbox}}
		<li id="save_to_dropbox" data-file-id="{{file.id}}"><a><i class="fa fa-dropbox"></i> Save to Dropbox</a></li>
	{{/if}}

	{{#if actions.refresh}}
		<li id="refresh_file" data-file-id="{{file.id}}"><a><i class="fa fa-refresh {{#if is_refreshing}}fa-spin{{/if}}"></i> <span class="item_label">{{#if is_refreshing}}Refreshing...{{else}}Refresh file{{/if}}</span></a></li>
	{{/if}}

	{{#if actions.delete_file}}
		<li class="double-divider"></li>
		<li id="delete_file" data-file-id="{{file.id}}" {{#feature flag="feature_new_team_sites"}}class="danger"{{/feature}}><a {{#feature flag="feature_new_team_sites"}}{{else}}class="delete_link"{{/feature}}><i class="fa fa-times"></i> Delete{{#if file.is_external}} from Slack{{/if}}</a></li>
	{{/if}}

</script>

<script id="menu_flexpane_header_template" type="text/x-handlebars-template">
	<div id="flex_menu_header" class="menu_simple_header">
		<div id="flex_menu_callout"></div>
	</div>
</script>

<script id="menu_flexpane_items_template" type="text/x-handlebars-template">
	<li id="list_stars" class="flexpane_menu_item" data-tab-id="stars"><a><i class="flex_nav_icon"></i> Starred Items</a></li>
	<li id="list_mentions" class="flexpane_menu_item" data-tab-id="mentions"><a><i class="flex_nav_icon"></i> Recent Mentions</a></li>
	<li id="list_files" class="flexpane_menu_item" data-tab-id="files"><a><i class="flex_nav_icon"></i> Files</a></li>
		<li id="files_user" class="flexpane_menu_item filetype" data-filetype="user"><a><i class="flex_nav_icon"></i> Your Files</a></li>
		<li id="files_all" class="flexpane_menu_item filetype" data-filetype="all"><a><i class="flex_nav_icon"></i> All Files</a></li>
		<li id="files_posts" class="flexpane_menu_item filetype" data-filetype="posts"><a><i class="flex_nav_icon"></i> Posts</a></li>
		<li id="files_snippets" class="flexpane_menu_item filetype" data-filetype="snippets"><a><i class="flex_nav_icon"></i> Snippets</a></li>
		<li id="files_images" class="flexpane_menu_item filetype" data-filetype="images"><a><i class="flex_nav_icon"></i> Images</a></li>
		<!--<li id="files_pdfs" class="flexpane_menu_item filetype" data-filetype="pdfs"><a><i class="flex_nav_icon"></i> PDF Files</a></li>-->
		<li id="files_gdocs" class="flexpane_menu_item filetype" data-filetype="gdocs"><a><i class="flex_nav_icon"></i> Google Docs</a></li>
	<li id="list_team" class="flexpane_menu_item" data-tab-id="team"><a><i class="flex_nav_icon"></i> Team Directory</a></li>
	<li id="list_activity" class="flexpane_menu_item" data-tab-id="activity"><a><i class="flex_nav_icon"></i> Activity Feed</a></li>	
	<!--<li id="help" class="flexpane_menu_item"><a href="/help" target="{{newWindowName}}"><i class="fa fa-question" style="padding: 0 22px 0 10px;"></i> Help & Feedback</a></li>-->
	{{#each special_flex_panes}}
	<li class="flexpane_menu_item" data-tab-id="{{this.flex_name}}"><a><i class="fa fa-exclamation-circle" style="padding: 0 22px 0 10px;"></i> {{this.label}}</a></li>
	{{/each}}
</script>

<script id="menu_flexpane_footer_template" type="text/x-handlebars-template">
	<div id="flex_menu_footer" class="menu_footer"></div>
</script>

<script id="menu_channel_picker_header_template" type="text/x-handlebars-template">
	<div class="menu_simple_header">
		<h4 class="no_bottom_margin">
			Select a {{#if channels}}channel {{#if groups}} or{{/if}}{{/if}} {{#if groups}}private group{{/if}}
		</h4>
	</div>
	<div id="channel_picker_filter" class="menu_filter_container">
		<i class="icon_search fa fa-search"></i>		
		<a class="fa fa-times-circle icon_close hidden"></a>
		<input type="text" class="menu_filter no_margin" placeholder="Find by name" />
		<p class="filter_no_matches no_matches hidden subtle_silver">
			Nothing found matching <span class="query bold"></span>.
		</p>
	</div>
</script>

<script id="menu_channel_picker_template" type="text/x-handlebars-template">

	{{#each channels}}
		<li data-user-id="{{../user_id}}" data-channel-id="{{this.id}}" class="no_indent"><a>#{{this.name}}</a></li>
	{{/each}}

	{{#each groups}}
		<li data-user-id="{{../user_id}}" data-group-id="{{this.id}}" class="no_indent"><a>{{this.name}}</a></li>
	{{/each}}

</script>


<script id="activity_messages_template" type="text/x-handlebars-template">

	<div id="{{makeActivityMessagesDomId date_str}}" class="activity_item activity_messages feed_type_{{feed_type}}">
		{{#if item.channels_total}}
			{{pluralCount item.channels_total 'message' 'messages'}} in {{pluralCount item.channels_with_messages 'channel' 'channels'}}{{! comment to make sure no space before a comma
			}}{{#if item.groups_total}}{{#if item.dms_total}}, {{else}} and {{/if}}{{else}}{{#if item.dms_total}} and {{/if}}{{/if}}
		{{/if}}
		{{#if item.groups_total}}
			{{pluralCount item.groups_total 'message' 'messages'}} in {{pluralCount item.groups.length 'group' 'groups'}}
			{{#if item.dms_total}} and {{/if}}
		{{/if}}
		{{#if item.dms_total}}
			{{pluralCount item.dms_total 'message' 'messages'}} with {{pluralCount item.dms.length 'person' 'people'}}
		{{/if}}
		
		<span class="activity_item_actions">
			<span class="bullet">?</span>
			<a class="show_link {{#if expanded}}hidden{{/if}}" onclick="TS.activity.view.expandActivityMessagesList('{{makeActivityMessagesDomId date_str}}')">view</a>
			<a class="hide_link {{#unless expanded}}hidden{{/unless}}" onclick="TS.activity.view.collapseActivityMessagesList('{{makeActivityMessagesDomId date_str}}')">hide</a>
		</span>

		<div class="activity_messages_list {{#unless expanded}}hidden{{/unless}}">
			{{#if item.channels}}
				<ul>
					{{#foreach item.channels}}
						{{#if this.value.is_member}}
							<li>
							{{#isClient}}
								<strong>{{{makeChannelLink this.value.channel}}}</strong> <span class="bullet">?</span> {{pluralCount this.value.count 'message' 'messages'}}
							{{/isClient}}
							{{#isWeb}}
								<a href="{{this.value.url}}" class="bold">#{{this.value.channel.name}}</a> <span class="bullet">?</span> {{pluralCount this.value.count 'message' 'messages'}}
							{{/isWeb}}
							</li>
						{{/if}}
					{{/foreach}}
				</ul>
			{{/if}}
		
			{{#if item.groups}}
				<ul>
					{{#foreach item.groups}}
						<li>
						{{#isClient}}
							<strong>{{{groupPrefix}}}{{{makeGroupLink this.value.group}}}</strong> <span class="bullet">?</span> {{pluralCount this.value.count 'message' 'messages'}}
						{{/isClient}}
						{{#isWeb}}
							<a href="{{this.value.url}}" class="bold">{{{groupPrefix}}}{{this.value.group.name}}</a> <span class="bullet">?</span> {{pluralCount this.value.count 'message' 'messages'}}
						{{/isWeb}}
						</li>
					{{/foreach}}
				</ul>
			{{/if}}
		
			{{#if item.dms}}
				<ul>
					{{#foreach item.dms}}
						<li>
						{{#isClient}}
							<strong>{{{makeIMLink this.value.im}}}</strong> <span class="bullet">?</span> {{pluralCount this.value.count 'message' 'messages'}}
						{{/isClient}}
						{{#isWeb}}
							<strong>{{{makeIMLink this.value.im}}}</strong> <span class="bullet">?</span> {{pluralCount this.value.count 'message' 'messages'}}
						{{/isWeb}}
						</li>
					{{/foreach}}
				</ul>
			{{/if}}
		</div>
	</div>
{{!
{
    "type": "messages",
    channels_total: 67, // added by js
    dms_total: 67, // added by js
    "channels": [
        {"id": "C1234", "url": "http://...", channel:{}, "is_member": true, "count": 1} // channel object is added in the JS
    ],
    "dms":[
        {"id": "D1234", "url": "http://...", im:{}, "count": 1} // im object is added in the JS
    ]
    "groups":[
        {"id": "G1234", "url": "http://...", group:{}, "count": 1} // group object is added in the JS
    ]
}
}}
</script>

<script id="activity_user_rename_template" type="text/x-handlebars-template">

	<div class="activity_item activity_user_rename">
		<div class="type_icon">
			{{{makeMemberPreviewLinkImage item.user.id 24}}} 
		</div>
		<span class="">{{{makeMemberPreviewLinkById item.user.id true}}} changed names from <b>{{item.old_name}}</b> to <b>{{item.new_name}}</b></span>
	</div>
		
</script>

<script id="activity_user_files_template" type="text/x-handlebars-template">

	<div class="activity_item activity_user_files">
		<div class="type_icon">
			{{{makeMemberPreviewLinkImage item.user 36}}}
		</div>
		{{#if_equal item.num_files compare=1}}
			<span class="activity_item_meta">{{{makeMemberPreviewLinkById item.user true}}} uploaded a file</span>
			{{#foreach item.files}}
				<br />
				<a href="{{this.value.permalink}}" {{#isClient}}target="{{this.value.permalink}}"{{/isClient}} data-file-id="{{this.value.id}}" class="file_preview_link file_name">
					{{#if this.value.title}}{{{formatFileTitle this.value}}}{{else}}{{this.value.name}}{{/if}}
				</a>
				<blockquote>
					<a href="{{this.value.permalink}}" {{#isClient}}target="{{this.value.permalink}}"{{/isClient}} data-file-id="{{this.value.id}}" class="file_preview_link icon icon_80 {{this.value.icon_class}}">
						{{#if this.value.thumb_80}}
							{{#if_equal this.value.icon_class compare="thumb_80"}}					
								<img src="{{this.value.thumb_80}}" />
							{{else}}
								<img src="{{this.value.thumb_360}}" />
							{{/if_equal}}						
						{{else}}
							<span data-file-id="{{this.value.id}}" class="filetype_icon s48 {{this.value.pretty_type}}"></span>
						{{/if}}
					</a>
					<div class="file_meta">
						{{toCalendarDateOrNamedDayShort this.value.timestamp}} at {{toTime this.value.timestamp}}<br />
						{{#if this.value.is_external}}
							{{{makeExternalFiletypeHTML this.value}}}
						{{else}}
							<a href="{{this.value.url_private_download}}" target="{{this.value.url_private_download}}" class="file_download_link" title="Download this file">{{convertFilesize this.value.size}} {{this.value.pretty_type}} file</a>
						{{/if}}<br />
						{{#if this.value.is_public}}
							{{#if this.value.is_shared}}
								in
								{{{makeFileGroupChannelList this.value}}}
							{{/if}}
						{{else}}
							<i class="fa fa-eye"></i>
							Private file {{#if this.value.groups}}in {{{makeFileGroupChannelList this.value}}}{{else}}{{#unless member.is_self}}shared with you{{/unless}}{{/if}}
						{{/if}}
						{{#if this.value.comments_count}}
							<br /><a href="{{this.value.permalink}}" {{#isClient}}target="{{this.value.permalink}}"{{/isClient}} data-file-id="{{this.value.id}}" class="file_preview_link">{{pluralCount this.value.comments_count 'comment' 'comments'}}</a>
						{{/if}}

					</div>
				</blockquote>
			{{/foreach}}
		{{else}}
			<span class="activity_item_meta">
				{{{makeMemberPreviewLinkById item.user}}} uploaded {{pluralCount item.num_files 'file' 'files'}}
				{{#if_gt item.num_files compare=item.files.length}}
					<span class="bullet">?</span> <span class="activity_item_actions"><a target="{{newWindowName}}" href="{{item.url}}">see all files...</a></span>
				{{/if_gt}}
			</span>
			<blockquote>
				{{#foreach item.files}}
					{{#if this.value.is_deleted}}
						(DELETED)
					{{else}}
						<div class="file_icon_container">
							<a href="{{this.value.permalink}}" {{#isClient}}target="{{this.value.permalink}}"{{/isClient}} data-file-id="{{this.value.id}}" class="file_preview_link icon icon_80 {{this.value.icon_class}}">
								{{#if this.value.thumb_80}}
									{{#if_equal this.value.icon_class compare="thumb_80"}}
										<img src="{{this.value.thumb_80}}" />
									{{else}}
										<img src="{{this.value.thumb_360}}" />
									{{/if_equal}}						
								{{else}}
									<span data-file-id="{{this.value.id}}" class="filetype_icon s48 {{this.value.pretty_type}}"></span>
								{{/if}}
							</a>
							<a href="{{this.value.permalink}}" {{#isClient}}target="{{this.value.permalink}}"{{/isClient}} data-file-id="{{this.value.id}}" class="file_preview_link bold">{{{truncate (formatFileTitle this.value) 18}}}</a>
						</div>
					{{/if}}
				{{/foreach}}
			</blockquote>
		{{/if_equal}}	
		<div class="clear-both"></div>
	</div>
{{!
{
	"type": "user_files",
	"user": "U1234",
	"files": [
		{...},
		{...}
	],
	"num_files": 4,
	"url": "http://..."
}
}}
</script>

<script id="activity_user_files_post_template" type="text/x-handlebars-template">

	<div class="activity_item activity_user_file_post">
		{{#foreach item.files}}
			<div class="type_icon">
				{{{makeMemberPreviewLinkImage ../item.user 36}}}
			</div>
			<span class="activity_item_meta">
				{{{makeMemberPreviewLinkById ../item.user true}}} published a post<br /> 
				<a href="{{this.value.permalink}}" {{#isClient}}target="{{this.value.permalink}}"{{/isClient}} data-file-id="{{this.value.id}}" class="file_preview_link file_name file_name">{{{formatFileTitle this.value}}}</a>
			</span>
			<blockquote>{{{nl2br this.value.preview}}}</blockquote>

			<div class="post_meta">
				<a href="{{this.value.permalink}}" {{#isClient}}target="{{this.value.permalink}}"{{/isClient}} data-file-id="{{this.value.id}}" class="file_preview_link">{{toCalendarDateOrNamedDayShort this.value.timestamp}} at {{toTime this.value.timestamp}}</a>
				{{#if this.value.comments_count}}
					<span class="bullet">?</span> <a href="{{this.value.permalink}}" {{#isClient}}target="{{this.value.permalink}}"{{/isClient}} data-file-id="{{this.value.id}}" class="file_preview_link">{{pluralCount this.value.comments_count 'comment' 'comments'}}</a>
				{{/if}}
				{{#if this.value.is_shared}}
					<span class="bullet">?</span> in
					{{{makeFileGroupChannelList this.value}}}
				{{/if}}
			</div>
		{{/foreach}}
	</div>
{{!
{
	"type": "user_files",
	"user": "U1234",
	"files": [
		{...},
		{...}
	],
	"num_files": 4,
	"url": "http://..."
}
}}
</script>

<script id="activity_user_files_snippet_template" type="text/x-handlebars-template">

	<div class="activity_item activity_user_file_post">
		{{#foreach item.files}}
			<div class="type_icon">
				{{{makeMemberPreviewLinkImage ../item.user 36}}}
			</div>
			<span class="activity_item_meta">
				{{{makeMemberPreviewLinkById ../item.user true}}} added a new snippet<br />
				<a href="{{this.value.permalink}}" {{#isClient}}target="{{this.value.permalink}}"{{/isClient}} data-file-id="{{this.value.id}}" class="file_preview_link file_name bold">{{{formatFileTitle this.value}}}</a>
			</span>
			
			{{#if this.value.preview_highlight}}
				<div class="clear-both"></div>
				<div class="snippet_preview">
					{{{this.value.preview_highlight}}}
					{{#if_gt this.value.lines_more compare=0}}
						<a href="{{this.value.permalink}}" class="snippet_preview_more" {{#isClient}}target="{{this.value.permalink}}"{{/isClient}} data-file-id="{{this.value.id}}" class="file_preview_link">+ {{this.value.lines_more}} more line{{#if_gt this.value.lines_more compare=1}}s{{/if_gt}}...</a>
					{{/if_gt}}
				</div>
			{{/if}}

			<div class="file_meta">
				{{convertFilesize this.value.size}} {{this.value.pretty_type}} file
				{{#if this.value.comments_count}}
					<span class="bullet">?</span> <a href="{{this.value.permalink}}" {{#isClient}}target="{{this.value.permalink}}"{{/isClient}} data-file-id="{{this.value.id}}" class="file_preview_link">{{pluralCount this.value.comments_count 'comment' 'comments'}}</a>
				{{/if}}
				{{#if this.value.is_shared}}
					<span class="bullet">?</span> in
					{{{makeFileGroupChannelList this.value}}}
				{{/if}}
			</div>
		{{/foreach}}
	</div>
{{!
{
	"type": "user_files",
	"user": "U1234",
	"files": [
		{...},
		{...}
	],
	"num_files": 4,
	"url": "http://..."
}
}}
</script>

<script id="activity_team_files_template" type="text/x-handlebars-template">

	<div class="activity_item activity_team_files">
		{{pluralCount item.num_users 'user' 'users'}} uploaded <a target="{{newWindowName}}" href="{{item.url}}" class="bold">{{pluralCount item.num_files 'file' 'files'}}</a>
	</div>
{{!
{
    "type": "team_files",
    "num_users": 12,
    "num_files": 30,
    "url": "http://..."
}
}}
</script>

<script id="activity_file_comments_template" type="text/x-handlebars-template">

	<div class="activity_item activity_file_comments feed_type_{{feed_type}}">

		<div class="type_icon">
			{{{makeMemberPreviewLinkImage item.file.user 36}}}<br />
			<i class="fa fa-quote-left icon_quote"></i>			
		</div>
		
		{{#if_equal item.comments.length compare=1}}
			{{#each item.comments}}
				<span class="activity_item_meta">
					{{{makeMemberPreviewLinkById this.user true}}}
					commented on your {{#if_equal ../../item.file.mode compare='snippet'}}snippet{{else}}{{#if_equal ../../item.file.mode compare='post'}}post{{else}}file{{/if_equal}}{{/if_equal}}<br />
				</span>
				<a href="{{../../item.file.permalink}}" {{#isClient}}target="{{../../item.file.permalink}}"{{/isClient}} data-file-id="{{../../item.file.id}}" class="file_preview_link file_name">{{{formatFileTitle ../../item.file}}}</a><br />
				<p class="comment_body">
					{{{makeMemberPreviewLinkById this.user true}}}
					<span class="time small_left_margin">{{toTime this.timestamp}}</span><br />
					{{{formatMessage this.comment}}}
				</p>
			{{/each}}
		{{else}}
			<span class="activity_item_meta">
				{{pluralCount item.comments.length 'new comment' 'new comments'}} on your {{#if_equal item.file.mode compare='snippet'}}snippet{{else}}{{#if_equal item.file.mode compare='post'}}post{{else}}file{{/if_equal}}{{/if_equal}}<br />
			</span>
			<a href="{{item.file.permalink}}" {{#isClient}}target="{{item.file.permalink}}"{{/isClient}} data-file-id="{{item.file.id}}" class="file_preview_link file_name">{{{formatFileTitle item.file}}}</a><br />
			{{#each item.comments}}
				<p class="comment_body">
					{{{makeMemberPreviewLinkById this.user true}}}
					<span class="time small_left_margin">{{toTime this.timestamp}}</span><br />
					{{{formatMessage this.comment}}}
				</p>
			{{/each}}
		{{/if_equal}}		
		
	</div>
{{!
{
	"type": "file_comments",
	"file": {...},
	"comments": [
		{"user": "U1", "count": 1},
		{"user": "U2", "count": 4}
	],
	"url": "http://..."
}
}}
</script>

<script id="activity_file_stars_template" type="text/x-handlebars-template">

	<div class="activity_item activity_file_stars activity_star">
	
		<div class="type_icon">
			{{#if can_unstar}}
				{{{star 'file' item.file null}}}
			{{else}}
				<span class="star starred not-clickable fa fa-star tiny"></span>
			{{/if}}
		</div>
		
		<span class="activity_item_meta">
			{{#foreach item.stars}}
				{{#if_gt ../item.stars.length compare=1}}{{#if this.last}}and {{/if}}{{/if_gt}}
				<strong>{{{makeMemberPreviewLinkById this.value.user true}}}</strong>{{#if_gt ../item.stars.length compare=2}}{{#if this.last}}{{else}},{{/if}}{{/if_gt}}
			{{/foreach}}
			starred your 
			{{#if_equal item.file.mode compare="snippet"}}
				snippet:
			{{/if_equal}}
			{{#if_equal item.file.mode compare="post"}}
				post:
			{{/if_equal}}
			{{#if_equal item.file.mode compare="hosted"}}
				file:
			{{/if_equal}}
			{{#if_equal item.file.mode compare="external"}}
				file:
			{{/if_equal}} 
		</span>
		
		{{#if item.file.is_deleted}}
			(DELETED)
		{{else}}
			<a href="{{item.file.permalink}}" {{#isClient}}target="{{item.file.permalink}}"{{/isClient}} data-file-id="{{item.file.id}}" class="file_preview_link bold">{{{formatFileTitle item.file}}}</a>
		{{/if}}
	</div>

{{!
{
	"type": "file_stars",
	"file": {...},
	"stars": [
		{"user": "U123"},
		{"user": "U456"}
	]
}
}}
</script>

<script id="activity_file_comment_stars_template" type="text/x-handlebars-template">

	<div class="activity_item activity_file_comment_stars activity_star">
	
		<div class="type_icon">
			{{#if can_unstar}}
				{{{star 'file_comment' item.comment item.file}}}
			{{else}}
				<span class="star starred not-clickable fa fa-star tiny"></span>
			{{/if}}
		</div>
			
		<span class="activity_item_meta">
			{{#foreach item.stars}}
				{{#if_gt ../item.stars.length compare=1}}{{#if this.last}}and {{/if}}{{/if_gt}}
				<strong>{{{makeMemberPreviewLinkById this.value.user true}}}</strong>{{#if_gt ../item.stars.length compare=2}}{{#if this.last}}{{else}},{{/if}}{{/if_gt}}
			{{/foreach}}
			starred your comment on
			{{#if_equal item.file.user compare=item.comment.user}}
				your
			{{else}}
				<strong>{{{makeMemberPreviewLinkById item.file.user}}}</strong>'s
			{{/if_equal}}
			{{#if_equal item.file.mode compare="snippet"}}
				snippet:
			{{/if_equal}}
			{{#if_equal item.file.mode compare="hosted"}}
				file:
			{{/if_equal}}
			{{#if_equal item.file.mode compare="external"}}
				file:
			{{/if_equal}} 
		</span>
		<a href="{{item.file.permalink}}" {{#isClient}}target="{{item.file.permalink}}"{{/isClient}} data-file-id="{{item.file.id}}" class="file_preview_link bold">{{{formatFileTitle item.file}}}</a>
	
	</div>

{{!
{
	"type": "file_comment_stars",
	"file": {...},
	"comment": {...},
	"stars": [
		{"user": "U123"},
		{"user": "U456"}
	]
}
}}
</script>

<script id="activity_message_stars_template" type="text/x-handlebars-template">

	<div class="activity_item activity_message_stars activity_star">		
		
		<div class="type_icon">		
			{{#if can_unstar}}
				{{{star 'message' item.message item.channel}}}
			{{else}}
				<span class="star starred not-clickable fa fa-star tiny"></span>
			{{/if}}
		</div>
		
		<span class="activity_item_meta">
			{{#foreach item.stars}}
				{{#if_gt ../item.stars.length compare=1}}{{#if this.last}}and {{/if}}{{/if_gt}}
				<strong>{{{makeMemberPreviewLinkById this.value.user true}}}</strong>{{#if_gt ../item.stars.length compare=2}}{{#if this.last}}{{else}},{{/if}}{{/if_gt}}
			{{/foreach}}
			starred your 
			{{#if item.message.permalink}}
				message in <a href="{{item.message.permalink}}" target="{{newWindowName}}" class="bold">{{{getChannelOrGroupNameWithPrefixById item.channel}}}</a>
			{{else}}
				direct message{{#foreach item.stars}}{{#if_equal this.value.user compare=../item.message.recipient.id}}{{else}} with {{{makeMemberPreviewLinkById ../../item.message.recipient.id}}}{{/if_equal}}{{/foreach}}
			{{/if}}
		</span><br />
		<blockquote class="starred_message">
			{{{makeMemberPreviewLinkById item.message.user}}}
			{{#if item.message.permalink}}
				<a href="{{item.message.permalink}}" target="{{newWindowName}}" class="time small_left_margin">{{toTime item.message.ts}}</a>
			{{else}}
				<span class="time small_left_margin">{{toTime item.message.ts}}</span>
			{{/if}}<br />
			{{{formatMessageByType item.message}}}
		</blockquote>		
	</div>

{{!
{
	"type": "message_stars",
	"channel": "C123",
	"message": {...},
	"stars": [
		{"user": "U123"},
		{"user": "U456"}
	]
}
}}
</script>

<script id="activity_new_channels_template" type="text/x-handlebars-template">

	<div class="activity_item activity_new_channels subtle_silver">
		{{#if_equal item.num_channels compare=1}}
			{{#foreach item.channels}}
				<div class="type_icon">
					{{{makeMemberPreviewLinkImage this.value.creator 36}}}
				</div>
				<strong>{{{makeMemberPreviewLinkById this.value.creator true}}}</strong>
				created a new channel<br />
				<strong>{{{makeChannelLink this.value}}}</strong>
				{{#if this.purpose}}<span class="bullet">?</span> {{{formatTopicOrPurpose this.purpose}}}{{/if}}
			{{/foreach}}
		{{else}}
			{{item.num_channels}} new channels were created{{#if_gt item.num_channels compare=5}}, including{{/if_gt}}:		
			{{#foreach item.channels}}
				{{#if this.last}}and {{/if}}<strong>{{{makeChannelLink this.value}}}</strong>{{#if this.last}}{{else}},{{/if}}			
			{{/foreach}}
		{{/if_equal}}
	</div>
{{!
{
    "type": "new_channels",
    "num_channels": 5,
    "channels": [
        {}, these are turned into channel objects from the ids, in the JS
        {}
    ]
}
}}
</script>

<script id="activity_new_members_template" type="text/x-handlebars-template">

	<div class="activity_item activity_new_members subtle_silver">
		{{#if_equal item.num_members compare=1}}
			{{#foreach item.members}}
				<div class="type_icon">				
					{{{makeMemberPreviewLinkImage this.value 36}}}
				</div>
				<strong>{{{makeMemberPreviewLinkById this.value}}}</strong>
			{{/foreach}}<br />
			joined the team!
		{{else}}
			{{item.num_members}} new people joined the team{{#if_gt item.num_members compare=5}}, including{{/if_gt}}:			
			{{#foreach item.members}}
				{{#if this.last}}and {{/if}}<strong>{{{makeMemberPreviewLinkById this.value}}}</strong>{{#if this.last}}{{else}},{{/if}}
			{{/foreach}}
		{{/if_equal}}
	</div>
{{!
{
    "type": "new_members",
    "num_members": 5,
    "members": [
        {}
        {}
    ]
}
}}
</script>

<script id="activity_unread_messages_template" type="text/x-handlebars-template">

	<div id="{{makeUnreadMessagesDomId item}}" class="activity_item activity_unread_messages feed_type_{{feed_type}}">

		<div class="type_icon">
			{{#if_gt item.num_unread compare=0}}
				<span class="marker"></span>
			{{else}}
				<span class="badge">{{item.num_mentions}}</span>
			{{/if_gt}}
		</div>
		
		<strong>{{{makeChannelLink item.channel}}}</strong> <span class="bullet">?</span>
		{{#if item.num_unread}}{{pluralCount item.num_unread 'unread message' 'unread messages'}}{{/if}}
		{{#if item.num_unread}}{{#if item.num_mentions}}and{{/if}}{{/if}}
		{{#if item.num_mentions}}{{pluralCount item.num_mentions 'new mention' 'new mentions'}}{{/if}}
		{{!-- since {{toCalendarDateOrNamedDayShort item.last_read_ts}} at {{toTime item.last_read_ts}} --}}
		
		<span class="activity_item_actions">
			<span class="bullet">?</span>
			<a class="show_link" onclick="TS.activity.view.expandMsgs('{{item.id}}', '{{item.last_read_ts}}', '{{makeUnreadMessagesDomId item}}')">view</a>
			<a class="hide_link hidden" onclick="TS.activity.view.unexpandMsgs('{{makeUnreadMessagesDomId item}}')">hide</a>
			<a class="mark_read_link hidden inverted float-right btn btn-primary btn-mini" onclick="TS.activity.view.markMsgsRead('{{item.id}}', '{{makeUnreadMessagesDomId item}}')">Mark Read</a>
		</span>
		<div class="clear-both"></div>

		<div class="expanded_msgs_div_wrapper hidden"><div class="expanded_msgs_div msgs_holder hidden"></div></div>
		<div class="clear-both"></div>
		<div class="expanded_msgs_footer_div hidden">
			<span class="more_messages_notice hidden">There are more messages, see them here: {{{makeChannelLink item.channel}}}</span>
		</div>

	</div>
{{!
{
	"type": "unread_messages",
	"id": "C123",
	"channel": {}, // added by js
	"num_unread": 20,
	"num_mentions": 1,
	"last_read_ts": "1358467696.000002"
}
}}
</script>

<script id="activity_unread_group_messages_template" type="text/x-handlebars-template">

	<div id="{{makeUnreadGroupMessagesDomId item}}" class="activity_item activity_unread_group_messages feed_type_{{feed_type}}">

		<div class="type_icon">
			{{#if_gt item.num_unread compare=0}}
				<span class="marker"></span>
			{{else}}
				<span class="badge">{{item.num_mentions}}</span>
			{{/if_gt}}
		</div>
		
		<strong>{{{makeGroupLink item.group}}}</strong> <span class="bullet">?</span>
		{{#if item.num_unread}}{{pluralCount item.num_unread 'unread message' 'unread messages'}}{{/if}}
		{{#if item.num_unread}}{{#if item.num_mentions}}and{{/if}}{{/if}}
		{{#if item.num_mentions}}{{pluralCount item.num_mentions 'new mention' 'new mentions'}}{{/if}}
		{{!-- since {{toCalendarDateOrNamedDayShort item.last_read_ts}} at {{toTime item.last_read_ts}} --}}
		
		<span class="activity_item_actions">
			<span class="bullet">?</span>
			<a class="show_link" onclick="TS.activity.view.expandMsgs('{{item.id}}', '{{item.last_read_ts}}', '{{makeUnreadGroupMessagesDomId item}}')">view</a>
			<a class="hide_link hidden" onclick="TS.activity.view.unexpandMsgs('{{makeUnreadGroupMessagesDomId item}}')">hide</a>
			<a class="mark_read_link hidden inverted float-right btn btn-primary btn-mini" onclick="TS.activity.view.markMsgsRead('{{item.id}}', '{{makeUnreadGroupMessagesDomId item}}')">Mark Read</a>
		</span>
		<div class="clear-both"></div>

		<div class="expanded_msgs_div_wrapper hidden"><div class="expanded_msgs_div msgs_holder hidden"></div></div>
		<div class="clear-both"></div>
		<div class="expanded_msgs_footer_div hidden">
			<span class="more_messages_notice hidden">There are more messages, see them here: {{{makeGroupLink item.group}}}</span>
		</div>

	</div>
{{!
{
	"type": "unread_group_messages",
	"id": "G123",
	"group": {}, // added by js
	"num_unread": 20,
	"num_mentions": 1,
	"last_read_ts": "1358467696.000002"
}
}}
</script>

<script id="activity_unread_dms_template" type="text/x-handlebars-template">

	<div id="{{makeUnreadDmsDomId item}}" class="activity_item activity_unread_dms feed_type_{{feed_type}}">

		<div class="type_icon">
			<span class="badge">{{item.num_dms}}</span>
		</div>

		{{pluralize item.num_dms 'new message' 'new messages'}}
		from <strong class="{{getMemberColorClassById item.im.user}}">{{{makeIMLink item.im}}}</strong> 
		{{!-- since {{toCalendarDateOrNamedDayShort item.last_read_ts}} at {{toTime item.last_read_ts}} --}}
		<span class="bullet">?</span>

		<span class="activity_item_actions">
			<span class="bullet">?</span>
			<a class="show_link" onclick="TS.activity.view.expandMsgs('{{item.id}}', '{{item.last_read_ts}}', '{{makeUnreadDmsDomId item}}')">view</a>
			<a class="hide_link hidden" onclick="TS.activity.view.unexpandMsgs('{{makeUnreadDmsDomId item}}')">hide</a>
			<a href="/messages/@{{item.im.name}}" class="internal_im_link open_channel_link hidden btn btn-outline btn-mini small_left_margin" data-member-name="{{item.im.name}}">Open Conversation</a>
			<a class="mark_read_link hidden inverted float-right btn btn-primary btn-mini" onclick="TS.activity.view.markMsgsRead('{{item.id}}', '{{makeUnreadDmsDomId item}}')">Mark Read</a>
		</span>

		<div class="expanded_msgs_div_wrapper hidden"><div class="expanded_msgs_div msgs_holder hidden"></div></div>
		<div class="clear-both"></div>
		<div class="expanded_msgs_footer_div hidden">
			<a class="mark_read_link hidden float-right" onclick="TS.activity.view.markMsgsRead('{{item.id}}', '{{makeUnreadDmsDomId item}}')">&#x2714; Mark Read</a>
			<span class="more_messages_notice inverted hidden">There are more messages, see them here: {{{makeIMLink item.im}}}</span>
		</div>

	</div>
{{!
{
	"type": "unread_dms",
	"id": "C123",
	"im": {}, // added by js
	"num_dms": 20,
	"last_read_ts": "1358467696.000002"
}
}}
</script>

<script id="activity_sent_messages_template" type="text/x-handlebars-template">

	<div id="{{makeSentMessagesDomId item}}" class="activity_item activity_sent_messages">

		<strong>{{{makeChannelLink item.channel}}}</strong> had 
		{{#if item.num_messages}}<strong>{{item.num_messages}}</strong> {{pluralize item.num_messages 'new message' 'new messages'}}{{/if}}
		{{#if item.num_messages}}{{#if item.num_mentions}}and{{/if}}{{/if}}
		{{#if item.num_mentions}}<strong>{{item.num_mentions}}</strong> {{pluralize item.num_mentions 'mention' 'mentions'}}{{/if}}

		<span class="activity_item_actions">
			<span class="bullet">?</span>
			<a class="show_link" onclick="TS.activity.view.expandMsgs('{{item.id}}', '{{item.oldest_ts}}', '{{makeSentMessagesDomId item}}')">view</a>
			<a class="hide_link hidden" onclick="TS.activity.view.unexpandMsgs('{{makeSentMessagesDomId item}}')">hide</a>
		</span>

		<div class="expanded_msgs_div_wrapper hidden"><div class="expanded_msgs_div msgs_holder hidden"></div></div>
		<div class="clear-both"></div>
		<div class="expanded_msgs_footer_div hidden"></div>

	</div>
{{!
{
	"type": "sent_messages",
	"id": "C123",
	"num_messages": 20,
	"num_mentions": 1,
	"channel": {}, // added in the JS
	"oldest_ts": "1358467696.000002"
}
}}
</script>

<script id="activity_sent_group_messages_template" type="text/x-handlebars-template">

	<div id="{{makeSentMessagesDomId item}}" class="activity_item sent_group_messages">

		<strong>{{{makeGroupLink item.group}}}</strong> had 
		{{#if item.num_messages}}<strong>{{item.num_messages}}</strong> {{pluralize item.num_messages 'new message' 'new messages'}}{{/if}}
		{{#if item.num_messages}}{{#if item.num_mentions}}and{{/if}}{{/if}}
		{{#if item.num_mentions}}<strong>{{item.num_mentions}}</strong> {{pluralize item.num_mentions 'mention' 'mentions'}}{{/if}}

		<span class="activity_item_actions">
			<span class="bullet">?</span>
			<a class="show_link" onclick="TS.activity.view.expandMsgs('{{item.id}}', '{{item.oldest_ts}}', '{{makeSentMessagesDomId item}}')">view</a>
			<a class="hide_link hidden" onclick="TS.activity.view.unexpandMsgs('{{makeSentMessagesDomId item}}')">hide</a>
		</span>

		<div class="expanded_msgs_div_wrapper hidden"><div class="expanded_msgs_div msgs_holder hidden"></div></div>
		<div class="clear-both"></div>
		<div class="expanded_msgs_footer_div hidden"></div>

	</div>
{{!
{
	"type": "sent_group_messages",
	"id": "G123",
	"num_messages": 20,
	"num_mentions": 1,
	"group": {}, // added in the JS
	"oldest_ts": "1358467696.000002"
}
}}
</script>

<script id="activity_sent_dms_template" type="text/x-handlebars-template">

	<div id="{{makeSentDmsDomId item}}" class="activity_item activity_sent_dms">
		
		{{{makeMemberPreviewLinkById item.im.user}}} sent you 
		{{#if_gt item.num_dms compare=1}}<strong>{{item.num_dms}}</strong>{{else}}a{{/if_gt}}
		{{pluralize item.num_dms 'direct message' 'direct messages'}}

		<span class="activity_item_actions small_left_margin">
			<a class="show_link btn btn-outline btn-mini" onclick="TS.activity.view.expandMsgs('{{item.id}}', '{{item.oldest_ts}}', '{{makeSentDmsDomId item}}')">View</a>
			<a class="hide_link btn btn-outline btn-mini hidden" onclick="TS.activity.view.unexpandMsgs('{{makeSentDmsDomId item}}')">Hide</a>
		</span>

		<div class="expanded_msgs_div_wrapper hidden"><div class="expanded_msgs_div msgs_holder hidden"></div></div>
		<div class="clear-both"></div>
		<div class="expanded_msgs_footer_div hidden"></div>

	</div>
{{!
{
	"type": "sent_dms",
	"id": "C123",
	"num_dms": 20,
	"im": {}, // added in the JS
	"oldest_ts": "1358467696.000002"
}
}}
</script>

<script id="activity_user_file_template" type="text/x-handlebars-template">

	<div class="activity_item activity_user_file">
		<div class="type_icon">
			{{{makeMemberPreviewLinkImage item.file.user 36}}}
		</div>

		<span class="activity_item_meta">{{{makeMemberPreviewLinkById item.file.user true}}} uploaded a file</span><br />
		<span class="overflow-ellipsis">
			<a href="{{item.file.permalink}}" {{#isClient}}target="{{item.file.permalink}}"{{/isClient}} data-file-id="{{item.file.id}}" class="file_preview_link file_name">
				{{#if item.file.title}}
					{{{highlightSearchMatchesInFileTitle item.file.title}}}
				{{else}}
					{{{highlightSearchMatches item.file.name}}}
				{{/if}}					
			</a>
		</span>
		
		<blockquote>
			<a href="{{item.file.permalink}}" {{#isClient}}target="{{item.file.permalink}}"{{/isClient}} data-file-id="{{item.file.id}}" class="file_preview_link icon icon_80 {{item.file.icon_class}}">
				{{#if item.file.thumb_80}}
					{{#if_equal item.file.icon_class compare="thumb_80"}}					
						<img src="{{item.file.thumb_80}}" />
					{{else}}
						<img src="{{item.file.thumb_360}}" />
					{{/if_equal}}						
				{{else}}
					<span data-file-id="{{item.file.id}}" class="filetype_icon s48 {{item.file.filetype}}"></span>
				{{/if}}
			</a>
			<div class="file_meta">
				{{toCalendarDateOrNamedDayShort item.file.timestamp}} at {{toTime item.file.timestamp}}<br />
				{{#if item.item.file.is_external}}
					{{{makeExternalFiletypeHTML item.file}}}
				{{else}}
					<a href="{{item.file.url_private_download}}" target="{{item.file.url_private_download}}" class="file_download_link" title="Download this file">{{convertFilesize item.file.size}} {{item.file.pretty_type}} file</a>
				{{/if}}<br />
				{{#if item.file.is_public}}
					{{#if item.file.is_shared}}
						in
						{{{makeFileGroupChannelList item.file}}}
					{{/if}}
				{{else}}
					<i class="fa fa-eye"></i>
					Private file {{#if item.file.groups}}in {{{makeFileGroupChannelList item.file}}}{{else}}{{#unless member.is_self}}shared with you{{/unless}}{{/if}}
				{{/if}}
				{{#if item.file.comments_count}}
					<br /><a href="{{item.file.permalink}}" {{#isClient}}target="{{item.file.permalink}}"{{/isClient}} data-file-id="{{item.file.id}}" class="file_preview_link">{{pluralCount item.file.comments_count 'comment' 'comments'}}</a>
				{{/if}}

			</div>
		</blockquote>
		
	</div>

</script>

<script id="activity_user_file_post_template" type="text/x-handlebars-template">

	<div class="activity_item activity_user_file_post">
		<div class="type_icon">				
			{{{makeMemberPreviewLinkImage item.file.user 36}}}
		</div>
		<span class="activity_item_meta">
			{{{makeMemberPreviewLinkById item.file.user}}} published a post<br />
			<a href="{{item.file.permalink}}" {{#isClient}}target="{{item.file.permalink}}"{{/isClient}} data-file-id="{{item.file.id}}" class="file_preview_link file_name file_name">{{{formatFileTitle item.file}}}</a>
		</span>
		<blockquote>{{{nl2br item.file.preview}}}</blockquote>

		<div class="post_meta">
			<a href="{{item.file.permalink}}" {{#isClient}}target="{{item.file.permalink}}"{{/isClient}} data-file-id="{{item.file.id}}" class="file_preview_link time">{{toCalendarDateOrNamedDayShort item.file.timestamp}} at {{toTime item.file.timestamp}}</a>
			{{#if item.file.comments_count}}
				<span class="bullet">?</span> <a href="{{item.file.permalink}}" {{#isClient}}target="{{item.file.permalink}}"{{/isClient}} data-file-id="{{item.file.id}}" class="file_preview_link">{{pluralCount item.file.comments_count 'comment' 'comments'}}</a>
			{{/if}}
			{{#if item.file.is_shared}}
				<span class="bullet">?</span> in
				{{{makeFileGroupChannelList item.file}}}
			{{/if}}
		</div>
	</div>

</script>

<script id="activity_user_file_snippet_template" type="text/x-handlebars-template">

	<div class="activity_item activity_user_post">
		<div class="type_icon">				
			{{{makeMemberPreviewLinkImage item.file.user 36}}}
		</div>
		<span class="activity_item_meta">
			{{{makeMemberPreviewLinkById item.file.user}}} added a new snippet<br />
			<a href="{{item.file.permalink}}" {{#isClient}}target="{{item.file.permalink}}"{{/isClient}} data-file-id="{{item.file.id}}" class="file_preview_link file_name bold">{{{formatFileTitle item.file}}}</a>
		</span>
		
		{{#if item.file.preview_highlight}}
			<div class="clear-both"></div>
			<div class="snippet_preview">
				{{{item.file.preview_highlight}}}
				{{#if_gt item.file.lines_more compare=0}}
					<a href="{{item.file.permalink}}" class="snippet_preview_more" {{#isClient}}target="{{item.file.permalink}}"{{/isClient}} data-file-id="{{item.file.id}}" class="file_preview_link">+ {{item.file.lines_more}} more line{{#if_gt item.file.lines_more compare=1}}s{{/if_gt}}...</a>
				{{/if_gt}}
			</div>
		{{/if}}

		<div class="file_meta">
			<a href="{{item.file.permalink}}" {{#isClient}}target="{{item.file.permalink}}"{{/isClient}} data-file-id="{{item.file.id}}" class="file_preview_link time">{{toCalendarDateOrNamedDayShort item.file.timestamp}} at {{toTime item.file.timestamp}}</a>
			<span class="bullet">?</span> {{convertFilesize item.file.size}} {{item.file.pretty_type}} file
			{{#if item.file.comments_count}}
				<span class="bullet">?</span> <a href="{{item.file.permalink}}" {{#isClient}}target="{{item.file.permalink}}"{{/isClient}} data-file-id="{{item.file.id}}" class="file_preview_link">{{pluralCount item.file.comments_count 'comment' 'comments'}}</a>
			{{/if}}
			{{#if item.file.is_shared}}
				<span class="bullet">?</span> in
				{{{makeFileGroupChannelList item.file}}}
			{{/if}}			
		</div>
	</div>

</script>

<script id="activity_user_file_comment_template" type="text/x-handlebars-template">

	<div class="activity_item activity_user_file_comment">

		<div class="type_icon">
			{{{makeMemberPreviewLinkImage item.comment.user 36}}}<br />
			<i class="fa fa-quote-left icon_quote"></i>			
		</div>
		
		<span class="activity_item_meta">
			{{{makeMemberPreviewLinkById item.comment.user true}}}
			commented on 
			{{{makeMemberPreviewLinkById item.file.user false}}}'s 
			{{#if_equal item.file.mode compare='snippet'}}snippet{{else}}{{#if_equal item.file.mode compare='post'}}post{{else}}file{{/if_equal}}{{/if_equal}}<br />
		</span>
		<a href="{{item.file.permalink}}" {{#isClient}}target="{{item.file.permalink}}"{{/isClient}} data-file-id="{{item.file.id}}" class="file_preview_link file_name">{{{formatFileTitle item.file}}}</a><br />
		<p class="comment_body">
			{{{makeMemberPreviewLinkById item.comment.user true}}}
			<span class="time small_left_margin">{{toTime item.comment.timestamp}}</span><br />
			{{{formatMessage item.comment.comment}}}
		</p>
	</div>

</script>


<script id="activity_user_star_template" type="text/x-handlebars-template">

	<div class="activity_item activity_user_star activity_star">
		
		<div class="type_icon">
			{{#if item.user.is_self}}
				{{! MESSAGES }}
				{{#if_equal item.item.type compare="message"}}
					{{{star 'message' item.item.message item.item.channel}}}
				{{/if_equal}}
	
				{{! CHANNELS }}
				{{#if_equal item.item.type compare="channel"}}
					{{{star 'channel' item.item.channel null}}}
				{{/if_equal}}

				{{! PRIVATE GROUPS }}
				{{#if_equal item.item.type compare="group"}}
					{{{star 'group' item.item.channel null}}}
				{{/if_equal}}	
			
				{{! FILES }}		
				{{#if_equal item.item.type compare="file"}}
					{{{star 'file' item.item.file null}}}
				{{/if_equal}}
	
				{{#if_equal item.item.type compare="file_comment"}}
					{{{star 'file_comment' item.item.comment item.item.file}}}
				{{/if_equal}}
			{{else}}
				<span class="star starred not-clickable fa fa-star tiny"></span>
			{{/if}}
		</div>
		
		<span class="activity_item_meta">
			{{{makeMemberPreviewLinkById item.user.id true}}} starred
		</span>

		{{! MESSAGES }}
		{{#if_equal item.item.type compare="message"}}
			<span class="activity_item_meta">
				{{#if item.item.message.user}}
					{{#if_equal current_user_id compare=item.item.message.user}}
						your
					{{else}}
						{{#if_equal item.item.message.user compare=item.user.id}}
							a
						{{else}}
							{{{makeMemberPreviewLinkById item.item.message.user false}}}'s 
						{{/if_equal}}				
					{{/if_equal}}
				{{else}}
					a
				{{/if}}			
				{{#if item.item.permalink}}
					message in <a href="{{item.item.permalink}}" target="{{newWindowName}}" class="bold">{{{getChannelOrGroupNameWithPrefixById item.item.channel}}}</a>
				{{else}}
					direct message
				{{/if}}
			</span>
			<blockquote class="starred_message">
				{{{makeMemberPreviewLinkById item.item.message.user}}}
				{{#if item.item.permalink}}
					<a href="{{item.item.permalink}}" target="{{newWindowName}}" class="time small_left_margin">{{toTime item.item.message.ts}}</a>
				{{else}}
					<span class="time small_left_margin">{{toTime item.item.message.ts}}</span>
				{{/if}}<br />
				{{{formatMessageByType item.item.message}}}
			</blockquote>
		{{/if_equal}}


		{{! CHANNELS }}
		{{#if_equal item.item.type compare="channel"}}
			<span class="activity_item_meta">a channel: <strong>{{{makeChannelLinkById item.item.channel}}}</strong></span>
		{{/if_equal}}

		{{! PRIVATE GROUPS }}
		{{#if_equal item.item.type compare="group"}}
			<span class="activity_item_meta">a group: <strong>{{{makeGroupLinkById item.item.channel}}}</strong></span>
		{{/if_equal}}

		
		{{! FILES }}		
		{{#if_equal item.item.type compare="file"}}
			<span class="activity_item_meta">
				{{#if_equal current_user_id compare=item.item.file.user}}
					your
				{{else}}
					{{#if_equal item.item.file.user compare=item.user.id}}
						a
					{{else}}
						{{{makeMemberPreviewLinkById item.item.file.user false}}}'s 
					{{/if_equal}}				
				{{/if_equal}}
				{{#if_equal item.item.file.mode compare="snippet"}}
					snippet:
				{{/if_equal}}
				{{#if_equal item.item.file.mode compare="hosted"}}
					file:
				{{/if_equal}}
				{{#if_equal item.item.file.mode compare="external"}}
					file:
				{{/if_equal}}
				<a href="{{item.item.file.permalink}}" data-file-id="{{item.item.file.id}}" class="file_preview_link bold">{{{formatFileTitle item.item.file}}}</a>
			</span>
		{{/if_equal}}

		{{#if_equal item.item.type compare="file_comment"}}
			<span class="activity_item_meta">
				{{#if_equal current_user_id compare=item.item.comment.user}}
					your
				{{else}}
					{{#if_equal item.item.comment.user compare=item.user.id}}
						a
					{{else}}
						{{{makeMemberPreviewLinkById item.item.comment.user false}}}'s 
					{{/if_equal}}				
				{{/if_equal}}
				comment on
				{{#if_equal current_user_id compare=item.item.file.user}}
					your
				{{else}}
					{{#if_equal item.item.file.user compare=item.user.id}}
						a
					{{else}}
						{{{makeMemberPreviewLinkById item.item.file.user false}}}'s 
					{{/if_equal}}				
				{{/if_equal}}
				{{#if_equal item.item.file.mode compare="snippet"}}
					snippet:
				{{/if_equal}}
				{{#if_equal item.item.file.mode compare="hosted"}}
					file:
				{{/if_equal}}
				{{#if_equal item.item.file.mode compare="external"}}
					file:
				{{/if_equal}}: <a href="{{item.item.file.permalink}}" data-file-id="{{item.item.file.id}}" class="file_preview_link bold">{{{formatFileTitle item.item.file}}}</a>
			</span>
		{{/if_equal}}

	</div>

{{!
{
	"type": "user_star",
	"user": {...}, // added by JS
	"item": {...} //The format of the item prop is the same as is used by the stars.list API method.
}
}}
</script>

<script id="activity_starred_by_you_template" type="text/x-handlebars-template">

	<div class="activity_item activity_starred_by_you activity_star">
		
		{{#if 0}} {{! decided it is smarter to not let these be unstarrable from the actvity list}}
		
			{{! MESSAGES }}
			{{#if_equal item.item.type compare="message"}}
				{{{star 'message' item.item.message item.item.channel}}}
			{{/if_equal}}
	
	
			{{! CHANNELS }}
			{{#if_equal item.item.type compare="channel"}}
				{{{star 'channel' item.item.channel null}}}
			{{/if_equal}}
	
	
			{{! GROUPS }}
			{{#if_equal item.item.type compare="group"}}
				{{{star 'group' item.item.channel null}}}
			{{/if_equal}}
	
			
			{{! FILES }}		
			{{#if_equal item.item.type compare="file"}}
				{{{star 'file' item.item.file null}}}
			{{/if_equal}}
	
			{{#if_equal item.item.type compare="file_comment"}}
				{{{star 'file_comment' item.item.comment item.item.file}}}
			{{/if_equal}}
			
		{{else}}
		
			<div class="type_icon"><span class="star starred not-clickable fa fa-star tiny"></span></div>

		{{/if}}
		
		<span class="activity_item_meta">
			{{{makeMemberPreviewLinkById item.user.id true}}} starred 
		</span>

		{{! MESSAGES }}
		{{#if_equal item.item.type compare="message"}}
			<span class="activity_item_meta">
				{{#if item.item.message.user}}
					{{#if_equal item.item.message.user compare=item.user.id}}
						your
					{{else}}
						{{{makeMemberPreviewLinkById item.item.message.user}}}'s 
					{{/if_equal}}
				{{else}}
					a
				{{/if}}			
				{{#if item.item.permalink}}
					message in <a href="{{item.item.permalink}}" target="{{newWindowName}}" class="bold">{{{getChannelOrGroupNameWithPrefixById item.item.channel}}}</a>
				{{else}}
					direct message{{#if_equal item.item.message.user compare=item.item.message.recipient.id}}{{else}} with {{{makeMemberPreviewLinkById item.item.message.recipient.id}}}{{/if_equal}}
				{{/if}}
			</span><br />
			<blockquote class="starred_message">
				{{{makeMemberPreviewLinkById item.item.message.user}}}
				{{#if item.item.permalink}}
					<a href="{{item.item.permalink}}" target="{{newWindowName}}" class="time small_left_margin">{{toTime item.item.message.ts}}</a>
				{{else}}
					<span class="time small_left_margin">{{toTime item.item.message.ts}}</span>
				{{/if}}<br />
				{{{formatMessageByType item.item.message}}}
			</blockquote>
		{{/if_equal}}

		{{! CHANNELS }}
		{{#if_equal item.item.type compare="channel"}}
			<span class="activity_item_meta">a channel: <strong>{{{makeChannelLinkById item.item.channel}}}</strong></span>
		{{/if_equal}}

		{{! GROUPS }}
		{{#if_equal item.item.type compare="group"}}
			<span class="activity_item_meta">a private group: <strong>{{{makeGroupLinkById item.item.channel}}}</strong></span>
		{{/if_equal}}

		{{! DMs }}
		{{#if_equal item.item.type compare="im"}}
			<span class="activity_item_meta">your direct message conversation with <strong>{{{makeIMLinkById item.item.channel}}}</strong></span>
		{{/if_equal}}
		
		{{! FILES }}		
		{{#if_equal item.item.type compare="file"}}
			<span class="activity_item_meta">
				{{#if_equal item.item.file.user compare=item.user.id}}
					your
				{{else}}
					{{{makeMemberPreviewLinkById item.item.file.user}}}'s 
				{{/if_equal}}
				{{#if_equal item.item.file.mode compare="snippet"}}
					snippet:
				{{/if_equal}}
				{{#if_equal item.item.file.mode compare="hosted"}}
					file:
				{{/if_equal}}
				{{#if_equal item.item.file.mode compare="external"}}
					file:
				{{/if_equal}}
				{{#if item.item.file.is_deleted}}(DELETED){{else}}<a href="{{item.item.file.permalink}}" data-file-id="{{item.item.file.id}}" class="file_preview_link bold">{{{formatFileTitle item.item.file}}}</a>{{/if}}
			</span>
		{{/if_equal}}

		{{#if_equal item.item.type compare="file_comment"}}
			<span class="activity_item_meta">
				{{#if_equal item.item.comment.user compare=item.user.id}}
					your
				{{else}}
					{{{makeMemberPreviewLinkById item.item.comment.user}}}'s
				{{/if_equal}}
				comment on
				{{#if_equal item.item.file.user compare=item.user.id}}
					your
				{{else}}
					{{{makeMemberPreviewLinkById item.item.file.user}}}'s 
				{{/if_equal}}
				{{#if_equal item.item.file.mode compare="snippet"}}
					snippet:
				{{/if_equal}}
				{{#if_equal item.item.file.mode compare="hosted"}}
					file:
				{{/if_equal}}
				{{#if_equal item.item.file.mode compare="external"}}
					file:
				{{/if_equal}}: <a href="{{item.item.file.permalink}}" data-file-id="{{item.item.file.id}}" class="file_preview_link bold">{{{formatFileTitle item.item.file}}}</a>
			</span>
		{{/if_equal}}

	</div>

{{!
{
	"type": "starred_by_you",
	"user": {...}, // added by JS
	"item": {...} //The format of the item prop is the same as is used by the stars.list API method.
}
}}
</script>


<script id="activity_day_template" type="text/x-handlebars-template">

	<div class="activity_day {{#if content}}{{else}}hidden{{/if}}" id="{{makeActivityDayDomId date_str}}">
		{{#if content}}
			<div class="activity_day_date day_divider"><hr /><div class="day_divider_label">{{toCalendarDateOrNamedDay date_str}}</div></div>
			<div class="activity_day_content">
				{{{content}}}
			</div>
		{{/if}}
	</div>

</script>

<script id="activity_days_list_template" type="text/x-handlebars-template">

	<div class="activity_days_list">
		{{#if content}}
			{{{content}}}
		{{/if}}	
	</div>
	
	<div class="align-center large_top_margin large_bottom_margin" id="day_list_expander">
		<a id="activity_team_load_more" data-style="expand-right" class="{{#unless has_more}}hidden{{/unless}} activity_list_expander btn btn-small ladda-button"><span class="ladda-label">Load more activity</span></a>
	</div>

</script>

<script id="activity_individual_list_template" type="text/x-handlebars-template">

	<div class="activity_individual_list">
		{{#if content}}
			{{{content}}}
		{{else}}
			{{#if member.individual_activity_fetching}}
				{{{loadingHTML}}}
			{{else}}
				<p class="mini">{{getMemberDisplayName member}} doesn't have any activity yet.</p>
			{{/if}}
		{{/if}}
		
		{{#unless member.individual_activity_fetching}}
			<div class="align-center large_top_margin large_bottom_margin">
				<a id="activity_member_load_more" data-member-id="{{member.id}}" data-style="expand-right" class="{{#unless has_more}}hidden{{/unless}} activity_list_expander btn btn-small ladda-button"><span class="ladda-label">Load more activity</span></a>
			</div>
		{{/unless}}
	</div>

</script>


<script id="star_item_template" type="text/x-handlebars-template">
		
	{{#if_equal star.type compare="channel"}}
		{{{star 'channel' star.channel null}}}
		<strong>{{{makeChannelLinkById star.channel}}}</strong> <span class="star_meta">(channel)</span>
	{{/if_equal}}

	{{#if_equal star.type compare="group"}}
		{{{star 'group' star.channel null}}}
		<strong>{{{makeGroupLinkById star.channel}}}</strong> <span class="star_meta">(private group)</span>
	{{/if_equal}}

	{{#if_equal star.type compare="im"}}
		{{{star 'im' star.channel null}}}
		<strong>{{{makeIMLinkById star.channel}}}</strong> <span class="star_meta">(direct message conversation)</span>
	{{/if_equal}}

	{{#if_equal star.type compare="file_comment"}}
		{{#if star.file.is_deleted}}
		{{else}}
			{{{star 'file_comment' star.comment star.file}}}
			<span class="star_meta">
				{{#if_equal star.comment.user compare=current_user_id}}
					Your
				{{else}}
					<span class="{{getMemberColorClassById star.comment.user}}">{{{makeMemberPreviewLinkById star.comment.user}}}</span>'s
				{{/if_equal}}
				comment on
				{{#if_equal star.file.user compare=current_user_id}}
					your
				{{else}}
					<span class="{{getMemberColorClassById star.file.user}}">{{{makeMemberPreviewLinkById star.file.user}}}</span>'s 
				{{/if_equal}}
				{{#if_equal star.file.mode compare="snippet"}}
					snippet:
				{{/if_equal}}
				{{#if_equal star.file.mode compare="post"}}
					post:
				{{/if_equal}}
				{{#if_equal star.file.mode compare="hosted"}}
					file:
				{{/if_equal}}
				{{#if_equal star.file.mode compare="external"}}
					file:
				{{/if_equal}}
			</span>
			<a href="{{star.file.permalink}}" {{#isClient}}target="{{star.file.permalink}}"{{/isClient}} data-file-id="{{star.file.id}}" class="file_preview_link bold">{{{formatFileTitle star.file}}}</a><br />
			
			<i class="icon_quote float-left fa fa-quote-left"></i>
			
			<p class="comment small_bottom_margin">{{{formatMessage star.comment.comment}}}</p>
			
		{{/if}}
	{{/if_equal}}

</script>


<script id="channel_create_dialog_template" type="text/x-handlebars-template">	
	<div class="modal-header">
		<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
		{{#if is_edit}}			
			<h3>Rename this {{#if is_group}}group{{else}}channel{{/if}}</h3>
		{{else}}
			<h3 class="create_header">Create a channel</h3>
		{{/if}}
	</div>
	<div class="modal-body">
		{{#unless is_edit}}
			<p class="no_bottom_margin"><strong>This will create a new public channel that anyone on your team can join.</strong></p>
			{{#unless hide_private_group_option}}
				<p class="mini">If you need this conversation to be private, you should <a onclick="TS.ui.channel_create_dialog.switchToGroup();" class="bold">create a new Private Group instead</a>.</p>
			{{/unless}}
		{{/unless}}
		<p class="top_margin">
			<label for="title_input" class="inline-block">Name</label>
			<input id="channel_create_title" name="title_input" type="text" class="title_input" value="{{title}}" maxlength="{{ChannelNameMaxLength}}" />
			<span class="modal_input_note">
				Names must be lower case and cannot contain spaces or periods.
			</span>
			<span class="modal_input_note hidden alert name_taken_warning">
				That name is currently unavailable. Try Another?
			</span>
			<span class="modal_input_note hidden alert invalid_chars_warning">
				You entered some disallowed characters in the name, which we've fixed. Make sure it looks good to you, and try again!
			</span>
		</p>
		{{#unless is_edit}}
			<p>
				<label for="channel_purpose_input" class="inline-block">
					Purpose<br />
					<span class="normal">(optional)</span>
				</label>
				<textarea id="channel_purpose_input" name="channel_purpose_input" type="text" style="height: 4.5rem;" maxlength="{{ChannelPurposeMaxLength}}">{{purpose}}</textarea>
				<span class="modal_input_note">Give your {{#if is_group}}group{{else}}channel{{/if}} a purpose that describes what it will be used for.</span>
			</p>
		{{/unless}}
	</div>
	<div class="modal-footer">
		<a class="btn btn-outline dialog_cancel">Cancel</a>
		{{#if is_edit}}
			{{#if is_group}}
				<button class="btn btn-primary dialog_go ladda-button" data-style="expand-right"><span class="ladda-label">Rename Group</span></button>
			{{else}}
				<button class="btn btn-primary dialog_go ladda-button" data-style="expand-right"><span class="ladda-label">Rename Channel</span></button>
			{{/if}}
		{{else}}
			<button class="btn btn-primary dialog_go ladda-button" data-style="expand-right"><span class="ladda-label">Create Channel</span></button>
		{{/if}}
	</div>
</script>

<script id="list_browser_dialog_template" type="text/x-handlebars-template">	
	<div class="modal-header">
		<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
		{{#canUserCreateChannels}}
		<a class="new_channel_btn btn btn-primary btn-mini float-right"><i class="fa fa-plus"></i> Create New Channel</a>
		{{/canUserCreateChannels}}
		<h3>{{title}}</h3>
	</div>
	<div class="modal-body">
		
		<div id="list_controls">

			<div id="list_search_container">
				<i class="icon_search fa fa-search"></i>		
				<a class="fa fa-times-circle icon_close"></a>
				<input type="text" class="no_margin" id="list_search" name="list_search" placeholder="Search channels by name" />
			</div>
			
			<div id="list_sort_container">
				Sort by
				<select id="list_sort" name="list_sort">
					<option value="name" {{#if_equal active_sort compare='name'}}selected='selected'{{/if_equal}}>Channel Name & Membership</option>
					<option value="creator" {{#if_equal active_sort compare='creator'}}selected='selected'{{/if_equal}}>Name of Creator</option>
					<option value="created" {{#if_equal active_sort compare='created'}}selected='selected'{{/if_equal}}>Creation Date (newest first)</option>
					<option value="members_high" {{#if_equal active_sort compare='members_high'}}selected='selected'{{/if_equal}}>Members (most to fewest)</option>
					<option value="members_low" {{#if_equal active_sort compare='members_low'}}selected='selected'{{/if_equal}}>Members (fewest to most)</option>
				</select>
			</div>
		</div>
		
		<div id="list_browser">
			<div class="loading_hash_animation"><img src="/img/loading_hash_animation.gif" alt="Loading" /><br />loading...</div>
		</div>
		
	</div>
	<div class="modal-footer">
		<a target="{{newWindowName}}" href="/archives/archived" class="float-right mini"><i class="fa fa-archive"></i> View archived channels...</a>
		<a id="about_channels" class="float-left mini small_left_margin" target="{{newWindowName}}" href="/help/channels"><i class="fa fa-info-circle"></i> About channels...</a>
	</div>
</script>

<script id="list_browser_items_template" type="text/x-handlebars-template">
	{{#each items}}
		<p class="{{#if this.is_member}}is_member{{else}}joinable{{/if}}">
			<a class="item_open_link item_name" data-item-id="{{this.id}}"><span class='item_icon'>#</span>{{this.name}}</a><br />

			<span class="item_creator">
				Created 
				{{#if this.creator}}
					by {{{makeMemberPreviewLinkById this.creator}}}
				{{/if}}
				on <strong>{{toCalendarDate this.created}}</strong>
			</span>

			<span class="item_count" title="{{this.num_members}} {{pluralize this.num_members 'member' 'members'}} in this channel">
				{{#if this.is_member}}
					<i class="fa fa-check"></i>
				{{else}}
					<i class="fa fa-user"></i>
				{{/if}}
				{{this.num_members}}
			</span>
			
			{{#unless this.is_member}}
				<a class="item_open_link item_join_btn btn btn-outline btn-small" data-item-id="{{this.id}}">Join</a>
			{{/unless}}			

			{{#if this.purpose.value}}
				<span class="item_purpose">{{{formatTopicOrPurpose this.purpose.value}}}</span>
			{{/if}}							
		</p>
	{{/each}}		
</script>

<script id="list_browser_items_by_membership_template" type="text/x-handlebars-template">
	{{#if items_to_join}}
		<h4 class="small_bottom_margin">Channels you can join</h4>
		{{#each items_to_join}}
			<p class="joinable">
				<a class="item_open_link item_name" data-item-id="{{this.id}}"><span class='item_icon'>#</span>{{this.name}}</a><br />

				<span class="item_creator">
					Created 
					{{#if this.creator}}
						by {{{makeMemberPreviewLinkById this.creator}}}
					{{/if}}
					on <strong>{{toCalendarDate this.created}}</strong>
				</span>

				<span class="item_count" title="{{this.num_members}} {{pluralize this.num_members 'member' 'members'}} in this channel">
					<i class="fa fa-user"></i>
					{{this.num_members}}
				</span>
			
				<a class="item_open_link item_join_btn btn btn-outline btn-small" data-item-id="{{this.id}}">Join</a>

				{{#if this.purpose.value}}
					<span class="item_purpose">{{{formatTopicOrPurpose this.purpose.value}}}</span>
				{{/if}}							
			</p>
		{{/each}}		
	{{/if}}
	{{#if items_to_leave}}
		<h4 class="top_margin small_bottom_margin">
			{{#if items_to_join}}
				Channels you belong to
			{{else}}
				You are a member of all current channels
			{{/if}}
		</h4>
		{{#each items_to_leave}}
			<p class="is_member">
				<a class="item_open_link item_name" data-item-id="{{this.id}}"><span class='item_icon'>#</span>{{this.name}}</a><br />

				<span class="item_creator">
					Created 
					{{#if this.creator}}
						by {{{makeMemberPreviewLinkById this.creator}}}
					{{/if}}
					on <strong>{{toCalendarDate this.created}}</strong>
				</span>

				<span class="item_count" title="{{this.num_members}} {{pluralize this.num_members 'member' 'members'}} in this channel">
					<i class="fa fa-check"></i>
					{{this.num_members}}
				</span>

				{{#if this.purpose.value}}
					<span class="item_purpose">{{{formatTopicOrPurpose this.purpose.value}}}</span>
				{{/if}}							
			</p>
		{{/each}}
	{{/if}}
</script>

<script id="purpose_dialog_template" type="text/x-handlebars-template">	
	<div class="modal-header">
		<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
		<h3>{{#if model_ob.purpose.value}}Edit{{else}}Set{{/if}} {{#if is_group}}group{{else}}channel{{/if}} purpose</h3>
	</div>
	<div class="modal-body">
		<p>
			<label for="purpose_input" class="inline-block" style="min-width: 6rem; padding-right: 1rem;">
				Purpose<br />
				<span class="normal">(optional)</span>
			</label>
			<textarea id="purpose_input" name="purpose_input" type="text" style="height: 4.5rem;" maxlength="{{ChannelPurposeMaxLength}}">{{model_ob.purpose.value}}</textarea>
			<span class="modal_input_note" style="margin-left: 100px;">
				Give your {{#if is_group}}group{{else}}channel{{/if}} a purpose that describes what it will be used for.
				{{#if model_ob.purpose.creator}}
					{{#if model_ob.purpose.value}}
						<br />
						The purpose was last set by {{{makeMemberPreviewLinkById model_ob.purpose.creator}}} on {{toCalendarDate model_ob.purpose.last_set}}.
					{{/if}}
				{{/if}}
			</span>
		</p>
	</div>
	<div class="modal-footer">
		<a class="btn btn-outline dialog_cancel">Cancel</a>
		<a class="btn btn-primary dialog_go">Update Purpose</a>
	</div>
</script>

<script id="group_create_template" type="text/x-handlebars-template">	
	<p>A private group is only visible to its members, and only members of a private group can read or search its contents.</p>
	<p class="top_margin">
		<label for="title_input" class="inline-block">Name</label>
		<input id="group_create_title" name="title_input" type="text" class="title_input" value="{{title}}" maxlength="{{ChannelNameMaxLength}}" />
		<span class="modal_input_note" id="title_prompt">
			Names must be lower case and cannot contain spaces or periods.
		</span>
		<span class="modal_input_note hidden alert name_taken_warning">
			That name is currently unavailable. Try Another?
		</span>
		<span class="modal_input_note hidden alert name_missing_warning">
			Enter a title for the group please!
		</span>
		<span class="modal_input_note hidden alert no_invites_warning">
			There's no point in a group with only one member. Invite people!
		</span>
		<span class="modal_input_note hidden alert existing_groups_warning">
			To be filled in by dialog
		</span>
	</p>

	<p>
		<label for="group_purpose_input" class="inline-block">
			Purpose<br />
			<span class="normal">(optional)</span>				
		</label>
		<textarea id="group_purpose_input" name="group_purpose_input" type="text" style="height: 3.5rem;" maxlength="{{ChannelPurposeMaxLength}}">{{purpose}}</textarea>
		<span class="modal_input_note">Give your group a purpose that describes what it will be used for.</span>
	</p>
	
	<div id="create_invite_group_members_holder">
		{{#if show_ra_tip}}
			<span class="tiny_bottom_margin modal_input_note">
				Restricted account members may not appear below. Ask a team admin to invite them after you create the group.
			</span>
		{{/if}}
		<p class="no_bottom_margin" id="select_create_invite_group_members_holder">
			<label for="group_members" class="inline-block">Invite Members</label>
			<select multiple="multiple" id="select_create_invite_group_members" name="group_members" size="30">
				{{#each invite_members}}
					<option value="{{this.member.id}}" {{#if this.preselected}}selected="selected"{{/if}}>{{#if this.member.real_name}}{{this.member.real_name}} ? {{this.member.name}}{{else}}{{this.member.name}}{{/if}}</option>
				{{/each}}
			</select>		
		</p>
	</div>
</script>

<script id="prefs_dialog_template" type="text/x-handlebars-template">
	<div class="modal-header">
		<a class="btn dialog_go btn-small float-right">Done</a>
		<h3>Preferences</h3>
	</div>
	<div class="modal-body">
		
		<div class="modal-nav">
			<a id="prefs_notifications_tab" data-pane-id="prefs_notifications" data-which="notifications" class="active">Notifications</a>
			{{#if show_mac_ssb_prefs}}
				<a id="prefs_mac_ssb_tab" data-pane-id="prefs_mac_ssb" data-which="mac_ssb" class="active">Mac App</a>
			{{/if}}
			{{#if show_win_ssb_prefs}}
				<a id="prefs_win_ssb_tab" data-pane-id="prefs_win_ssb" data-which="win_ssb" class="active">Windows App</a>
			{{/if}}
			<a id="prefs_messages_tab" data-pane-id="prefs_messages" data-which="messages">Message Display</a>
			{{#feature flag="feature_sidebar_themes"}}
				<a id="prefs_themes_tab" data-pane-id="prefs_themes" data-which="themes">Sidebar Theme</a>
			{{/feature}}
			<a id="prefs_media_tab" data-pane-id="prefs_media" data-which="media">Media & Links</a>
			<a id="prefs_emoji_tab" data-pane-id="prefs_emoji" data-which="emoji">Emoji{{#if feature_chat_sounds}} & Sounds{{/if}}</a>
			<a id="prefs_search_tab" data-pane-id="prefs_search" data-which="search">Search</a>
			<a id="prefs_read_tab" data-pane-id="prefs_read" data-which="read">Read State Tracking</a>
			<a id="prefs_advanced_tab" data-pane-id="prefs_advanced" data-which="advanced">Advanced Options</a>
			{{#tinyspeck}}
				<a id="prefs_labs_tab" data-pane-id="prefs_labs" data-which="labs">Tiny Speck</a>
			{{/tinyspeck}}
		</div>
		
		{{!---------- NOTIFICATIONS ----------}}
		<div id="prefs_notifications" class="dialog_tab_pane">
			
			<div class="growls_stuff" id="growls_permission_div">
				<p class="bold no_bottom_margin"><span class="desktop_notifications_title">Desktop Notifications are currently disabled</span></p>
				<p class="small_bottom_margin">We strongly recommend enabling them.</p>
				<p class="large_bottom_margin"><a class="btn btn-success" id="growls_permission_link" onclick="TS.ui.prefs_dialog.onGrowlsPermissionLinkClick(); return false;"><i class="fa fa-bell small_right_margin"></i> Enable desktop notifications</a></p>
			</div>
			<div class="growls_stuff" id="growls_instructions_div">
				<p class="bold small_bottom_margin"><span class="desktop_notifications_title">Desktop Notifications</span></p>
				<p class="alert">Your browser should now be presenting you with the option to enable notifications, probably at the top or bottom of this window. Click <strong>Enable</strong> or <strong>Allow</strong> or <strong>Yes</strong> or <strong>OK</strong> or whatever the right button is!</p>
			</div>
			<div class="growls_stuff" id="growls_disallowed_div">
				<p class="bold small_bottom_margin"><span class="desktop_notifications_title">Desktop Notifications are currently disabled</span></p>
				<p class="moscow_red_dark italic small_bottom_margin">You've disallowed notifications in your browser. You'll need to open your browser preferences to change that.</p>
				<p class="mini">You can set <a href="/account/notifications" target="_blank">notification preferences for email & mobile here</a>.</p>
			</div>
			<div class="growls_stuff" id="growls_impossible_div">
				<p class="bold small_bottom_margin"><span class="desktop_notifications_title">Desktop Notifications are disabled</span></p>
				<p class=""><i class="fa fa-exclamation-triangle"></i> Your browser does not support desktop notifications. <a href="/apps" target="_blank">Try one of our apps?</a></p>
				<p class="mini">You can set <a href="/account/notifications" target="_blank">notification preferences for email & mobile here</a>.</p>
			</div>
			<div class="growls_stuff" id="growls_allowed_div">

				<p class="bold small_bottom_margin">
					<span class="desktop_notifications_title">Desktop Notifications</span>
					<span class="mini helvetica normal left_margin"><a id="growls_test" onclick="TS.ui.playSound('new_message'); TS.ui.growls.show('Slack Notification', 'Hey! It works.', null, null, true, { id: 'test_notification' }); return false;"><i class="fa fa-bell-o"></i> Send test notification</a></span>						
				</p>
				<p class="left_margin small_bottom_margin">
					<label class="radio no_margin">
						<input name="notifications_rd" type="radio" class="small_right_margin" value="all" /> For activity of any kind
					</label>
					<label class="radio no_margin">
						<input name="notifications_rd" type="radio" class="small_right_margin" value="mentions" /> Only for Highlight Words and direct messages
					</label>
					<label class="radio no_margin">
						<input name="notifications_rd" type="radio" class="small_right_margin" value="never" /> Never
					</label>
				</p>
				<p id="no_non_default" class="mini bottom_margin">You can override this preference on a case-by-case basis for channels and groups from the channel or group menu. You can also set <a href="/account/notifications" target="_blank">notification preferences for email & mobile</a>.</p>
				<!--
				<div id="" class="non_default hidden mini">The following channels and groups have different notification settings:<div id="non_default_html" class="small_top_margin"></div></div>
				<p class="non_default mini bottom_margin small_top_margin">You can also set <a href="/account/notifications" target="_blank">notification preferences for email & mobile</a>.</p>
				-->
				<p class="non_default hidden mini">Some of your channels and/or groups have <strong id="non_default_tip_link" class="cursor_pointer">different notification settings</strong>. You can also set <a href="/account/notifications" target="_blank">notification preferences for email & mobile</a>.</p>
				
			</div>
			
			<p class="bold no_bottom_margin large_top_margin">Highlight Words</p>
			<p class="small_bottom_margin">To be notified when someone mentions a word or phrase, add it here. You can separate words or phrases with commas. Highlight Words are not case sensitive.</p>			
			<p class="small_bottom_margin"><textarea id="highlight_words_input" class="no_bottom_margin full_width" placeholder='Your screen name "{{member.name}}" is automatically a Highlight Word'>{{highlight_words}}</textarea></p>

			<p class="bold no_bottom_margin large_top_margin">
				Sounds <span class="normal left_margin"> <label class="checkbox normal inline-block auto_width no_min_width" style="padding-right: 0.25rem;"><input id="mute_sounds_cb" checked="checked" type="checkbox" style="margin-top: 3px;" /> Mute all sounds</label></span>
			</p>
			<p class="no_bottom_margin">
				Choose a notification sound: 
				<select id="new_msg_snd_select" class="small_left_margin">
					{{#foreach new_message_sounds}}
						<option value="{{value.value}}">{{value.label}}</option>
					{{/foreach}}
				</select>

				<span id="soundpreview" class="mini left_margin">
					<a><i class="fa fa-volume-up"></i> Preview</a>
				</span>
			</p>


		</div>
				
		{{!---------- MESSAGE DISPLAY ----------}}
		<div id="prefs_messages" class="dialog_tab_pane">

			<p class="bold no_bottom_margin">Message Theme</p>
			<p class="small_bottom_margin">The theme you choose defines the look and feel of messages in Slack.</p>
			<p class="left_margin">
				<label class="radio small_bottom_margin">
					<input name="messages_theme_select" type="radio" class="small_right_margin" value="light_with_avatars" /> Clean: <span class='normal'>Clear, friendly, and focused.</span>
				</label>
				<label class="radio no_margin">
					<input name="messages_theme_select" type="radio" class="small_right_margin" value="dense" /> Compact: <span class='normal'>The most messages you can fit on screen at once.</span>
				</label>
			</p>

			<p class="bold no_bottom_margin large_top_margin">Message Options</p>
			<p class="small_bottom_margin">Customize how Slack shows activity, names, and times.</p>
			<p class="left_margin small_bottom_margin">
				<label class="checkbox no_margin">
					<input id="show_typing_cb" checked="checked" type="checkbox" class="small_right_margin" /> Display information about who is currently typing a message
				</label>
			</p>
			<p class="left_margin small_bottom_margin">
				<label class="checkbox no_margin">
					<input id="display_real_names_override_cb" checked="checked" type="checkbox" class="small_right_margin" /> Display real names <span id="display_real_names_default">(team default)</span> instead of usernames <span id="display_usernames_default">(team default)</span>
				</label>
			</p>
			<p class="left_margin">
				<label class="checkbox no_margin">
					<input id="time24_cb" checked="checked" type="checkbox" class="small_right_margin" /> Show times with 24-hour clock <span class="normal">(16:00 rather than 4:00PM)</span>
				</label>
			</p>

		</div>
		
		{{!---------- SIDEBAR THEME ----------}}
		{{#feature flag="feature_sidebar_themes"}}
			<div id="prefs_themes" class="dialog_tab_pane">
				<p class="bold no_bottom_margin">Sidebar Theme</p>				
				<p class="no_bottom_margin">Set a sidebar theme for yourself on the <strong>{{team_name}}</strong> team. Only you will see this.</p>
				<label class="radio theme_label">
					<img src="/img/themes/default-thumb.png" class="theme_thumb" /><br />
					<input name="sidebar_theme_rd" type="radio" value="default_theme" /> Aubergine
				</label>
				<label class="radio theme_label">
					<img src="/img/themes/hoth-thumb.png" class="theme_thumb" /><br />
					<input name="sidebar_theme_rd" type="radio" value="hoth_theme" /> Hoth
				</label>
				<label class="radio theme_label">
					<img src="/img/themes/cotton-thumb.png" class="theme_thumb" /><br />
					<input name="sidebar_theme_rd" type="radio" value="cotton_theme" /> Wameln
				</label>
				<label class="radio theme_label">
					<img src="/img/themes/eco-thumb.png" class="theme_thumb" /><br />
					<input name="sidebar_theme_rd" type="radio" value="eco_theme" /> Juice Bar
				</label>
				<label class="radio theme_label">
					<img src="/img/themes/ocean-thumb.png" class="theme_thumb" /><br />
					<input name="sidebar_theme_rd" type="radio" value="ocean_theme" /> Ochin
				</label>
				<label class="radio theme_label">
					<img src="/img/themes/workhard-thumb.png" class="theme_thumb" /><br />
					<input name="sidebar_theme_rd" type="radio" value="workhard_theme" /> Work Hard
				</label>

				<p id="customize_theme_info" class="clear-both mini {{#if show_customization_ui}}hidden{{/if}}"><i class="fa fa-bolt small_right_margin"></i> Feeling adventurous? You can <a id="customize_theme_toggle" class="bold">customize your theme and share it with others</a>.

				<div id="prefs_themes_customize" class="clear-both {{#unless show_customization_ui}}hidden{{/unless}}">
					<p class="bold clear-both small_bottom_margin">Custom Theme</p>

					<div class="input-prepend">
						<span class="add-on color_swatch" data-theme-element='column_bg' data-hex='{{theme.column_bg}}' style="background-color: {{theme.column_bg}};"></span>
						<input type="text" name="color_column_bg_hex" class="color_hex monospace" value="{{theme.column_bg}}" maxlength="7" /><br />
						<span class="input_note">Column BG</span>
					</div>

					<div class="input-prepend">
						<span class="add-on color_swatch" data-theme-element='menu_bg' data-hex='{{theme.menu_bg}}' style="background-color: {{theme.menu_bg}};"></span>
						<input type="text" name="color_menu_bg_hex" class="color_hex monospace" value="{{theme.menu_bg}}" maxlength="7" /><br />
						<span class="input_note">Menu BG</span>
					</div>

					<div class="input-prepend">
						<span class="add-on color_swatch" data-theme-element='active_item' data-hex='{{theme.active_item}}' style="background-color: {{theme.active_item}};"></span>
						<input type="text" name="color_active_item_hex" class="color_hex monospace" value="{{theme.active_item}}" maxlength="7" /><br />
						<span class="input_note">Active Item</span>
					</div>

					<div class="input-prepend">
						<span class="add-on color_swatch" data-theme-element='active_item_text' data-hex='{{theme.active_item_text}}' style="background-color: {{theme.active_item_text}};"></span>
						<input type="text" name="color_active_item_text_hex" class="color_hex monospace" value="{{theme.active_item_text}}" maxlength="7" /><br />
						<span class="input_note">Active Item Text</span>
					</div>

					<div class="input-prepend">
						<span class="add-on color_swatch" data-theme-element='hover_item' data-hex='{{theme.hover_item}}' style="background-color: {{theme.hover_item}};"></span>
						<input type="text" name="color_hover_item_hex" class="color_hex monospace" value="{{theme.hover_item}}" maxlength="7" /><br />
						<span class="input_note">Hover Item</span>
					</div>

					<div class="input-prepend">
						<span class="add-on color_swatch" data-theme-element='text_color' data-hex='{{theme.text_color}}' style="background-color: {{theme.text_color}};"></span>
						<input type="text" name="color_text_color_hex" class="color_hex monospace" value="{{theme.text_color}}" maxlength="7" /><br />
						<span class="input_note">Text Color</span>
					</div>

					<div class="input-prepend">
						<span class="add-on color_swatch" data-theme-element='active_presence' data-hex='{{theme.active_presence}}' style="background-color: {{theme.active_presence}};"></span>
						<input type="text" name="color_active_presence_hex" class="color_hex monospace" value="{{theme.active_presence}}" maxlength="7" /><br />
						<span class="input_note">Active Presence</span>
					</div>

					<div class="input-prepend">
						<span class="add-on color_swatch" data-theme-element='badge' data-hex='{{theme.badge}}' style="background-color: {{theme.badge}};"></span>
						<input type="text" name="color_badge_hex" class="color_hex monospace" value="{{theme.badge}}" maxlength="7" /><br />
						<span class="input_note">Mention Badge</span>
					</div>

					<input type="text" name="sidebar_theme_custom" id="sidebar_theme_custom" class="monospace subtle_silver top_margin" />
					<p class="input_note no_bottom_margin">Copy and paste these values to share your custom theme with others.</p>
				</div>

			</div>
		{{/feature}}


		{{!---------- MEDIA & LINKS ----------}}
		<div id="prefs_media" class="dialog_tab_pane">

			<p class="bold no_bottom_margin">Inline Media Display</p>
			<p class="small_bottom_margin">Expand references to images, video, and audio to preview them inline:</p>
			<p class="small_bottom_margin left_margin">
				<label class="checkbox no_margin">
					<input id="expand_internal_inline_imgs_cb" checked="checked" type="checkbox" class="small_right_margin" /> For files on Slack
				</label>
			</p>
			<p class="left_margin small_bottom_margin">
				<label class="checkbox no_margin">
					<input id="expand_inline_imgs_cb" checked="checked" type="checkbox" class="small_right_margin" /> For links to media from external sources
				</label>
			</p>
			<p class="large_left_margin" id="dont_obey_inline_img_limit_p">
				<label class="checkbox no_margin">
					<input id="dont_obey_inline_img_limit_cb" checked="checked" type="checkbox" class="small_right_margin" /> Even if it is an image larger than {{convertFilesize inline_img_byte_limit}}
				</label>
			</p>
			
			<p class="bold small_bottom_margin large_top_margin">Link Expansion</p>
			<p class="no_bottom_margin left_margin">
				<label class="checkbox no_margin">
					<input id="expand_non_media_attachments_cb" checked="checked" type="checkbox" class="small_right_margin" /> Expand website links to show a preview of the content, when available.
				</label>
			</p>

		</div>

		{{!---------- EMOJI & SOUNDS----------}}
		<div id="prefs_emoji" class="dialog_tab_pane">

			<p class="bold no_bottom_margin">Emoji Style</p>
			<p class="small_bottom_margin">How do you like your emoji?</p>
			<p class="left_margin">
				<label class="radio small_bottom_margin">
					<input name="emoji_mode_select" type="radio" class="small_right_margin" value="default" /> 
					Apple/International Style <img src="/img/emoji_apple_style.png" style="margin: -5px 0 0 12px;" />
				</label>
				<label class="radio small_bottom_margin">
					<input name="emoji_mode_select" type="radio" class="small_right_margin" value="google" /> 
					Google Hangouts Style <img src="/img/emoji_google_style.png" style="margin: -5px 0 0 28px" />
				</label>
				<label class="radio small_bottom_margin">
					<input name="emoji_mode_select" type="radio" class="small_right_margin" value="twitter" /> 
					Twitter Style <img src="/img/emoji_twitter_style.png" style="margin: -5px 0 0 91px" />
				</label>
				<label class="radio no_margin">
					<input name="emoji_mode_select" type="radio" class="small_right_margin" value="as_text" /> None: <span class="normal">plain text only</span></span>
				</label>
			</p>
			
			<p class="bold small_bottom_margin large_top_margin">Emoticons</p>
			<p class="left_margin">
				<label class="checkbox no_margin">
					<input id="convert_emoticons_cb" checked="checked" type="checkbox" class="small_right_margin" /> Convert my typed emoticons to emoji, so &nbsp;:D&nbsp; becomes {{{emojiGraphicReplace ":smile:"}}}
				</label>
			</p>

			{{#if feature_chat_sounds}}
			<p class="bold small_bottom_margin large_top_margin">Chat Sounds</p>
			<p class="left_margin">
				<label class="checkbox no_margin">
					<input id="autoplay_chat_sounds_cb" checked="checked" type="checkbox" class="small_right_margin" /> Automatically play sounds that are used in chat
				</label>
			</p>
			{{/if}}

		</div>

		{{!---------- OS X ----------}}
		{{#if show_mac_ssb_prefs}}
			<div id="prefs_mac_ssb" class="dialog_tab_pane">
			
				<p class="bold no_bottom_margin">Mac App Settings</p>
				<p class="small_bottom_margin">These settings define how the dock icon behaves in the OS X app.</p>
				<p class="small_bottom_margin">
					<label class="checkbox no_margin left_margin">
						<input id="mac_ssb_bullet_cb" checked="checked" type="checkbox" class="small_right_margin" /> Use a (?) symbol on the app icon to indicate when there is unread activity
					</label>
				</p>
				<p>
					<label class="checkbox small_bottom_margin left_margin">
						<input id="mac_ssb_bounce_cb" checked="checked" type="checkbox" class="small_right_margin" /> Bounce the app dock icon when showing a notification
					</label>
					<label class="checkbox no_margin large_left_margin">
						<input id="mac_ssb_bounce_short_cb" checked="checked" type="checkbox" class="small_right_margin" /> Bounce it just once
					</label>
				</p>

			</div>
		{{/if}}

		{{!---------- WIN ----------}}
		{{#if show_win_ssb_prefs}}
			<div id="prefs_win_ssb" class="dialog_tab_pane">
			
				<p class="bold no_bottom_margin">Windows App Settings</p>
				<p class="small_bottom_margin">These settings define how the dock icon behaves in the Windows app.</p>
				<p class="small_bottom_margin">
					<label class="checkbox no_margin left_margin">
						<input id="win_ssb_bullet_cb" checked="checked" type="checkbox" class="small_right_margin" /> Use a (?) symbol on the app icon to indicate when there is unread activity
					</label>
				</p>

			</div>
		{{/if}}

		{{!---------- SEARCH ----------}}
		<div id="prefs_search" class="dialog_tab_pane">

			<p class="bold no_bottom_margin">Search Exclusion</p>
			<p>By default, channels you do not have open are excluded from your search results. (You can change this under <strong>+ More Options</strong> any time you do a search.) Add channels to the list below that you would <strong>always</strong> like to exclude from search.</p>
			<p class="small_bottom_margin bold">Always hide results from these channels when searching messages:</p>
			<p class="small_bottom_margin">
				<select multiple="multiple" id="search_channel_exclusion" size="30">
					<optgroup label="Active Channels">
						{{#each active_channels}}
							<option value="{{this.channel.id}}"{{#if this.search_channel_exclusion}} selected{{/if}}>#{{this.channel.name}}</option>
						{{/each}}
					</optgroup>
					<optgroup label="Archived Channels">
						{{#each archived_channels}}
							<option value="{{this.channel.id}}"{{#if this.search_channel_exclusion}} selected{{/if}}>#{{this.channel.name}}</option>
						{{/each}}
					</optgroup>
				</select>
			</p>

		</div>

		{{!---------- READ MARKING ----------}}
		<div id="prefs_read" class="dialog_tab_pane">

			<p class="bold no_bottom_margin">Marking Messages as Read</p>
			<p>By default, Slack marks messages as read as soon as you view the channel, DM, or group. You can adjust this behavior if you like:</p>
			<p class="small_left_margin large_bottom_margin">
				<label class="radio no_margin small_bottom_margin">
					<input name="read_rd" type="radio" class="small_right_margin" value="immediate_scroll" /> Default: automatically scroll me to the oldest unread message and mark the channel as having been read.
				</label>
				<label class="radio no_margin small_bottom_margin">
					<input name="read_rd" type="radio" class="small_right_margin" value="immediate" /> Do not scroll me to the oldest unread message, but still mark the messages as having been read when I switch.
				</label>
				<label class="radio no_margin small_bottom_margin">
					<input name="read_rd" type="radio" class="small_right_margin" value="default" /> Do not scroll me or automatically mark messages as read  wait until I've seen the oldest unread message.
				</label>
			</p>
			
			<p id="read_tips"><b>Tips</b>: :raising_hand: Need to come back to something? You can set your own unread-point by holding down [opt/alt] and clicking on a message. :information_desk_person: You can also mark a channel, DM or group as read by hitting the Esc key while viewing it. :ok_woman: Holding down shift while pressing the Esc key will mark everything in Slack as read (use sparingly).</p>

		</div>
		
		{{!---------- ADVANCED OPTIONS ----------}}
		<div id="prefs_advanced" class="dialog_tab_pane">

			<p class="bold no_bottom_margin">Input Options</p>
			<p class="tiny_bottom_margin">
				<label class="checkbox no_margin">
					<input id="webapp_spellcheck_cb" checked="checked" type="checkbox" class="small_right_margin" /> Enable spellchecking on input fields.
				</label>
			</p>
			<p class="tiny_bottom_margin">
				<label class="checkbox no_margin">
					<input id="require_at_cb" checked="checked" type="checkbox" class="small_right_margin" /> Only show autocomplete for people when the '@' character is used.
				</label>
			</p>
			<p class="tiny_bottom_margin">
				<label class="checkbox no_margin">
					<input id="enter_is_special_in_tbt_cb" checked="checked" type="checkbox" class="small_right_margin" /> When typing code with ```, ENTER should not send the message. <span id="enter_is_special_in_tbt_tip" title="Unless you hold down SHIFT">*</span>
				</label>
			</p>
			<p style="margin-bottom: 1rem;">
				<label class="checkbox no_margin">
					<input id="arrow_history_cb" checked="checked" type="checkbox" class="small_right_margin" /> Up/Down arrows in input cycle through your typed history. <span class="normal">With this checked, you'll have to use {{#isMac}}Cmd{{else}}Ctrl{{/isMac}} + <i class="fa fa-long-arrow-up"></i>&nbsp;&nbsp;to edit your last message.</span>
				</label>
			</p>
			
			<p class="bold no_bottom_margin">Channel List</p>
			<p style="margin-bottom: 1rem;">
				<select id="sidebar_behavior_select" class="small_left_margin" style="width:500px">
					<option value="">Show all channels, DMs and private groups you have open (default)</option>
					{{#tinyspeck}}<option value="shrink_left_column">(TS only) Show all channels, DMs and private groups you have open, but real tiny</option>{{/tinyspeck}}
					<option value="hide_read_channels">Hide any channels, DMs or groups which have no unread activity</option>
					<option value="hide_read_channels_unless_starred">Hide any channels, etc., which have no unread activity, unless they are starred</option>
				</select>
			</p>
			
			<p class="bold no_bottom_margin">Other Options</p>
			<p class="tiny_bottom_margin">
				<label class="checkbox no_margin">
					<input id="pagekeys_handled_cb" checked="checked" type="checkbox" class="small_right_margin" /> Page up/down, Home, and End keys always scroll messages.
				</label>
			</p>
			{{#isOurApp}}{{else}}
			<p class="tiny_bottom_margin">
				<label class="checkbox no_margin">
					<input id="f_key_search_cb" checked="checked" type="checkbox" class="small_right_margin" /> {{#isMac}}Cmd{{else}}Ctrl{{/isMac}} + F starts a Slack search. <span class="normal">This overrides normal browser search behavior.</span>
				</label>
			</p>
			{{/isOurApp}}
			<p style="margin-bottom: 1rem;">
				<label class="checkbox no_margin">
					<input id="surprise_me" type="checkbox" class="small_right_margin" /> Surprise me!
				</label>
			</p>
			
			<div id="surprise" style="display: none;">
				<img id="emo_bear" src="" style="width: 279px; height: 243;"/><br />
				<h1 class="candy_red">Surprise!</h1>
			</div>
			
			<p class="normal">You might also want to change some <a onclick="TS.ui.prefs_dialog.switchToDebuggingPrefs()" class="bold">debugging preferences</a>.
			
		</div>
		
		

	</div>
</script>

<script id="help_dialog_template" type="text/x-handlebars-template">
	<div class="modal-header with_tabs">
		<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
		<h3 class="no_tabs_title hidden">Help</h3>
		<div class="dialog_tabs {{#isChrome}}chrome_fix{{/isChrome}}">
			<a id="help_docs_tab" data-pane-id="help_docs" data-which="docs">Help Topics</a>
			<a id="help_issues_tab" data-pane-id="help_issues" data-which="issues">Help Requests</a>
		</div>
	</div>
	<div class="modal-body">
		<div id="help_docs" class="dialog_tab_pane">
			<div id="help_docs_scroller">
				<p id="no_open_issues" class="hidden">
					No open requests. <a href="/help" target="_blank" class="bold">View your help request history</a>.
				</p>
				
				<p id="unread_issues" class="hidden">
					<span id="unread_issues_many" class="hidden">
						<a href="/help" target="_blank" class="bold"><span class="badge candy_red_bg" id="unread_issues_count_txt"></span>&nbsp; You have new replies to your help requests.</a>
					</span>
					<span id="unread_issues_singular" class="hidden">
						<a href="/help" target="_blank" class="bold"><span class="badge candy_red_bg">1</span>&nbsp; You have a new reply to your help request.</a>
					</span>
				</p>
				
				<p id="open_issues" class="hidden bottom_margin">
					<span id="open_issues_many" class="hidden">
						<a href="/help" target="_blank" class="bold"><span class="badge havana_blue_bg" id="open_issues_count_txt"></span>&nbsp; You have open help requests.</a>
					</span>
					<span id="open_issues_singular" class="hidden">
						<a href="/help" target="_blank" class="bold"><span class="badge havana_blue_bg">1</span>&nbsp; You have an open help request.</a>
					</span>
				</p>
				
				<hr id="help_divider" />
				
				<div id="docs_list">
					<p>Here's a quick list of popular help topics:
					<ul class="bold">
						<li><a href="https://slack.zendesk.com/hc/en-us/articles/201925108" target="_black">Understanding Channels, Private Groups & Direct Messages</a></li>
						<li><a href="https://slack.zendesk.com/hc/en-us/articles/202035138" target="_black">Any plans to add a ______________ integration?</a></li>						
						<li><a href="https://slack.zendesk.com/hc/en-us/articles/201895138" target="_black">Notifications Overview</a></li>
						<li><a href="https://slack.zendesk.com/hc/en-us/articles/201405046" target="_black">Can I belong to more than one Slack team?</a></li>
						<li><a href="https://slack.zendesk.com/hc/en-us/articles/201723133" target="_black">Billing FAQ</a></li>
					</ul>
					
					<p><a onclick="TS.help_dialog.cancel(); TS.ui.shortcuts_dialog.start();" class="bold">View all Keyboard Shortcuts</a>. Or, <a href="https://slack.zendesk.com/hc" target="_blank" class="bold">see all help topics...</a></p>

					<form action="https://slack.zendesk.com/hc/en-us/search" target="_blank" onsubmit="if (!$('#zd_search_input').val()) return false;setTimeout(function(){$('#zd_search_input').val('')}, 100)">
						<input type="text" id="zd_search_input" name="query" placeholder="Search all help topics..."/>
						<button type="submit" class="btn btn-small">Search</button>
					</form>

					<p id="cant_find" style="font-size: 1.2rem;" class="small_bottom_margin">
						Don't see what you're looking for? <a class="bold" href="/help/requests/new" target="_blank">Send us a help request.</a>
					</p>
				</div>
			</div>
		</div>
		
		<div id="help_issues" class="dialog_tab_pane">
			<div id="help_issues_scroller">
				<div style="margin-right:1rem">
					<div id="help_issues_list">
						{{#if issue_list_html}}
							{{{issue_list_html}}}
						{{else}}
							<div id="help_issues_list_empty">
								<i class="fa fa-check-circle"></i> <strong>You have no current requests.</strong><br />
								If you're having problems, you can <a href="/help/requests/new" target="{{newWindowName}} class="bold">open a new request</a>. 
							</div>
						{{/if}}
					</div>
					
					<div id="help_issue_div">
					
					</div>
					
					<div id="help_issue_new_form_div">
						<p class="">
							We want your input: question, bug reports, complaints, praise, feature requests C every bit helps. Let us know what we can do to improve Slack.
						</p>
						<p class="small_bottom_margin">
							<input type="text" id="issue_new_title" maxlength="{{max_title_chars}}" style="width: 99.5%;" placeholder="Subject (optional)">
						</p>
						<p>
							<textarea id="issue_new_text" wrap="virtual" style="width: 99.5%; height:230px"></textarea>
							<span class="mini float-left cloud_silver">cmd+enter to submit</span>
						</p>
					</div>
					
					<div id="help_issue_reply_form_div">
						<p class="">
							Reply to <a id="issue_reply_title"></a>
						</p>
						<p>
							<textarea id="issue_reply_text" wrap="virtual" style="width: 99.5%; height:230px"></textarea>
							<span class="mini float-left cloud_silver">cmd+enter to submit</span>
						</p>
						<div id="issue_reply_footer" class="large_top_margin"></div>
					</div>
				
				</div>
			</div>
			<div id="issues_overlaid_throbber" class="loading_hash_animation"><img src="/img/loading_hash_animation.gif" alt="Loading" /><br />working...</div>
		</div>

	</div>
	<div class="modal-footer hidden">

		<div id="help_issues_list_btns">
			{{#if more_url}}<a id="previous_issues" class="float-left mini small_left_margin" href="{{more_url}}" target="_blank"><i class="fa fa-info-circle"></i>Previous issues...</a>{{/if}}
			<a id="new_issue_btn" class="btn disable_when_working dialog_go">Open New Request</a>
		</div>
		<div id="help_issue_btns">
			<a id="issue_resolved_btn" class="btn disable_when_working btn-success float-left small_left_margin">Mark as Resolved</a>
			<a id="issue_back_btn" class="btn btn-outline">Back</a>
			<a id="issue_reply_btn" class="btn disable_when_working dialog_go">Add Reply</a>
		</div>
		<div id="help_issue_new_form_btns">
			<a id="new_issue_cancel_btn" class="btn disable_when_working btn-outline">Cancel</a>
			<a id="new_issue_submit_btn" class="btn disable_when_working dialog_go">Submit Request</a>
		</div>
		<div id="help_issue_reply_form_btns">
			<a id="issue_reply_cancel_btn" class="btn disable_when_working btn-outline">Cancel</a>
			<a id="issue_reply_submit_btn" class="btn disable_when_working dialog_go">Submit Reply</a>
		</div>

	</div>
</script>

<script id="channel_prefs_dialog_template" type="text/x-handlebars-template">
	<div class="modal-header">
		<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
		<h3>{{#if_equal c_or_g compare="channel"}}Channel{{else}}Group{{/if_equal}} Notification Preferences</h3>
	</div>
	<div class="modal-body">
		
		<div id="notifications_working" class="hidden">
			<p class="bold indifferent_grey">
				Show desktop notifications for messages in <strong>{{display_name}}</strong>:
			</p>
			<p class="left_margin small_bottom_margin">
				<label class="radio no_margin">
					<input name="channel_loud_rd" type="radio" class="small_right_margin" value="everything" /> For all activity <span id="all_everything_default">(default)</span>
				</label>
				<label class="radio no_margin">
					<input name="channel_loud_rd" type="radio" class="small_right_margin" value="mentions" /> Only when mentioned or one of my Highlight Words is used <span id="all_mentions_default">(default)</span>
				</label>
		
				{{#feature flag="feature_notif_overhaul"}}
					<span id="suppressed_span" class="large_left_margin inline-block">
					<label class="checkbox no_margin" id="suppressed_label">
						<input id="suppressed_cb" checked="checked" type="checkbox" class="small_right_margin" /> Except for {{#if_equal c_or_g compare="channel"}}@channel{{else}}@group{{/if_equal}} mentions <span id="suppressed_disabled_explain" class="normal mini subtle_silver">(disabled due to <strong id="suppressed_disabled_explain_tip_link" class="cursor_pointer">team settings</strong>)</span>
					</label>
					</span>
				{{/feature}}

				<label class="radio no_margin">
					<input name="channel_loud_rd" type="radio" class="small_right_margin" value="nothing" /> Never <span id="all_nothing_default">(default)</span>
				</label>
			</p>
			
			<p class="mini">
				You can change your default desktop notifications settings in the <a onclick="TS.ui.channel_prefs_dialog.showMainPrefs('notifications')" class="cursor_pointer bold">Preferences Dialog</a>.
			</p>
		</div>
		
		<div id="notifications_not_working" class="hidden">
			<p class="bold indifferent_grey">
				Desktop notifications for <strong>{{display_name}}</strong>:
			</p>
			<p class="mini">
				<span id="notifications_not_yet_allowed" class="hidden"><i class="fa fa-exclamation-triangle"></i> You have not yet allowed desktop notifications. Please open the <a onclick="TS.ui.channel_prefs_dialog.showMainPrefs('notifications')" class="cursor_pointer bold">Preferences Dialog</a> and follow the instructions to set them up.<br></span>
				<span id="notifications_not_enabled" class="hidden"><i class="fa fa-exclamation-triangle"></i> You've disabled desktop notifications. Open the <a onclick="TS.ui.channel_prefs_dialog.showMainPrefs('notifications')" class="cursor_pointer bold">Preferences Dialog</a> to change that.<br></span>
				<span id="notifications_not_allowed" class="hidden"><i class="fa fa-exclamation-triangle"></i> You've disallowed notifications in your browser. You'll need to open your browser preferences to change that.<br></span>
				<span id="notifications_impossible" class="hidden"><i class="fa fa-exclamation-triangle"></i> Your browser does not support desktop notifications. <a href="/apps" target="_blank">Try one of our apps?</a><br></span>
			</p>
		</div>
		
		
		<div>
			<p class="bold indifferent_grey">
				Send mobile push notifications for messages in <strong>{{display_name}}</strong>:
			</p>
			<p class="left_margin small_bottom_margin">
				<label class="radio no_margin">
					<input name="channel_push_loud_rd" type="radio" class="small_right_margin" value="everything" /> For all activity <span id="all_push_everything_default">(default)</span>
				</label>
				<label class="radio no_margin">
					<input name="channel_push_loud_rd" type="radio" class="small_right_margin" value="mentions" /> Only when mentioned or one of my Highlight Words is used <span id="all_push_mentions_default">(default)</span>
				</label>
		
				{{#feature flag="feature_notif_overhaul"}}
					<span id="push_suppressed_span" class="large_left_margin inline-block">
					<label class="checkbox no_margin" id="push_suppressed_label">
						<input id="push_suppressed_cb" checked="checked" type="checkbox" class="small_right_margin" /> Except for {{#if_equal c_or_g compare="channel"}}@channel{{else}}@group{{/if_equal}} mentions <span id="push_suppressed_disabled_explain" class="normal mini subtle_silver">(disabled due to <strong id="push_suppressed_disabled_explain_tip_link" class="cursor_pointer">team settings</strong>)</span>
					</label>
					</span>
				{{/feature}}
				<label class="radio no_margin">
					<input name="channel_push_loud_rd" type="radio" class="small_right_margin" value="nothing" /> Never <span id="all_push_nothing_default">(default)</span>
				</label>
			</p>
				
			<p class="mini">
				You can change your default push notifications settings in your <a href="/account/notifications" target="_blank" class=" bold">Account Preferences</a>.
			</p>
		</div>
		
	</div>
	<div class="modal-footer">
		<a class="btn dialog_go">Done</a>
	</div>
</script>

<script id="debug_prefs_dialog_template" type="text/x-handlebars-template">
	<div class="modal-header">
		<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
		<h3>Debugging Preferences</h3>
	</div>
	<div class="modal-body">
		<p>You'll need to reload after changing these preferences.</p>
	
		<p class="small_bottom_margin">
			<label class="checkbox no_margin">
			<input id="ls_disabled_cb" type="checkbox" class="small_right_margin" /> Disable Local Storage. <span class="normal">This will disable Slack from storing data on your computer, and can be used to debug lagginess in the Slack UI.</span>
		</p>
		
		<p class="small_bottom_margin">
			<label class="checkbox no_margin">
				<input id="ss_emojis_cb" type="checkbox" class="small_right_margin" /> Disable Emoji Spritesheets. <span class="normal">This will make loading emoji slower, but it might help if you are experiencing slowness in the Slack UI.</span>
			</label>
		</p>		
	</div>
	<div class="modal-footer">
		<a class="btn dialog_go">Done</a>
	</div>
</script>

<script id="file_upload_dialog_template" type="text/x-handlebars-template">	
	<div class="modal-header">
		<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
		<h3>Upload a file? <span class="file_count"></span></h3>
	</div>
	<div class="modal-body">
		
		{{#if over_storage_limit}}
			<p class="alert alert-warning align-center" style="font-size: 0.9rem; line-height: 1.25rem;">Your team is over its storage limit.<br /> Please <a href="/pricing" target="{{newWindowName}}" class="bold underline">upgrade to a paid tier</a> or <a href="/files" target="{{newWindowName}}" class="bold underline">delete some larger files</a>.</p>
		{{/if}}
		
		<div id="upload_image_preview" class="hidden bottom_margin">
			<img src="" />
		</div>
		
		<p>
			<label for="upload_file_title" class="inline-block">Title</label>
			<input id="upload_file_title" name="upload_file_title" type="text" class="title_input" value="{{title}}" />
			<span class="modal_input_note">
				Titles are the easiest ways to search for files: it pays to be descriptive.
			</span>
			<input id="upload_file_name" name="upload_file_name" type="hidden" {{#if has_name}}disabled="disabled"{{else}}{{/if}} class="filename_input" value="{{filename}}" />
		</p>
		
		{{{sharing_html}}}
		
	</div>
	<div class="modal-footer">
		{{#if more_in_queue}}<a class="btn btn-outline dialog_cancel_all">Cancel All</a>{{/if}}
		<a class="btn btn-outline dialog_cancel">Cancel</a>
		<a class="btn btn-primary dialog_go">Upload</a>
	</div>
</script>

<script id="share_dialog_template" type="text/x-handlebars-template">	
	<div class="modal-header">
		<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
		<h3>
			Share 
			{{#if_equal type compare='file'}}File{{/if_equal}}
			{{#if_equal type compare='file_snippet'}}Snippet{{/if_equal}}
			{{#if_equal type compare='file_post'}}Post{{/if_equal}}
		</h3>
	</div>
	<div class="modal-body share_dialog">
		
		<input type="hidden" id="share_type" value="{{type}}" />
		<input type="hidden" id="share_item_id" value="{{item.id}}" />
		
		{{#if_equal type compare="file"}}

			<div class="file_list_item">

				{{{makeFileHeader item item_owner}}}

				<a href="{{item.permalink}}" {{#isClient}}target="{{item.permalink}}"{{/isClient}} data-file-id="{{item.id}}" class="file_preview_link icon {{icon_class}}">
					{{#if item.thumb_80}}
						{{#if_equal icon_class compare="thumb_80"}}					
							<img src="{{item.thumb_80}}" />
						{{else}}
							<img src="{{item.thumb_360}}" />
						{{/if_equal}}						
					{{else}}
						<span data-file-id="{{item.id}}" class="filetype_icon s48 {{item.filetype}}"></span>
					{{/if}}
				</a>

				<div class="contents">

					<div class="file_meta">
						{{#if item.is_external}}
							{{{external_filetype_html}}}			
						{{else}}
							{{convertFilesize item.size}} <span>{{item.pretty_type}}</span> file
						{{/if}}<br />

						Uploaded <a href="{{item.permalink}}" {{#isClient}}target="{{item.permalink}}"{{/isClient}} data-file-id="{{item.id}}" class="file_preview_link"><span class="time">{{toCalendarDateOrNamedDayShort item.timestamp}} at {{toTime item.timestamp}}</span></a><br />
						{{#unless item.is_public}}
							<i class="fa fa-eye"></i>
							Private File 
						{{/unless}}				
					</div>
				</div>
			</div>
		
		{{/if_equal}}
		
		{{#if_equal type compare="file_snippet"}}

			<div class="file_list_item snippet">
				<div class="contents">

					{{{makeFileHeader item item_owner}}}

					{{#if item.preview}}
						<div class="snippet_preview">
							{{{item.preview_highlight}}}
							{{#if_gt item.lines_more compare=0}}
								<a href="{{item.permalink}}" class="snippet_preview_more" {{#isClient}}target="{{item.permalink}}"{{/isClient}} data-file-id="{{item.id}}" class="file_preview_link">+ {{item.lines_more}} more line{{#if_gt item.lines_more compare=1}}s{{/if_gt}}</a>
							{{/if_gt}}
						</div>
					{{/if}}
					<div class="file_meta">
						{{#if item.is_public}}
						{{else}}
							<i class="fa fa-eye"></i>
							Private Snippet <span class="bullet">?</span>
						{{/if}}
						Created <a href="{{item.permalink}}" {{#isClient}}target="{{item.permalink}}"{{/isClient}} data-file-id="{{item.id}}" class="file_preview_link"><span class="time">{{toCalendarDateOrNamedDayShort item.timestamp}} at {{toTime item.timestamp}}</span></a>
						<span class="bullet">?</span> {{convertFilesize item.size}} {{item.pretty_type}}
					</div>
				</div>
			</div>

		{{/if_equal}}
		
		{{#if_equal type compare="file_post"}}

			<div class="file_list_item post">
				<div class="contents">

					{{{makeFileHeader item item_owner}}}

					<p class="preview">
						{{{nl2br item.preview}}}
						<a href="{{item.permalink}}" {{#isClient}}target="{{item.permalink}}"{{/isClient}}data-file-id="{{item.id}}" class="file_preview_link more_link">more</a>
					</p>
					<div class="file_meta">
						{{#if item.is_public}}
							Published
						{{else}}
							<i class="fa fa-eye"></i>
							Draft Post <span class="bullet">?</span>
						{{/if}}
						<a href="{{item.permalink}}" {{#isClient}}target="{{item.permalink}}"{{/isClient}} data-file-id="{{item.id}}" class="file_preview_link"><span class="time">{{toCalendarDateOrNamedDayShort item.timestamp}} at {{toTime item.timestamp}}</span></a>
					</div>
				</div>
			</div>

		{{/if_equal}}	

		{{{sharing_html}}}
		
	</div>
	<div class="modal-footer">
		<a class="btn btn-outline dialog_cancel">Cancel</a>
		<a class="btn btn-primary dialog_go">Share</a>
	</div>
</script>

<script id="lightbox_dialog_template" type="text/x-handlebars-template">
	<div class="modal-body lightbox_dialog
		{{#if external}} external 
		{{else}}
			{{#if file.image_exif_rotation}}orientation_{{file.image_exif_rotation}}{{/if}}
		{{/if}}
		">
		<button type="button" class="close" data-dismiss="modal" aria-hidden="true"><i class="fa fa-times"></i></button>

		<div id="lightbox_image_container">
		</div>

		<div id="lightbox_preloader">
		</div>

	</div>
	<button type="button" class="lightbox_nav hidden faded" id="lightbox_go_left"><i class="fa fa-angle-left"></i></button>
	<button type="button" class="lightbox_nav hidden faded" id="lightbox_go_right"><i class="fa fa-angle-right"></i></button>
</script>

<script id="lightbox_image_container_template" type="text/x-handlebars-template">
	<i id="spinner" class="loading"></i>
	<img class="lightbox_image" src="{{file.url_private}}" {{#if file.image_exif_rotation}}data-exif-orientation="{{file.image_exif_rotation}}"{{/if}}/>
	<div class="lightbox_meta" data-url="{{file.url_private}}">

		{{{makeMemberPreviewLinkImage member.id 32}}}
		<span class="{{getMemberColorClassById member.id}}">{{{makeMemberPreviewLink member}}}</span>	
		<span class="title overflow-ellipsis">
			<a href="{{file.permalink}}" target="{{file.id}}" data-file-id="{{file.id}}">
				{{{formatFileTitle file}}}
			</a>
			{{{star 'file' file null}}}
		</span>	
		
		{{#if file.is_external}}
			{{#if_equal file.external_type compare="gdrive"}}						
				<a {{{makeRefererSafeLink url=file.url_private}}} target="{{file.url_private}}" class="icon_new_window no_underline" title="Open original in Google Drive"><img src="/img/services/gdrive_16.png" class="gdrive_icon grayscale" /></a>
			{{/if_equal}}
			{{#if_equal file.external_type compare="dropbox"}}						
				<a {{{makeRefererSafeLink url=file.url_private}}} target="{{file.url_private}}" class="icon_new_window no_underline" title="Open original in Dropbox"><i class="fa fa-dropbox"></i></a>
			{{/if_equal}}
			{{#if_equal file.external_type compare="box"}}						
				<a {{{makeRefererSafeLink url=file.url_private}}} target="{{file.url_private}}" class="icon_new_window no_underline" title="Open original in Box"><img src="/plugins/box/assets/service_32.png" class="box_icon grayscale" /></a>
			{{/if_equal}}
		{{else}}
			<a href="{{file.url_private}}" target="{{file.url_private}}" class="fa fa-external-link-square icon_new_window" title="Open original in new tab"></a>
		{{/if}}
		
	</div>
</script>

<script id="lightbox_external_image_container_template" type="text/x-handlebars-template">
	<i id="spinner"></i>
	<img class="lightbox_image" src="{{file_src}}" {{#if img_width}}data-width="{{img_width}}"{{/if}} {{#if img_height}}data-height="{{img_height}}"{{/if}} />
	<div class="lightbox_meta external" data-url="{{link_url}}">
		<span class="title overflow-ellipsis">
			<a {{{makeRefererSafeLink url=link_url}}} target="_blank">
				Open in a new tab
			</a>
		</span>				
		<a {{{makeRefererSafeLink url=link_url}}} target="_blank" class="fa fa-external-link-square icon_new_window" title="Open original in new tab"></a>
	</div>
</script>

<script id="snippet_dialog_template" type="text/x-handlebars-template">	
	<div class="modal-header">
		<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
		<h3>{{mode}} Snippet</h3>
	</div>
	<div class="modal-body share_dialog">
		
		<form action="" id="client_file_snippet" method="post" accept-encoding="UTF-8" onsubmit="return false;" class="no_bottom_margin">

			<p>
				<select name="filetype" id="client_file_snippet_select" name="client_file_snippet_select" class="float-right">
					<option value="auto">Auto Detect Type</option>
					{{#each codemirror_types}}
						<option value="{{this.type}}">{{this.label}}</option>
					{{/each}}
				</select>
				<input type="text" id="client_file_snippet_title_input" name="client_file_snippet_title_input" value="" placeholder="Title (optional)" style="" />
			</p>
			<p style="margin-bottom: 1.5rem;">
				<textarea name="content" wrap="virtual" id="client_file_snippet_textarea" style="width: 100%;"></textarea>
				<label class="checkbox normal mini float-right no_top_padding no_min_width" style="margin-top: -5px; padding-right: 0; width: auto;">
					<input type="checkbox" id="client_file_wrap_cb" {{#if wrap_lines}}checked{{/if}}> wrap
				</label>
			</p>

			{{{sharing_html}}}

		</form>
		
	</div>
	<div class="modal-footer">
		<a class="btn btn-outline dialog_cancel">Cancel</a>
		{{#if_equal mode compare="Edit"}}
		<a class="btn btn-primary dialog_go">Save changes</a>
		{{/if_equal}}
		{{#if_equal mode compare="Create"}}
		<a class="btn btn-primary dialog_go">Create Snippet</a>
		{{/if_equal}}
	</div>
	
</script>

<script id="growl_prompt_overlay_template" type="text/x-handlebars-template">
	<div id="growl_prompt_overlay">
	
		<div id="growl_prompt_overlay_impossible" class="hidden">			
			<h3>The browser you're using doesn't support desktop notifications.</h3>
			<p>When someone mentions you or sends you a direct message in Slack, we can let you know via a desktop notification.</p>
			<p>If you'd like to get desktop notifications from Slack, you can use a browser that supports them (like <a href="http://www.google.com/chrome/" class="bold">Google Chrome</a>), or download one of our <a href="/apps" class="bold" target="{{newWindowName}}">desktop apps</a>.</p>
			<p style="line-height: 26px;" class="large_top_margin no_bottom_margin">
				<a href="/apps" class="btn btn-small btn-primary see-apps" target="{{newWindowName}}">See our Apps</a>
				<span class="left_margin right_margin">or</span>
				<a class="prompt_cancel_forever btn-link">Not for me</a>
			</p>
		</div>
		
		<div id="growl_prompt_overlay_start" class="hidden">			
			<h3>Turn on desktop notifications?</h3>
			<p>When someone mentions you or sends you a direct message in Slack, we will let you know via a desktop notification.</p>
			<p style="line-height: 26px;" class="no_bottom_margin">
				<a class="prompt_allow btn btn-small btn-primary">Yes, turn on notifications</a>
				<span class="left_margin right_margin">or</span>
				<a class="prompt_cancel_forever btn-link">No, don't turn them on</a>
			</p>
		</div>
		
		<div id="growl_prompt_overlay_tell_to_allow" class="hidden">
			<i class="fa fa-arrow-circle-up block float-right" style="font-size: 3.5rem; margin: 0 1rem 0 0;"></i>
			<h3>Turn on desktop notifications?</h3>
			<p class="no_bottom_margin">Click <strong>Allow</strong> above to turn on desktop notifications.</p>
		</div>
		
		<div id="growl_prompt_overlay_success" class="hidden">
			<h3>Desktop notifications enabled</h3>
			<p>When someone mentions you or sends you a direct message in Slack, we will let you know via a desktop notification.</p>
			<p style="line-height: 26px;" class="no_bottom_margin">
				<a class="prompt_test btn btn-small btn-primary">Send me a test notification</a>
				<span class="left_margin right_margin">or</span>
				<a class="prompt_cancel btn-link">I'm done</a>
			</p>
		</div>
		
		<div id="growl_prompt_overlay_disallowed" class="hidden">
			<h3>Desktop notifications disabled</h3>
			<p>You chose not to allow desktop notifications. You will need to update your browser preferences in order to turn them on.</p>
			<p><a class="prompt_cancel btn btn-small btn-primary float-right">OK</a></p>
			<div class="clear-both"></div>
		</div>
		
	</div>
</script>

<script id="channel_invite_list_template" type="text/x-handlebars-template">

	<p class="top_margin">
		<label for="select_invite_channels" class="inline-block">Invite to</label>
		<select id="select_invite_channels" name="select_invite_channels" class="file_share_select inline-block no_margin">
			<option value="ts_null_value">Select a channel</option>
			{{#each channels}}
				<option value="{{this.id}}">#{{this.name}}</option>
			{{/each}}
		</select>
	</p>

</script>

<script id="group_invite_list_template" type="text/x-handlebars-template">

    {{#if groups}}
	<p class="top_margin">
		<label for="select_invite_groups" class="inline-block">Invite too</label>
		<select id="select_invite_groups" name="select_invite_groups" class="file_share_select inline-block no_margin">
			<option value="ts_null_value">Select a group</option>
			{{#each groups}}
				<option value="{{this.id}}">{{{groupPrefix}}}{{this.name}}</option>
			{{/each}}
		</select>
	</p>
	
	<p class="top_margin">
		-OR CREATE A NEW GROUP-
	</p>
	{{/if}}

</script>

<script id="channel_member_invite_list_template" type="text/x-handlebars-template">
{{#if show_ra_tip}}
	<p class="no_bottom_margin">
		Type or select the names of team members that you would like to invite:
	</p>
	<p class="small_bottom_margin mini subtle_silver">
		Restricted Accounts will not appear in this list. Ask a team administrator to invite them.
	</p>
{{else}}
	<p class="small_bottom_margin">
		Type or select the names of team members that you would like to invite:
	</p>
{{/if}}

	<div id="select_invite_channel_members_holder">
	
		<p class="no_bottom_margin">
			<select multiple="multiple" id="select_invite_channel_members" size="30">
				{{#each invite_members}}
					<option value="{{this.member.id}}" {{#if this.preselected}}selected="selected"{{/if}}>{{#if this.member.real_name}}{{this.member.real_name}} ? {{this.member.name}}{{else}}{{this.member.name}}{{/if}}</option>
				{{/each}}
			</select>		
		</p>
		
	</div>

</script>

<script id="group_member_invite_list_template" type="text/x-handlebars-template">
	<div id="group_invite_member_chooser" class="hidden">
		{{#if show_ra_tip}}
			<p class="no_bottom_margin">
				Type or select the names of team members that you would like to invite:
			</p>
			<p class="small_bottom_margin mini subtle_silver">
				Restricted accounts may not appear below. Ask a team administrator to invite them.
			</p>
		{{else}}
			<p class="small_bottom_margin">
				Type or select the names of team members that you would like to invite:
			</p>
		{{/if}}
	
		<div id="select_invite_group_members_holder">
		
			<p class="no_bottom_margin">
				<select multiple="multiple" id="select_invite_group_members" size="30">
					{{#each invite_members}}
						<option value="{{this.member.id}}" {{#if this.preselected}}selected="selected"{{/if}}>{{#if this.member.real_name}}{{this.member.real_name}} ? {{this.member.name}}{{else}}{{this.member.name}}{{/if}}</option>
					{{/each}}
				</select>		
			</p>
			
		</div>
		
		<p class="top_margin">
			<label class="checkbox no_margin">
				<input id="archive_access_cb" checked="checked" type="checkbox" class="small_right_margin" /> Invited members will have access to the group archives
			</label>
		</p>
	</div>
	
	
	<div id="group_invite_archives_prompt" class="">
		<p class="bold">Should new members be allowed to see the group's message history?</p>
		
		<p>If <strong>Yes</strong>, new members will be invited and will have access to this group's entire message history.</p> 
		<p>If <strong>No</strong>, this group will be renamed and archived. A new group will be created with all current members plus the new ones you invite. You and other current members will see a link back to the original group's archives.</p>
	</div>
	
</script>

<script id="channel_conversion_dialog_template" type="text/x-handlebars-template">	
	<p>Converting <b>#{{name}}</b> to a private group will preserve the history and membership.</p>
	<p class="small_bottom_margin"><b>Two things you should know:</b></p>
	<ul>
		<li>This conversion is not reversible. It is a one-way street.</li>
		<li>Files that were previously shared in this channel will not become private. They will remain publicly accessible to others on your team.</li>
	</ul>
	<p>Are you sure you want to convert <b>#{{name}}</b> to a private group?</p>
</script>

<script id="channel_data_retention_dialog_template" type="text/x-handlebars-template">	
	<p>This message retention policy will only affect this {{model_type}}. Retention policies can also be set on a team-wide basis in your <a target="new" href="/admin/settings#retention">team settings</a>.</p>

	<p id="retention_duration_warning" class="alert {{#feature flag="feature_new_team_sites"}}alert_warning{{else}}alert-info{{/feature}} hidden">
		{{#feature flag="feature_new_team_sites"}}<i class="fa fa-warning"></i>{{/feature}}
		<strong>An important note about message retention policies</strong><br />
		Setting a custom duration for message retention means that messages in this {{model_type}} will be  deleted after the number of days you set. This deletion is permanent and the messages will be irretrievable. Proceed with caution!
	</p>
	
	<p>
		{{#feature flag="feature_new_team_sites"}}
			<label for="retention_type" class="select small">
				Retention Type
				<select name="retention_type" class="small">
					<option value="0"{{#if_equal retention_type compare=0}} selected="selected"{{/if_equal}}>Use team preference</option>
					<option value="1"{{#if_equal retention_type compare=1}} selected="selected"{{/if_equal}}>Retain all messages for a specific number of days</option>
				</select>
			</label>
		{{else}}
			<label for="retention_type">Retention Type</label>
			<select name="retention_type" class="input-xxlarge" style="max-width: 314px">
				<option value="0"{{#if_equal retention_type compare=0}} selected="selected"{{/if_equal}}>Use team preference</option>
				<option value="1"{{#if_equal retention_type compare=1}} selected="selected"{{/if_equal}}>Retain all messages for a specific number of days</option>
			</select>
		{{/feature}}
	</p>

	<div id="retention_duration_container" {{#if_equal retention_type compare=0}}class="hidden"{{/if_equal}}>
		<label for="retention_duration">Duration</label>
		<div id="retention_duration_container" class="input-append no_bottom_margin ">
			<input type="text" name="retention_duration" id="retention_duration" class="{{#feature flag="feature_new_team_sites"}}mini align_right{{else}}input-mini align-right{{/feature}}" value="{{retention_duration}}" {{#feature flag="feature_new_team_sites"}}{{else}}style="border-radius: 4px 0 0 4px !important; width: 60px; height: 31px;"{{/feature}} />
			<span class="add-on"{{#feature flag="feature_new_team_sites"}}{{else}} style="line-height: 21px;"{{/feature}}>days</span>
		</div>
	</div>

	<div id="team_retention_pref" class="hidden">
		<p>
			The team preference is to
			{{#if_equal team_type compare=0}}<strong>retain all messages forever.</strong>{{/if_equal}}
			{{#if_equal team_type compare=1}}<strong>retain all messages forever AND also retain edit and deletion logs for all messages.</strong>{{/if_equal}}
			{{#if_equal team_type compare=2}}<strong>retain all messages for {{team_duration}} {{#if_equal team_duration compare=1}}day{{else}}days{{/if_equal}}.</strong>{{/if_equal}}
		</p>
	</div>
	
</script>

<script id="channel_deletion_dialog_template" type="text/x-handlebars-template">	
	<p>Are you sure you want to delete <b>{{name}}</b>? All its content will be removed from your Slack archives, and you cannot restore the content once deleted.</p>
	<p class="large_left_margin no_bottom_margin">
		<label class="checkbox normal" style="font-size: 1rem;">
			<input id="delete_channel_cb" type="checkbox" class="small_right_margin" />
			Yes, I am absolutely sure
		</label>
	</p>
</script>

<script id="channel_options_dialog_template" type="text/x-handlebars-template">	
	<div class="modal-header">
		<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
		<h3>Advanced Options for {{display_name}}</h3>
	</div>
	<div class="modal-body loading_animation_container">
		{{{loadingHTML}}}
	</div>
	<div class="modal-body hidden">
	
		{{#if show_archive_btn}}
			<p class="bold no_bottom_margin"><a id="{{#if_equal c_or_g compare="channel"}}channel_archive_btn{{else}}group_archive_btn{{/if_equal}}" class="bold">Archive this {{#if_equal c_or_g compare="channel"}}channel{{else}}group{{/if_equal}}</a></p>
			<p style="line-height: 1.25rem;">If you don't think it will be used any more and you want to clean up, archive it. The {{#if_equal c_or_g compare="channel"}}channel{{else}}group{{/if_equal}} can be unarchived later (but everyone will have been removed).</p>
		{{/if}}
		
		{{#if show_convert_btn}}
			<p class="bold no_bottom_margin"><a id="channel_convert_btn" class="bold">Convert this channel to a private group</a></p>
			<p style="line-height: 1.25rem;">Private groups are similar to channels, but they're hidden to non-members and the conversation is private. This conversion cannot be undone.</p>
		{{/if}}	
		
		{{#if show_rename_btn}}
			<p class="bold no_bottom_margin"><a id="channel_rename_btn" class="bold">Rename this {{#if_equal c_or_g compare="channel"}}channel{{else}}group{{/if_equal}}</a></p>		
			<p style="line-height: 1.25rem;">You can rename a {{#if_equal c_or_g compare="channel"}}channel{{else}}group{{/if_equal}} at any time. But, use it sparingly: it might confuse or disorient your colleagues!</p>
		{{/if}}

		{{#if show_purpose_btn}}
			<p class="bold no_bottom_margin"><a id="channel_purpose_btn" class="bold">{{#if model_ob.purpose.value}}Edit{{else}}Set{{/if}} the {{#if_equal c_or_g compare="channel"}}channel{{else}}group{{/if_equal}} purpose</a></p>
			<p style="line-height: 1.25rem;">
				{{#if_equal c_or_g compare="channel"}}Channel{{else}}Group{{/if_equal}} purposes are especially useful to new team members choosing which conversations to join.
				{{#if model_ob.purpose.value}}
					This {{#if_equal c_or_g compare="channel"}}channel{{else}}group{{/if_equal}}'s current purpose is <em>"{{{formatTopicOrPurpose model_ob.purpose.value}}}"</em>
				{{/if}}
			</p>
		{{/if}}
		
		<div class="retention_policy_container hidden">
			<p class="bold no_bottom_margin"><a id="data_retention_btn">Set the {{#if_equal c_or_g compare="channel"}}channel{{else}}group{{/if_equal}} message retention policy</a></p>
			<p class="no_bottom_margin" style="line-height: 1.25rem;">By default, Slack will save your message data forever. You can configure a custom message retention policy duration.</p>
		</div>

	</div>
	<div class="modal-footer">
		<a class="btn dialog_go">Done</a>
	</div>
</script>

<script id="tip_card_template" type="text/x-handlebars-template">
<div id="tip_card">
	<div id="tip_card_callout"></div>
	<div id="tip_card_interior">
		
		{{! the following divs are displayed dynamically based on what tip is being shown }}
		{{! they can contain one or more .tip_screen divs, which are like slides}}
		
		{{! -------------------------------- }}
		
		<div id="channels_tip_card_div" class="tip_card_div">
			<div class="tip_screen">
				<h3>The Channel List</h3>
				<p>Channels help organize conversations across different topics and groups. <strong>Channels are open to everyone on your team.</strong> Anyone can create or join a channel. (<strong>Direct messages</strong> and <strong>private groups</strong> are, of course, private.)</p>
			</div>
			<div class="tip_screen">
				<h3>#{{generalName}} & #random</h3>
				
				{{! we'll show one of the below <p>s, depending on if random has been archived or not. }}
				
				<p id="channels_both">Weve created two channels for you. The <strong>#{{generalName}}</strong> channel is for team-wide communication and everyone on your team has it open. The <strong>#random</strong> channel is for non-work banter, links, humor, etc., so that stays out of work-related channels. The rest are up to you and your team.</p>
				
				<p id="channels_only_general">Weve created the <strong>#{{generalName}}</strong> channel for you, which is for team-wide communication, and everyone on your team has it open. Any other channels are up to you and your team.</p>
			</div>
			<div class="tip_screen">
				<h3>Unreads, Mentions & Notifications</h3>
				<p>When there are <strong>unread messages</strong> in a channel, the channel name appears in bolded white. When your name is <strong>mentioned</strong> in a channel or when you receive a <strong>direct message</strong>, you'll receive a notification and see a <strong>counter</strong> showing the number of unread mentions.</p>
			</div>
		</div>
		
		{{! -------------------------------- }}
		
		<div id="message_input_tip_card_div" class="tip_card_div">
			<div class="tip_screen">
				<h3>Writing Messages</h3>
				<p>Type here to send a <b>message</b>. You can also paste images to upload them.</p>
				<p class="large_bottom_margin">Use the file button to easily share files, create text snippets or write posts. Note: You can also <b>drag and drop</b> files into Slack. Everything you add becomes searchable. Voila!</p>
			</div>
		</div>
		
		{{! -------------------------------- }}
		
		<div id="team_menu_tip_card_div" class="tip_card_div">
		
			<div class="tip_screen">
				<h3>Team Menu</h3>
				<p>The team menu gives you access to the <b>team site</b> for your Slack instance on which you can browse <b>archives</b>, get <b>help</b>, set up <b>integrations</b>, and set <b>preferences</b>.</p>
				<p class="large_bottom_margin">There's also quick links to help, downloading apps and switching teams.</p>
			</div>
		
		</div>
		
		{{! -------------------------------- }}
		
		<div id="channel_menu_tip_card_div" class="tip_card_div">
			<div class="tip_screen">
				<h3>The Channel Menu</h3><b></b>
				<p>From the channel menu you can set a <b>topic</b> for discussion, open the channels archives or <b>add a service integration</b> to the channel.</p>
				<p>When you <b>add a person</b> to a channel, the channel will open for them automatically  with an explanation.</p>
			</div>
		</div>
		
		{{! -------------------------------- }}
		
		<div id="user_menu_tip_card_div" class="tip_card_div">
			<div class="tip_screen">
				<h3>Your Account Menu</h3>
				<p>On your account menu you can edit your <strong>profile</strong> and <strong>account settings</strong>, change your online status, and set <strong>preferences</strong> for things like notifications, message display settings, and more.</p>
			</div>
			<div class="tip_screen" id="notifications_screen">
				<h3>Desktop Notifications</h3>
				<p>When someone mentions you or sends you a direct message in Slack, <b>we can let you know via a desktop notification</b>. But first you need to enable them! To get started, <a style="cursor:pointer" onclick="TS.tip_card.openPrefsAndCloseTip('notifications')">open preferences</a> and follow the instructions.</p>
			</div>
		</div>
		
		{{! -------------------------------- }}
		
		<div id="flexpane_tip_card_div" class="tip_card_div">
			<div class="tip_screen short">
				<h3>The Flexpane Menu</h3>
				<p style="margin-bottom: 3rem;">The Flexpane menu button will open or close the Flexpane menu, revealing a treasure trove of options for browsing, listing, filtering and viewing the contents of your Slack instance.</p>
			</div>
		</div>
		
		{{! -------------------------------- }}
		
		<div id="search_input_tip_card_div" class="tip_card_div">
			<div class="tip_screen">
				<h3>Searching in Slack</h3>
				<p>Everything in Slack is searchable.</p>
				<p>The full text of every message and file you upload is indexed for search and you can easily filter results by type, owner or channel.</p>
			</div>
			<div class="tip_screen">
				<h3>Message Search Results</h3>
				<p>Message search results are presented in <b>conversational format</b> which can be expanded to display <b>adjacent messages</b> from that conversation, which helps you find what you need faster.</p>
			</div>
		</div>
		
		{{! -------------------------------- }}
		
		<div id="about_channels_tip_card_div" class="tip_card_div">
			<div class="tip_screen">
				<h3>About Channels</h3>
				<p>All channels are <b>public</b> and <b>viewable by all</b>, and anyone on your team can create or join any channel.  Any files shared into a channel becomes public.</p>
				
				<p>All the channels you have <b>open</b> are displayed in your channel list. You always have access to the history of all channels, even if you <b>close</b> them.</p>
				
				<p class="large_bottom_margin"><i class="fa fa-info-circle"></i> Read more about <a target="{{newWindowName}}" href="/help/channels">channels in help</a>.</p>
			</div>
		</div>
		
		{{! -------------------------------- }}
		
		<div id="about_dms_tip_card_div" class="tip_card_div">
			<div class="tip_screen">
				<h3>About Direct Messages</h3>
				<p>Direct messages (DMs) are <b>private one-to-one conversations</b> between you and another member of your team. DM results will show up for you in message search, but only for the participants in the DM.</p>
				
				<p>Sharing a private file in a DM will not make it public, but it will let both people see it.</p>
				
				<p class="large_bottom_margin"><i class="fa fa-info-circle"></i> Read more about <a target="{{newWindowName}}" href="/help/direct-messages">direct messages in help</a>.</p>
			</div>
		</div>
		
		{{! -------------------------------- }}
		
		<div id="about_groups_tip_card_div" class="tip_card_div">
			<div class="tip_screen">
				<h3>About Private Groups</h3>
				<p>A Private Group is similar to a channel except that an invitation is required to join. Activity in private groups is <b>only visible to the group's members</b>.</p>
				
				<p>Any private group member (except guest accounts) can <b>invite new members</b> to the private group at any time, but private groups are not discoverable by anyone who is not already a member of the group.</p>
				
				<p class="large_bottom_margin"><i class="fa fa-info-circle"></i> Read more about <a target="{{newWindowName}}" href="/help/private-groups">private groups in help</a>.</p>
			</div>
		</div>
		
		{{! -------------------------------- }}

		
		{{! below is always shown }}
	
		<a class="btn btn-small tip_card_go"></a>

		<div id="tip_card_nav">
			<div id="tip_card_dots" class="inline-block">
				<a data-slide="1">?</a>
				<a data-slide="2">?</a>
				<a data-slide="3">?</a>
				<a data-slide="4">?</a>
				<a data-slide="5">?</a>
				<a data-slide="6">?</a>
				<a data-slide="7">?</a>
				<a data-slide="8">?</a>
				<a data-slide="9">?</a>
			</div>
		</div>
	
	</div>
	
	<div id="tip_card_footer">
		<img src="/img/landing_slack_hash_logo_@2x.png" id="tip_card_logo" />
		<p>Seen this before? <a onclick="TS.tip_card.optOutAndCloseTip()">Opt out of these tips</a>.</p>
	</div>
	
</div>
</script>

<script id="shortcuts_dialog_template" type="text/x-handlebars-template">	
	<button type="button" class="close" data-dismiss="modal" aria-hidden="true"><i class="fa fa-times"></i></button>
	<div class="modal-body class="shortcuts_dialog">

		<h1 class="align-center" style="margin-left: -5rem;">
			Keyboard Shortcuts 
			<span style="position: absolute; top: 11px; right: 14rem;">
				<span class="key">{{#isMac}}Cmd{{else}}Ctrl{{/isMac}}</span><span class="key">?</span>
			</span>
		</h1>
		
		<div class="col">
			<h3>Channels & DMs</h3>
			<ul class="no_bullets">
				<li>Previous in list: <span class="key">{{#isMac}}Option{{else}}Alt{{/isMac}}</span><span class="key"><i class="fa fa-long-arrow-up"></i></span></li>
				<li>Next in list: <span class="key">{{#isMac}}Option{{else}}Alt{{/isMac}}</span><span class="key"><i class="fa fa-long-arrow-down"></i></span></li>
				<li>Previous unread: <span class="key">{{#isMac}}Option{{else}}Alt{{/isMac}}</span><span class="key">Shift</span><span class="key"><i class="fa fa-long-arrow-up"></i></span></li>
				<li>Next unread: <span class="key">{{#isMac}}Option{{else}}Alt{{/isMac}}</span><span class="key">Shift</span><span class="key"><i class="fa fa-long-arrow-down"></i></span></li>
				<li>Back in history: <span class="key">{{#isMac}}Cmd{{else}}Ctrl{{/isMac}}</span><span class="key">[</span></li>
				<li>Forward in history: <span class="key">{{#isMac}}Cmd{{else}}Ctrl{{/isMac}}</span><span class="key">]</span></li>
				<li>Mark as read: <span class="key">Esc</span></li>
				<li>Mark all as read: <span class="key">Shift</span><span class="key">Esc</span></li>
				<li>Quick switcher: <span class="key">{{#isMac}}Cmd{{else}}Ctrl{{/isMac}}</span><span class="key">k</span>{{#isOurApp}} or <span class="key">t</span>{{/isOurApp}}</li>
			</ul>			
		</div>

		<div class="col">
			<h3>Messaging</h3>
			<ul class="no_bullets">
				<li>
					Autocomplete
					<ul>
						<li>Names: <span class="subtle_silver">[a-z]</span><span class="key">Tab</span> <span class="subtle_silver">or</span> <span class="key">@</span><span class="key">Tab</span></li>
						<li>Channels: <span class="key">#</span><span class="key">Tab</span></li>
						<li>Emoji: <span class="key">:</span><span class="key">Tab</span></li>
					</ul>
				</li> 
				<li>New line: <span class="key">Shift</span><span class="key">Enter</span></li>
				<li>Edit last message: <span class="key"><i class="fa fa-long-arrow-up"></i></span> <span class="subtle_silver">in input</span></li>
			</ul>
		</div>
		
		<div class="col no_right_margin">
			<h3>Extras</h3>
			<ul class="no_bullets">		
				{{#isOurApp}}<li>Open Preferences: <span class="key">Cmd</span><span class="key">,</span></li>{{/isOurApp}}
				<li>Toggle Flexpane: <span class="key">{{#isMac}}Cmd{{else}}Ctrl{{/isMac}}</span><span class="key">.</span></li>
					<ul>
						<li>Activity: <span class="key">Shift</span><span class="key">{{#isMac}}Cmd{{else}}Ctrl{{/isMac}}</span><span class="key">a</span></li>
						<li>Mentions: <span class="key">Shift</span><span class="key">{{#isMac}}Cmd{{else}}Ctrl{{/isMac}}</span><span class="key">m</span></li>
						{{#isFF}}{{else}}<li>Team: <span class="key">Shift</span><span class="key">{{#isMac}}Cmd{{else}}Ctrl{{/isMac}}</span><span class="key">e</span></li>{{/isFF}}
						<li>Stars: <span class="key">Shift</span><span class="key">{{#isMac}}Cmd{{else}}Ctrl{{/isMac}}</span><span class="key">s</span></li>
						{{#isOurApp}}<li>Search: <span class="key">{{#isMac}}Cmd{{else}}Ctrl{{/isMac}}</span><span class="key">f</span></li>{{/isOurApp}}
					</ul>
				<li>Paste Snippet: <span class="key">Shift</span>{{#isSafariDesktop}}<span class="key">Opt</span>{{/isSafariDesktop}}<span class="key">{{#isMac}}Cmd{{else}}Ctrl{{/isMac}}</span><span class="key">v</span></li>
				<li>Dismiss Dialogs: <span class="key">Esc</span></li>
			</ul>
		</div>

		<div class="clear-both"></div>
				
		<p class="info_block align-center no_bottom_margin">
			Type <strong class="command">/commands</strong> to learn about other shortcuts, like <strong class="command">/msg</strong> [name], <strong class="command">/invite</strong> [name], and <strong class="command">/join</strong> [channel name]
		</p>

	</div>
</script>

<script id="omnibox_template" type="text/x-handlebars-template">	
	<div class="modal-body">
		<div id="omnibox_ui">
			<p id="omnibox_help">
				Jump to a conversation
				<span class="float-right" style="margin-right: 0.25rem;">
					<strong>tab</strong>&nbsp; or &nbsp;<strong>&uarr;</strong> <strong>&darr;</strong>&nbsp; to navigate <strong class="small_left_margin">?</strong>&nbsp; to select <strong class="small_left_margin">esc</strong>&nbsp; to dismiss
				</span>
			</p>
			<input type="text" id="omnibox_input" />
			<div id="omnibox_results"></div>
			<p class="no_results hidden">
				No matches found for <strong class="query"></strong>.<br />
				Have you spelled it right?
			</p>
		</div>
		<div id="omnibox_switching" class="hidden">
			<img id="switch_spinner" src="/img/loading_hash_animation_@2x.gif" />
			<h4 class="large_bottom_margin">Switching to <span id="switched_team_name"></span> ...</h4>
		</div>
	</div>
</script>


<script id="admin_list_item_template" type="text/x-handlebars-template">

	<div class="admin_list_item {{#if_equal member.is_inactive compare="1"}}inactive{{/if_equal}}" id="row_{{member.id}}" data-member-id="{{member.id}}" {{#if show_inactive_tip}}data-toggle="tooltip" title="This team member has not been active in Slack recently."{{/if}}>

		{{{makeMemberPreviewLinkImage member.id 36}}}

		{{#if show_rename}}

			{{#memberIsSelf id=member.id}}
				<span class="admin_member_real_name">You{{#if member.profile.real_name}} <span class="normal"><span class="bullet">?</span> {{member.profile.real_name}}</span>{{/if}}</span>
			{{else}}
				{{#if member.profile.real_name}}
					<span class="inline_name admin_member_real_name" title="Click to edit full name">{{member.profile.real_name}}</span>
				{{else}}
					<span class="inline_name" title="Click to edit">{{#isMobileWeb}}Tap{{else}}Click{{/isMobileWeb}} to add a full name</span>
				{{/if}}
			{{/memberIsSelf}}

			<form class="inline_name_edit_form hidden inline-block inline_block no_bottom_margin" onsubmit="TS.web.admin.submitNameForm('{{member.id}}');">
				<input type="text" name="first_name" placeholder="First name" value="{{member.profile.first_name}}" />
				<input type="text" name="last_name" placeholder="Last name" value="{{member.profile.last_name}}" />
				{{#isMobileWeb}}
				{{else}}
					<span class="mini"><a onclick="$(this).closest('form').submit();">save</a> or <a onclick="TS.web.admin.cancelNameForm('{{member.id}}');">cancel</a></span>
				{{/isMobileWeb}}
			</form>

		{{else}}

			{{#if member.profile.real_name}}
				<span class="admin_member_real_name">{{member.profile.real_name}}</span>
			{{else}}
				No real name set
			{{/if}}

		{{/if}}

		<br />

		<span class="admin_member_username_and_email">


	
				<span class="indifferent_grey">@{{member.name}}</span> 
	




			<span class="bullet">?</span> 



	
			<span>{{member.profile.email}}</span>
	


		</span>



		<span class="admin_member_type show_pill_action">
			{{#if member_status}}<em class="subtle_silver">{{member_status}}</em>{{/if}}
			{{#if member.is_ultra_restricted}}
				{{#each member.channels}}
					<a class="channel pill api_change_ura_channel" title="Change the channel that {{../member.name}} can access">#{{this}} <i class="fa fa-pencil pill_action edit"></i></a>
				{{/each}}
				{{#each member.groups}}
					<a class="group pill api_change_ura_channel" title="Change the group that {{../member.name}} can access">{{this}} <i class="fa fa-pencil pill_action edit"></i></a>
				{{/each}}
				{{#if member.more_groups}}	
					<a class="group pill api_change_ura_channel" title="Change the group that {{../member.name}} can access">Private Group <i class="fa fa-pencil pill_action edit"></i></a>
				{{/if}}
			{{else}}
				{{#if member.is_restricted}}
					<span class="mini">
						Belongs to
						{{#if channels_count}}
							{{channels_count}} {{pluralize channels_count "channel" "channels"}}
						{{/if}}
						{{#if group_count}}
							{{#if channels_count}}and{{/if}}
							{{group_count}} {{pluralize group_count "group" "groups"}}
						{{/if}}
					</span>
				{{else}}
					{{member_type}}
				{{/if}}
			{{/if}}
		</span>

		<i class="admin_member_caret fa fa-caret-right"></i>
		<i class="admin_member_caret fa fa-caret-down"></i>

		<div class="member_actions {{#feature flag="feature_new_team_sites"}}clearfix{{/feature}}">
			{{#unless member.is_ultra_restricted}}
				{{#if member.is_restricted}}
					<p class="small_bottom_margin">
						{{#if_gt ../total_memberships compare=1}}<span class="show_pill_action">{{/if_gt}}
							{{#each member.channels}}
								<span class="channel pill">#{{this}}{{#if_gt ../total_memberships compare=1}}{{#canUserKickFromChannels}} <i class="fa fa-times-circle pill_action api_channel_kick" data-channel-id="{{@key}}" title="Remove {{../../member.name}} from #{{this}}"></i>{{/canUserKickFromChannels}}{{/if_gt}}</span>
							{{/each}}
							{{#each member.groups}}
								<span class="group pill">{{this}}{{#if_gt ../total_memberships compare=1}}{{#canUserKickFromGroups}} <i class="fa fa-times-circle pill_action api_group_kick" data-group-id="{{@key}}" title="Remove {{../../member.name}} from {{this}}"></i>{{/canUserKickFromGroups}}{{/if_gt}}</span>
							{{/each}}
						{{#if_gt ../total_memberships compare=1}}</span>{{/if_gt}}
						{{#if show_add_channel_btn}}
							<a class="channel pill api_channel_invite"><i class="fa fa-plus"></i></a>
						{{/if}}
						{{#if member.more_groups}}
							+{{member.more_groups}} {{#if groups_count}}other{{/if}} {{pluralize member.more_groups "group" "groups"}}
						{{/if}}
					</p>
				{{/if}}	
			{{/unless}}		
			{{#if actions}}
				{{#if actions.activate}}
					<a class="api_enable_account btn btn-outline btn-mini btn_outline btn_small">Enable Account</a>
					{{#isMobileWeb}}{{else}}<span class="sub_actions">{{/isMobileWeb}}
						{{#if paid_team}}
							<a class="api_enable_ra {{#isMobileWeb}}btn btn-outline btn-mini{{else}}sub_action{{/isMobileWeb}}">Enable Restricted Account</a>
						{{else}}
							<a class="admin_member_restrict_link_unpaid {{#isMobileWeb}}btn btn-outline btn-mini{{else}}sub_action{{/isMobileWeb}}">Enable Restricted Account</a>
						{{/if}}
					{{#isMobileWeb}}{{else}}{{#if actions.deactivate}}{{else}}</span>{{/if}}{{/isMobileWeb}}
				{{/if}}
				{{#if member.is_restricted}}
					{{#if actions.unrestrict}}
						<a class="api_unrestrict_account btn btn-outline btn-mini btn_outline btn_small">Make full team member</a>
					{{/if}}
					{{#if actions.convert_to_ra}}
						{{#isMobileWeb}}{{else}}<span class="sub_actions">{{/isMobileWeb}}
							<a class="api_set_restricted {{#isMobileWeb}}btn btn-outline btn-mini{{else}}sub_action{{/isMobileWeb}}">Convert to Restricted Account</a>
						{{#isMobileWeb}}{{else}}{{#if actions.deactivate}}{{else}}</span>{{/if}}{{/isMobileWeb}}
					{{/if}}
					{{#if actions.convert_to_ura}}
						{{#isMobileWeb}}{{else}}<span class="sub_actions">{{/isMobileWeb}}
							<a class="admin_member_restrict_link_ura {{#isMobileWeb}}btn btn-outline btn-mini{{else}}sub_action{{/isMobileWeb}}">Convert to Single-channel Guest</a>
						{{#isMobileWeb}}{{else}}{{#if actions.deactivate}}{{else}}</span>{{/if}}{{/isMobileWeb}}
					{{/if}}
				{{else}}
					{{#unless actions.activate}}
						{{#if actions.admin}}
							<a class="api_make_admin btn btn-outline btn-mini btn_outline btn_small">Make an Admin</a>
						{{/if}}
						{{#if actions.owner}}
							<a class="api_make_owner btn btn-outline btn-mini btn_outline btn_small">Make an Owner</a>
						{{/if}}
					{{/unless}}
					{{#if actions.deadmin}}
						<a class="api_remove_admin btn btn-outline btn-mini btn_outline btn_small">Remove Admin Privileges</a>
					{{/if}}
					{{#if actions.deowner}}
						<a class="api_remove_owner btn btn-outline btn-mini btn_outline btn_small">Remove Ownership</a>
					{{/if}}
					{{#if actions.restrict}}
						{{#isMobileWeb}}{{else}}<span class="sub_actions">{{/isMobileWeb}}
							{{#if paid_team}}
								<a class="admin_member_restrict_link {{#isMobileWeb}}btn btn-outline btn-mini{{else}}sub_action{{/isMobileWeb}}">Restrict this account</a>
							{{else}}
								<a class="admin_member_restrict_link_unpaid {{#isMobileWeb}}btn btn-outline btn-mini{{else}}sub_action{{/isMobileWeb}}">Restrict this account</a>
							{{/if}}
						{{#isMobileWeb}}{{else}}{{#if actions.deactivate}}{{else}}</span>{{/if}}{{/isMobileWeb}}
					{{/if}}
				{{/if}}
				{{#if actions.deactivate}}
						{{#isMobileWeb}}{{else}}{{#if actions.restrict}}<span class="bullet">?</span>{{else}}{{#if actions.convert_to_ura}}<span class="bullet">?</span>{{else}}<span class="sub_actions">{{/if}}{{/if}}{{/isMobileWeb}}
						<a class="api_disable_account {{#isMobileWeb}}btn btn-outline btn-mini{{else}}sub_action{{/isMobileWeb}}">Disable Account</a>
					</span>
				{{/if}}
			{{else}}
				{{#if show_transfer_btn}}
					<a href="/admin/transfer" class="btn btn-outline btn-mini btn_outline btn_small">Transfer team ownership</a>
				{{else}}
					
																	
							There aren't any actions for you to take on {{#memberIsSelf id=member.id}}yourself{{else}}<strong>@{{member.name}}</strong> ({{member_type}}){{/memberIsSelf}}.
						
										
				{{/if}}
			{{/if}}
			<!-- empty left side (bot) case -->
			&nbsp;
		</div>

		<div class="notice_processing">Updating ...</div>
		<div class="notice_success">
			<span class="success_message"></span>
			<a class="notice_dismiss {{#feature flag='feature_new_team_sites'}}neutral_white{{else}}btn btn-outline btn-mini white{{/feature}}">Okay</a>
		</div>
		<div class="notice_error">
			<span class="error_message">
				<span class="error_generic">Oops! There was an error performing your action.</span> <span class="error_detail"></span>
			</span>
			<span class="notice_dismiss {{#feature flag='feature_new_team_sites'}}neutral_white{{else}}btn btn-outline btn-mini white{{/feature}}">Try again</span>
		</div>
		
	</div>
</script>

<script id="admin_invite_list_item_template" type="text/x-handlebars-template">

	<div class="admin_list_item invite_item {{#if is_pending}}pending{{/if}} {{#if invite.bouncing}}bouncing{{/if}}" id="row_{{invite.id}}" data-invite-id="{{invite.id}}">

		{{#if member}}
			{{{makeMemberPreviewLinkImage member.id 36}}}
			{{#if member.real_name}}
				<span class="admin_member_real_name">{{member.real_name}}</span><br />
			{{/if}}
		{{/if}}
		
		{{#if display_invite_name}}
			<span class="admin_member_real_name">{{invite.first_name}} {{invite.last_name}}</span><br />
		{{/if}}

		<span class="admin_member_username_and_email">
			{{#if member}}
				<a href="/team/{{member.name}}" class="indifferent_grey">@{{member.name}}</a> <span class="bullet">?</span> 
			{{/if}}
			{{#if invite}}
				{{#if invite.type}}
					{{invite_type_label}} <span class="bullet">?</span>
				{{/if}}
			{{/if}}
			<span class="email">{{invite.email}}</span>
			{{#if invite.bouncing}}<span class="bullet">?</span> email address bounced{{/if}}
		</span>

		<span class="admin_invite_sent_date">
			{{#if is_pending}}
				{{#if_equal invite.date_resent compare="0"}}
					Invited {{toCalendarDateOrNamedDayShort invite.date_create}}</span>
				{{else}}
					Resent {{toCalendarDateOrNamedDayShort invite.date_resent}}</span>
				{{/if_equal}}
			{{else}}				
				Joined {{toCalendarDateOrNamedDayShort invite.date_create}}
			{{/if}}
		</span>
		
		{{#if is_pending}}
			<i class="admin_member_caret fa fa-caret-right"></i>
			<i class="admin_member_caret fa fa-caret-down"></i>

			<div class="member_actions">
				<a href="/admin/invites?revoke={{invite.id}}&{{crumb_key}}" class="btn {{#feature flag="feature_new_team_sites"}}btn_outline btn_small{{else}}btn-outline btn-mini{{/feature}}">Revoke Invitation</a>
				<a href="/admin/invites?resend={{invite.id}}&{{crumb_key}}" class="btn {{#feature flag="feature_new_team_sites"}}btn_outline btn_small{{else}}btn-outline btn-mini{{/feature}}">Resend Invitation</a>
			</div>
		{{/if}}
	</div>
</script>

<script id="admin_invite_row_template" type="text/x-handlebars-template">
	<div id="invite_{{index}}" class="admin_invite_row">
		<p class="error_msg hidden"></p>
		<span class="control-group">
			<input type="text" class="email_field {{#feature flag='feature_new_team_sites'}}small{{/feature}}" name="email_address" placeholder="name@domain.com" />
		</span>
		{{#feature flag='feature_new_team_sites'}}
			<div class="name_fields">
				<input type="text" name="first_name" placeholder="First name" class="small small_right_margin no_bottom_margin" />
				<input type="text" name="last_name" placeholder="Last name" class="small no_bottom_margin" />
			</div>
		{{else}}
			<input type="text" class="name_field" name="first_name" placeholder="First name" />
			<input type="text" class="name_field" name="last_name" placeholder="Last name" />
		{{/feature}}
		{{#if show_delete_btn}}
			<a class="delete_row" data-toggle="tooltip" title="Remove this invitation"><i class="fa fa-times"></i></a>
		{{/if}}
	</div>
</script>

<script id="admin_restricted_info_template" type="text/x-handlebars-template">
	<div class="restricted_info">
		
		<p class="large_bottom_margin emphasized align-center align_center">Give limited access to your Slack instance to contractors, clients, or friends.</p>
		
		<div class="account_type">
			<div class="restricted_account_icon"></div>
			<h3 class="no_bottom_margin">Restricted Accounts</h3>
			<p class="no_bottom_margin">Can only access channels and private groups that they are invited to join.</p>
			{{#if paid_team}}
				<p><a href="/admin/invites/restricted"><i class="fa fa-envelope-o"></i> &nbsp;Invite new restricted accounts</a></p>
			{{/if}}
		</div>
		<div class="account_type">
			<div class="guest_account_icon"></div>
			<h3 class="no_bottom_margin">Single-channel Guests</h3>
			<p class="no_bottom_margin">A free account with access to a single channel or private group.</p>
			{{#if paid_team}}
				<p><a href="/admin/invites/guests"><i class="fa fa-envelope-o"></i> &nbsp;Invite new single-channel guests</a></p>
			{{/if}}
		</div>
		
		{{#unless paid_team}}
			<div class="admin_banner">
				<h3>Both available on our Standard Plan.</h3>
				<p class="no_bottom_margin">Learn more about your <a href="/admin/billing">upgrade options</a>.</p>
			</div>
		{{/unless}}
		
	</div>	
</script>

<script id="admin_restrict_account_template" type="text/x-handlebars-template">

	<div class="{{#feature flag="feature_new_team_sites"}}col span_3_of_6{{else}}admin_invite_col_left{{/feature}}">
	
		<h4>
		{{#if enabling}}Enable a restricted account{{else}}Restrict this account{{/if}}
		</h4>

		<p class="small_bottom_margin">
			Team members you
			{{#if enabling}} enable with a Restricted Account{{else}} convert to Restricted Accounts{{/if}}
			 will have the following capabilities:
		</p>
		<ul>
			<li>participate in the channels and groups they are invited to join</li>
			<li>exchange direct messages with others in the channels and groups to which they belong</li>
		</ul>
		<p class="small_bottom_margin">They will <strong>not</strong> be able to:</p>
		<ul>
			<li>create new channels or groups</li>
			<li>see files or messages in channels and groups they don't belong to</li>
		</ul>
		<p class="large_bottom_margin">Single-channel Guests only have access to one channel or private group.</p>
		
		<h4>Billing</h4>
		<p class="large_bottom_margin">Restricted Accounts count as paid users when they are active. Single-channel Guests are free.</p>
		
	</div>

	<div class="{{#feature flag="feature_new_team_sites"}}col span_3_of_6 invite_form_column{{else}}admin_invite_col_right{{/feature}}">

		<div id="step1" class="align-center align_center">

			{{{makeMemberPreviewLinkImage member.id 192}}}
	
			<h3 class="top_margin">
				{{#if enabling}}
					Enable {{#if member.profile.real_name}}{{member.profile.real_name}}{{else}}{{member.name}}{{/if}} with:
				{{else}}
					Convert {{#if member.profile.real_name}}{{member.profile.real_name}}{{else}}{{member.name}}{{/if}} to:
				{{/if}}
			</h3>
	
			<a class="restriction_option" id="restricted_user">
				<i class="presence large active ra"></i> A restricted account <i class="fa fa-arrow-right"></i>
			</a>
			<a class="restriction_option" id="guest_user">
				<i class="presence large active ura"></i> A single-channel guest <i class="fa fa-arrow-right"></i>
			</a>
		
			<p class="subtle_silver large_top_margin">or <a class="cancel_admin_restrict_workflow subtle_silver">return to Team Administration</a></p>
		</div>
	
		<div id="step2_restricted" class="hidden align-center align_center">

			{{{makeMemberPreviewLinkImage member.id 192}}}
	
			<h3 class="top_margin">
				{{#if enabling}}Enable{{else}}Convert{{/if}} {{#if member.profile.real_name}}{{member.profile.real_name}}{{else}}{{member.name}}{{/if}} to a Restricted Account
			</h3>
			
			<p>{{#if enabling}}{{else}}This change will take effect immediately. {{/if}}You can set the channels and private groups for this restricted account in the next step.</p>
	
			<p class="error_message moscow_red hidden">Oops! There was an error performing your action.</p>
			<p>
				<a class="btn api_set_restricted btn-success">Confirm</a>
				<a class="cancel_admin_restrict_workflow btn btn-outline btn_outline small_left_margin">Cancel</a>
			</p>

		</div>

		<div id="step2_guest" class="hidden align-center align_center">

			{{{makeMemberPreviewLinkImage member.id 192}}}
	
			<h3 class="top_margin">{{#if enabling}}Enable{{else}}Convert{{/if}} {{#if member.profile.real_name}}{{member.profile.real_name}}{{else}}{{member.name}}{{/if}} to a Single-channel Guest</h3>
	
			<p class="no_bottom_margin">With access to this channel or group:</p>

			<p>
				<label class="select small">
					<select id="ultra_restricted_channel_picker" class="small">
						{{#if channels}}
							<optgroup label="Channels">
								{{#each channels}}
									<option value="{{this.id}}">#{{this.name}}</option>
								{{/each}}
							</optgroup>
						{{/if}}
						{{#if groups}}
							<optgroup label="Private Groups">
								{{#each groups}}
									<option value="{{this.id}}"><i class="fa fa-lock"></i> {{this.name}}</option>
								{{/each}}
							</optgroup>
						{{/if}}
					</select>
				</label>
			</p>

			{{#if enabling}}{{else}}<p>This change will take effect immediately.</p>{{/if}}

			<p class="error_message moscow_red hidden">Oops! There was an error performing your action.</p>
		
			<p id="convert_to_ura_confirmation">
				<a class="btn api_set_ultra_restricted btn-success">Confirm</a>
				<a class="cancel_admin_restrict_workflow btn btn-outline btn_outline small_left_margin">Cancel</a>
			</p>

		</div>
		
	</div>
	
</script>


<script id="account_notifications_channel_overrides_template" type="text/x-handlebars-template">
	<p class="show_when_no_overrides no_bottom_margin">You do not have any channel-specific settings.</p>
	<table>
		<tr class="hide_when_no_overrides">
			<td></td>
			<td class="align-center align_center extra_right_border" colspan="3"><i class="fa fa-desktop small_right_margin"></i><strong>Desktop</strong></td>
			<td class="align-center align_center extra_left_border" colspan="3"><i class="fa fa-mobile small_right_margin"></i><strong>Mobile</strong></td>
			<td></td>
		</tr>
		<tr class="hide_when_no_overrides">
			<td></td>
			<td class="align-center align_center radio_container_width"><strong><span class="mini">Everything</span></strong></td>
			<td class="align-center align_center radio_container_width"><strong><span class="mini">Mentions</span></strong></td>
			<td class="align-center align_center radio_container_width extra_right_border"><strong><span class="mini">Nothing</span></strong></td>
			<td class="align-center align_center radio_container_width extra_left_border"><strong><span class="mini">Everything</span></strong></td>
			<td class="align-center align_center radio_container_width"><strong><span class="mini">Mentions</span></strong></td>
			<td class="align-center align_center radio_container_width"><strong><span class="mini">Nothing</span></strong></td>
			<td class="revert_cell_width"></td>
		</tr>
		<tr id="add_override_channel_picker_row" class="hidden">
			<td colspan="8"><a id="add_override_channel_picker"><i class="fa fa-plus-circle"></i> Add a custom setting for a channel or group</a></td>
		</tr>
	</table>
	<div {{#feature flag='feature_new_team_sites'}}{{else}}class="small_top_margin"{{/feature}}>
		<span class="pref_saved"><i class="fa fa-check-circle"></i> Saved</span>
	</div>
</script>

<script id="account_notifications_channel_overrides_row_template" type="text/x-handlebars-template">
	<tr class="channel_override_row">
		<td>
			<div>
				{{#if channel.is_group}}<i class="fa fa-lock group_lock_prefix"></i>{{/if}}{{#if channel.is_channel}}<span class="channel_hash_prefix">#</span>{{/if}}{{channel.name}}
			</div>
		</td>
		<td>
			<div class="radio_cell">
				<input type="radio" class="no_right_margin" id="desktop_everything_{{channel.id}}" name="desktop_{{channel.id}}" data-id="{{channel.id}}" data-device="desktop" value="everything">
			</div>
		</td>
		<td>
			<div class="radio_cell">
				<input type="radio" class="no_right_margin" id="desktop_mentions_{{channel.id}}" name="desktop_{{channel.id}}" data-id="{{channel.id}}" data-device="desktop" value="mentions">
			</div>
		</td>
		<td>
			<div class="radio_cell">
				<input type="radio" class="no_right_margin" id="desktop_nothing_{{channel.id}}" name="desktop_{{channel.id}}" data-device="desktop" data-id="{{channel.id}}" value="nothing">
			</div>
		</td>
		<td>
			<div class="radio_cell">
				<input type="radio" class="no_right_margin" id="mobile_everything_{{channel.id}}" name="mobile_{{channel.id}}" data-id="{{channel.id}}" data-device="mobile" value="everything">
			</div>
		</td>
		<td>
			<div class="radio_cell">
				<input type="radio" class="no_right_margin" id="mobile_mentions_{{channel.id}}" name="mobile_{{channel.id}}" data-id="{{channel.id}}" data-device="mobile" value="mentions">
			</div>
		</td>
		<td>
			<div class="radio_cell">
				<input type="radio" class="no_right_margin" id="mobile_nothing_{{channel.id}}" name="mobile_{{channel.id}}" data-id="{{channel.id}}" data-device="mobile" value="nothing">
			</div>
		</td>
		<td class="align-center align_center"><i class="fa fa-times revert_to_default" data-id="{{channel.id}}"></i></td>
	</tr>
</script>

	
<script id="sidebar_theme_css_template" type="text/x-handlebars-template">
	<style type="text/css" id="sidebar_theme_css">

		/* Column Background */
		#col_channels_bg,
		#col_channels {
			background: {{theme.column_bg}};
		}
		#monkey_scroll_wrapper_for_channels_scroller .monkey_scroll_handle_inner {
			border-color: {{theme.column_bg}};
		}

		/* Menu Background */
		#team_menu,
		#user_menu,
		#loading_team_menu_bg, 
		#loading_user_menu_bg {
			background: {{theme.menu_bg}};
			color: {{theme.text_color}};
			text-shadow: 0 1px 1px rgba(0, 0, 0, 0.25);
		}
		#team_menu, #loading_team_menu_bg {
			border-bottom-color: {{theme.menu_bg}};
		}
		#user_menu, #loading_user_menu_bg {
			border-top-color: {{theme.menu_bg}};
		}

		/* Active Item */
		#col_channels ul li.channel.active a.channel_name, 
		#col_channels ul li.group.active a.group_name, 
		#col_channels ul li.member.active a.im_name {
			background: {{theme.active_item}};
			opacity: 1;
			color: {{theme.active_item_text}} !important;
		}
		#col_channels.channels_list_holder ul li.channel.active .unread_highlight, #col_channels.channels_list_holder ul li.member.active .unread_highlight, #col_channels.channels_list_holder ul li.group.active .unread_highlight {
			color: {{theme.active_item}};
		}
		#channel_scroll_up {
			box-shadow: 0 1px 1px rgba(0,0,0,0.25), inset 0px 2px 2px rgba(0,0,0,0.1)
		}
		#channel_scroll_down {
			box-shadow: 0 -1px 1px rgba(0,0,0,0.25), inset 0px -2px 2px rgba(0,0,0,0.1)
		}

		/* Hovered Item */
		.channels_list_holder ul li a:hover,
		#monkey_scroll_wrapper_for_channels_scroller .monkey_scroll_bar {
			background: {{theme.hover_item}};
		}

		/* Text Color */
		.channels_list_holder ul li a,
		.channels_list_holder h2,
		.list_more,
		#team_menu i,
		#user_menu i,
		.channels_list_holder ul li.channel.active a.channel_name .prefix, 
		.channels_list_holder ul li.group.active a.group_name .prefix,
		#current_user_name,
		.channels_list_holder ul li.unread .prefix,
		.channels_list_holder ul li.member .im_close, 
		.channels_list_holder ul li.group .group_close {
			color: {{theme.text_color}} !important;
			opacity: 0.6;
		}
		.channels_list_holder ul li.channel.active a.channel_name .prefix, 
		.channels_list_holder ul li.group.active a.group_name .prefix {
			color: {{theme.active_item_text}} !important;	
		}
		.list_more:hover {
			color: {{theme.text_color}} !important;
			border-bottom-color: {{theme.text_color}};
		}

		.channels_list_holder ul li.unread a,
		#current_user_name,		
		.channels_list_holder ul li.member .im_close, 
		.channels_list_holder ul li.group .group_close {
			opacity: 1;
		}

		#monkey_scroll_wrapper_for_channels_scroller .monkey_scroll_handle_inner {		
			background: {{theme.text_color}};
			opacity: 0.7;
		}

		/* Presence */
		#im-list .presence.active i.presence_icon, 
		#starred-list .presence.active i.presence_icon,
		.slackbot_icon {
			color: {{theme.active_presence}};
			opacity: 1;
		}
		#im-list li.member.active .presence.active i.presence_icon, 
		#starred-list li.member.active .presence.active i.presence_icon,
		#im-list li.member.active .slackbot_icon, 
		#starred-list li.member.active .slackbot_icon {
			color: {{theme.active_item_text}} !important;	
		}
		#im-list li.member.active .presence.away i.presence_icon, 
		#starred-list li.member.active .presence.away i.presence_icon {
			color: {{theme.active_item_text}} !important;
			opacity: 0.3;
		}
		#im-list .presence.away,
		#starred-list .presence.away {
			color: {{theme.text_color}};
			opacity: 0.3;
		}

		/* Badge + Mentions bar */
		.channels_list_holder .unread_highlight,
		#channel_scroll_up.unseen_have_mentions, 
		#channel_scroll_down.unseen_have_mentions,
		#omnibox .omnibox_item .unread_highlight_cnt {
			background: {{theme.badge}};
		}

		/* No text shadows */
		#col_channels a,
		#team_menu,
		#user_menu,
		#loading_team_menu_bg, 
		#loading_user_menu_bg {
			text-shadow: none !important;
		}

	</style>
</script>


<script id="billing_contact_template" type="text/x-handlebars-template">
	<div class="billing_contact {{#if member.is_primary_owner}}primary_owner{{/if}} {{#if member.deleted}}inactive{{/if}}" data-contact-id="{{contact.id}}">
		{{#if member}}
			{{{makeMemberPreviewLinkImage member.id 48}}}
			<div style="margin-left: 8px">
				<div class="no_wrap">
					<strong>{{#if member.is_self}}You &bull; {{/if}}{{getMemberDisplayName member}}</strong>
					{{#if member.deleted}}&bull; <em class="subtle_silver">(Disabled)</em>{{/if}}
				</div>
				<div>{{member_type}} {{#unless member.is_primary_owner}}&bull; {{member.profile.email}}{{/unless}}</div>
			</div>
			{{#if is_primary_and_self}}
				<label class="checkbox primary_owner_toggle_label" for="primary_owner_toggle">
					<input id="primary_owner_toggle" type="checkbox"> Send billing emails to you at <strong>{{member.profile.email}}</strong>
				</label>
			{{/if}}
		{{else}}
			<div style="margin-left: 56px">
				<div class="no_wrap"><strong>{{contact.email}}</strong></div>
				<div>Billing Contact</div>
			</div>
		{{/if}}
		{{#unless member.is_primary_owner}}
			<button class="btn btn-outline remove_contact"><i class="fa fa-times"></i></button>
		{{/unless}}
	</div>
</script>

<script id="billing_add_contact_form_template" type="text/x-handlebars-template">
	<div id="add_contact_form" class="top_margin">
		<div>
			<div>Add a billing contact from your team:</div>
			<div class="add_contact_input">
				<select id="user_contact_select" multiple data-placeholder="Type the new billing contact's name">
					{{#each members}}
						<option value="{{id}}">{{#if real_name}}{{real_name}} &bull;{{/if}} {{name}}</option>
					{{/each}}
				</select>
			</div>
		</div>

		<div>
			<div>Or by email address:</div>
			<input id="email_contact_input" class="add_contact_input" type="text" placeholder="name@domain.com">
		</div>

		<button class="btn btn-primary ladda-button" data-style="expand-right"><span class="ladda-label">Add billing contact</span></button>
	</div>
</script>
